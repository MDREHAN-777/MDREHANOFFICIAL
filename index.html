<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>MR7 - OFFICIAL</title>

<style>
*{margin:0;padding:0;box-sizing:border-box;}
body{
  font-family:Segoe UI, Arial;
  background:#0b0f0b;
  color:white;
  text-align:center;
  overflow-x:hidden;
  padding:15px;
  transition:0.4s;
}

/* =========================
   PRELOADER
========================= */
#preloader{
  position:fixed;
  inset:0;
  background:#000;
  display:flex;
  flex-direction:column;
  justify-content:center;
  align-items:center;
  z-index:99999;
}
.loader-logo{
  font-size:40px;
  font-weight:900;
  color:lime;
  text-shadow:0 0 25px lime;
  animation:pulse 1s infinite alternate;
}
.loader-bar{
  width:220px;
  height:8px;
  border-radius:50px;
  margin-top:20px;
  border:1px solid lime;
  overflow:hidden;
}
.loader-fill{
  height:100%;
  width:0%;
  background:lime;
  animation:loadBar 2.5s forwards;
}
@keyframes loadBar{
  0%{width:0%}
  100%{width:100%}
}
@keyframes pulse{
  from{transform:scale(1);opacity:0.6}
  to{transform:scale(1.1);opacity:1}
}

/* =========================
   PARTICLES BACKGROUND
========================= */
#particles{
  position:fixed;
  inset:0;
  z-index:-2;
  background:#000;
}
body::before{
  content:"";
  position:fixed;
  inset:0;
  z-index:-1;
  background:linear-gradient(120deg,#001a00,#000,#003300,#000);
  background-size:400% 400%;
  animation:bgMove 12s infinite alternate;
  opacity:.25;
}
@keyframes bgMove{
  0%{background-position:0% 50%}
  50%{background-position:100% 50%}
  100%{background-position:0% 50%}
}

/* =========================
   LIGHT MODE
========================= */
body.light{
  background:#fff;
  color:#111;
}
body.light::before{
  opacity:.10;
}

/* =========================
   BUTTONS
========================= */
.btn{
  padding:12px 25px;
  margin:10px;
  border:none;
  border-radius:14px;
  cursor:pointer;
  background:lime;
  font-weight:bold;
  color:black;
  transition:0.3s;
}
.btn:hover{
  transform:scale(1.07);
  box-shadow:0 0 20px lime;
}
.back-btn{
  margin-top:20px;
  background:gray;
  color:white;
}

/* =========================
   BOX
========================= */
.box{
  max-width:650px;
  margin:22px auto;
  padding:20px;
  border-radius:22px;
  background:rgba(0,0,0,.60);
  border:1px solid lime;
  box-shadow:0 0 22px rgba(0,255,0,.35);
}
body.light .box{
  background:rgba(255,255,255,.95);
  color:black;
  border:1px solid #00aa00;
}

/* =========================
   3 DOT MENU
========================= */
.dots{
  position:fixed;
  top:15px;
  left:15px;
  width:45px;
  height:45px;
  border-radius:50%;
  border:none;
  cursor:pointer;
  background:rgba(0,255,0,0.2);
  color:lime;
  font-size:25px;
  font-weight:bold;
  z-index:999;
  border:1px solid lime;
  box-shadow:0 0 15px rgba(0,255,0,0.4);
}
.dots-menu{
  position:fixed;
  top:70px;
  left:15px;
  width:210px;
  padding:10px;
  border-radius:15px;
  background:rgba(0,0,0,0.85);
  border:1px solid lime;
  display:none;
  z-index:999;
  animation:menuPop .2s ease;
}
@keyframes menuPop{
  from{transform:scale(.9);opacity:0}
  to{transform:scale(1);opacity:1}
}
.dots-menu button{
  width:100%;
  padding:10px;
  margin:6px 0;
  border:none;
  border-radius:12px;
  cursor:pointer;
  background:#1b1b1b;
  color:white;
  font-weight:bold;
  transition:.25s;
}
.dots-menu button:hover{
  background:lime;
  color:black;
  transform:scale(1.04);
}

/* =========================
   MODE BUTTON
========================= */
.dark-toggle{
  position:fixed;
  top:15px;
  right:15px;
  padding:10px 20px;
  border:none;
  border-radius:30px;
  background:lime;
  color:black;
  font-weight:bold;
  cursor:pointer;
  z-index:999;
}

/* =========================
   ONLINE/OFFLINE STATUS
========================= */
#netStatus{
  position:fixed;
  top:70px;
  right:15px;
  padding:7px 12px;
  border-radius:14px;
  font-size:13px;
  font-weight:bold;
  border:1px solid lime;
  background:rgba(0,0,0,0.6);
  z-index:999;
}

/* =========================
   SECTIONS + TRANSITION
========================= */
.section{
  display:none;
  animation:slideIn .4s ease;
}
.section.active{
  display:block;
}
@keyframes slideIn{
  from{opacity:0;transform:translateY(20px) scale(.98)}
  to{opacity:1;transform:translateY(0px) scale(1)}
}

/* =========================
   TITLE + PROFILE
========================= */
#typingTitle{
  font-size:34px;
  font-weight:900;
  color:lime;
  margin-top:30px;
  text-shadow:0 0 15px lime;
}
.profile-pic{
  width:190px;
  height:190px;
  border-radius:50%;
  border:5px solid lime;
  box-shadow:0 0 30px lime;
  margin-top:15px;
  object-fit:cover;
}
.verified{
  display:inline-flex;
  align-items:center;
  gap:8px;
  font-size:20px;
  font-weight:900;
}
.verified span{
  color:#00ff99;
  text-shadow:0 0 12px #00ff99;
}

/* =========================
   INPUTS
========================= */
input,textarea{
  width:95%;
  padding:12px;
  margin:8px 0;
  border-radius:12px;
  border:1px solid #777;
  outline:none;
}
textarea{height:100px;}

/* =========================
   CHAT UI
========================= */
#chat{
  height:340px;
  overflow-y:auto;
  background:#000;
  border-radius:18px;
  padding:12px;
  text-align:left;
  border:1px solid lime;
}
body.light #chat{background:#f4f4f4;}

.user{
  background:#00ff8833;
  padding:10px;
  margin:8px 0;
  border-radius:12px;
  color:lime;
  font-weight:600;
}
.bot{
  background:#0088ff33;
  padding:10px;
  margin:8px 0;
  border-radius:12px;
  color:#66ccff;
  font-weight:600;
}
body.light .user{color:green;}
body.light .bot{color:blue;}

/* =========================
   GRID
========================= */
.menu-grid, .games-grid{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(210px,1fr));
  gap:15px;
  margin-top:20px;
}

/* =========================
   CANVAS
========================= */
canvas{
  background:#000;
  border-radius:15px;
  border:2px solid lime;
  max-width:100%;
  touch-action:none;
}

/* =========================
   FULLSCREEN BTN
========================= */
.full-btn{
  position:fixed;
  bottom:15px;
  right:15px;
  padding:12px 18px;
  border:none;
  border-radius:30px;
  background:lime;
  color:black;
  font-weight:bold;
  cursor:pointer;
  z-index:999;
  box-shadow:0 0 15px rgba(0,255,0,0.4);
}

/* =========================
   MOBILE
========================= */
@media(max-width:600px){
  #typingTitle{font-size:26px;}
  .profile-pic{width:160px;height:160px;}
}
</style>
</head>

<body>

<canvas id="particles"></canvas>

<!-- PRELOADER -->
<div id="preloader">
  <div class="loader-logo">MR7 WORLD</div>
  <div class="loader-bar"><div class="loader-fill"></div></div>
  <p style="margin-top:15px;color:lime;font-weight:bold;">Loading...</p>
</div>

<!-- MENU -->
<button class="dots" onclick="toggleDots()">‚ãÆ</button>
<div class="dots-menu" id="dotsMenu">
  <button onclick="openSection('mainMenu'); closeDots()">üè† Home</button>
  <button onclick="openSection('aiPage'); closeDots()">ü§ñ MR7 AI</button>
  <button onclick="openSection('gamesPage'); closeDots()">üéÆ Games</button>
  <button onclick="openSection('helpPage'); closeDots()">üì© Help</button>
  <button onclick="logoutUser()">üö™ Logout</button>
</div>

<button class="dark-toggle" onclick="toggleMode()">üåô Mode</button>
<div id="netStatus">üü¢ Online</div>

<button class="full-btn" onclick="toggleFullscreen()">üì± Fullscreen</button>

<!-- LOGIN PAGE -->
<div id="loginPage" class="section active">
  <div class="box">
    <h2>üîê Login Required</h2>
    <p style="margin-top:8px;color:lime;">Login karo tabhi MR7 WORLD open hoga üî•</p>

    <input id="loginEmail" placeholder="Enter Email">
    <input id="loginPassword" type="password" placeholder="Enter Password">

    <button class="btn" onclick="loginUser()">Login</button>
    <p id="loginStatus" style="margin-top:10px;font-weight:bold;"></p>
  </div>
</div>

<!-- MAIN MENU PAGE -->
<div id="mainMenu" class="section">
  <h1 id="typingTitle"></h1>

  <div class="verified">
    <h2>MD REHAN</h2>
    <span>‚úî</span>
  </div>

  <a href="https://www.youtube.com/@MR7OFFICIAL777" target="_blank">
    <button class="btn">üî• SUBSCRIBE</button>
  </a>

  <img src="rehan.png" class="profile-pic" alt="MR7 Logo">

  <div class="box">
    <h2>üî• MR7 WORLD Updates</h2>
    <p>Gaming + AI + Cool Features üòé</p>
  </div>

  <div class="box">
    <h2>üöÄ Features</h2>
    <div class="menu-grid">
      <button class="btn" onclick="openSection('aiPage')">ü§ñ MR7 AI</button>
      <button class="btn" onclick="openSection('gamesPage')">üéÆ Games</button>
      <button class="btn" onclick="openSection('helpPage')">üì© Help</button>
    </div>
  </div>
</div>

<!-- AI PAGE -->
<div id="aiPage" class="section">
  <div class="box">
    <h2>ü§ñ MR7 AI (Smart Mode)</h2>
    <div id="chat"></div>

    <input id="aiInput" placeholder="Ask anything... (Enter = Send)">
    <button class="btn" onclick="askAI()">Send</button>
    <button class="btn" onclick="clearChat()">Clear</button>
  </div>

  <button class="btn back-btn" onclick="openSection('mainMenu')">‚¨Ö Back</button>
</div>

<!-- GAMES PAGE -->
<div id="gamesPage" class="section">
  <div class="box">
    <h2>üéÆ MR7 Games Zone</h2>
    <p style="color:lime;font-weight:bold;">All games Start button se start hoga üòé</p>

    <div class="games-grid">
      <button class="btn" onclick="openGame('snakeBox')">üêç Snake Real</button>
      <button class="btn" onclick="openGame('carBox')">üöó Car Nitro</button>
      <button class="btn" onclick="openGame('spaceBox')">üöÄ Space Shooter</button>
    </div>
  </div>

  <!-- Snake -->
  <div id="snakeBox" class="box" style="display:none;">
    <h2>üêç Snake Real Game</h2>
    <p style="color:lime;font-weight:bold;">Controls: Arrow keys / Swipe</p>
    <canvas id="snakeCanvas" width="320" height="320"></canvas>
    <p id="snakeScoreText" style="margin-top:10px;color:yellow;font-weight:bold;">Score: 0 | High: 0</p>
    <button class="btn" onclick="startSnake()">Start Snake</button>
    <button class="btn back-btn" onclick="closeGames()">‚¨Ö Back</button>
  </div>

  <!-- Car -->
  <div id="carBox" class="box" style="display:none;">
    <h2>üöó Car Nitro Racing</h2>
    <p style="color:lime;font-weight:bold;">Controls: Left/Right + Nitro</p>
    <canvas id="carCanvas" width="320" height="420"></canvas>
    <p id="carScoreText" style="margin-top:10px;color:yellow;font-weight:bold;">Score: 0 | High: 0</p>
    <button class="btn" onclick="startCar()">Start Car</button>
    <button class="btn" onclick="nitroBoost()">‚ö° Nitro</button>
    <button class="btn back-btn" onclick="closeGames()">‚¨Ö Back</button>
  </div>

  <!-- Space Shooter -->
  <div id="spaceBox" class="box" style="display:none;">
    <h2>üöÄ Space Shooter</h2>
    <p style="color:lime;font-weight:bold;">Controls: Move + Shoot</p>
    <canvas id="spaceCanvas" width="320" height="420"></canvas>
    <p id="spaceScoreText" style="margin-top:10px;color:yellow;font-weight:bold;">Score: 0 | High: 0</p>
    <button class="btn" onclick="startSpace()">Start Space</button>
    <button class="btn back-btn" onclick="closeGames()">‚¨Ö Back</button>
  </div>

  <button class="btn back-btn" onclick="openSection('mainMenu')">‚¨Ö Back Menu</button>
</div>

<!-- HELP PAGE -->
<div id="helpPage" class="section">
  <div class="box">
    <h2>üì© Help / Contact</h2>
    <input id="name" placeholder="Name">
    <input id="mobile" placeholder="Mobile">
    <textarea id="message" placeholder="Message"></textarea>
    <button class="btn" onclick="sendMail()">Send Email</button>
  </div>

  <button class="btn back-btn" onclick="openSection('mainMenu')">‚¨Ö Back</button>
</div>

<script>
/* =========================
   PRELOADER OFF
========================= */
window.addEventListener("load", ()=>{
  setTimeout(()=>{
    document.getElementById("preloader").style.display="none";
  }, 1800);
});

/* =========================
   PARTICLES BACKGROUND
========================= */
const pCanvas = document.getElementById("particles");
const pctx = pCanvas.getContext("2d");

function resizeParticles(){
  pCanvas.width = window.innerWidth;
  pCanvas.height = window.innerHeight;
}
resizeParticles();
window.addEventListener("resize", resizeParticles);

let particles=[];
for(let i=0;i<70;i++){
  particles.push({
    x:Math.random()*pCanvas.width,
    y:Math.random()*pCanvas.height,
    r:Math.random()*2+1,
    dx:(Math.random()-0.5)*1.2,
    dy:(Math.random()-0.5)*1.2
  });
}

function animateParticles(){
  pctx.clearRect(0,0,pCanvas.width,pCanvas.height);
  pctx.fillStyle="rgba(0,255,0,0.7)";
  particles.forEach(p=>{
    p.x+=p.dx;
    p.y+=p.dy;

    if(p.x<0||p.x>pCanvas.width) p.dx*=-1;
    if(p.y<0||p.y>pCanvas.height) p.dy*=-1;

    pctx.beginPath();
    pctx.arc(p.x,p.y,p.r,0,Math.PI*2);
    pctx.fill();
  });
  requestAnimationFrame(animateParticles);
}
animateParticles();

/* =========================
   DOTS MENU
========================= */
function toggleDots(){
  let menu=document.getElementById("dotsMenu");
  menu.style.display = menu.style.display==="block" ? "none" : "block";
}
function closeDots(){
  document.getElementById("dotsMenu").style.display="none";
}
document.addEventListener("click",(e)=>{
  if(!e.target.classList.contains("dots") && !e.target.closest("#dotsMenu")){
    closeDots();
  }
});

/* =========================
   OPEN SECTION
========================= */
function openSection(id){
  document.querySelectorAll(".section").forEach(s=>s.classList.remove("active"));
  document.getElementById(id).classList.add("active");
}

/* =========================
   TYPING TITLE
========================= */
function startTypingTitle(){
  let text="- MR7 WORLD -";
  let i=0;
  let el=document.getElementById("typingTitle");
  el.innerHTML="";
  let t=setInterval(()=>{
    el.innerHTML += text.charAt(i);
    i++;
    if(i>=text.length) clearInterval(t);
  },110);
}

/* =========================
   MODE SAVE
========================= */
function applyMode(){
  let mode = localStorage.getItem("mode") || "dark";
  if(mode==="light") document.body.classList.add("light");
  else document.body.classList.remove("light");
}
applyMode();

function toggleMode(){
  if(document.body.classList.contains("light")){
    document.body.classList.remove("light");
    localStorage.setItem("mode","dark");
  }else{
    document.body.classList.add("light");
    localStorage.setItem("mode","light");
  }
}

/* =========================
   ONLINE/OFFLINE STATUS
========================= */
function updateNetStatus(){
  const net = document.getElementById("netStatus");
  if(navigator.onLine){
    net.innerText="üü¢ Online";
    net.style.borderColor="lime";
  }else{
    net.innerText="üî¥ Offline";
    net.style.borderColor="red";
  }
}
window.addEventListener("online", updateNetStatus);
window.addEventListener("offline", updateNetStatus);
updateNetStatus();

/* =========================
   FULLSCREEN
========================= */
function toggleFullscreen(){
  if(!document.fullscreenElement){
    document.documentElement.requestFullscreen();
  }else{
    document.exitFullscreen();
  }
}

/* =========================
   EMAIL VALIDATION
========================= */
function isValidEmail(email){
  return /^[^\s@]+@[^\s@]+\.[^\s@]{2,}$/.test(email);
}

/* =========================
   LOGIN SYSTEM
========================= */
function loginUser(){
  let email=document.getElementById("loginEmail").value.trim();
  let pass=document.getElementById("loginPassword").value.trim();
  let status=document.getElementById("loginStatus");

  if(!email || !pass){
    status.style.color="red";
    status.innerText="‚ùå Email aur Password fill karo!";
    return;
  }
  if(!isValidEmail(email)){
    status.style.color="red";
    status.innerText="‚ùå Wrong Email format!";
    return;
  }
  if(pass.length < 4){
    status.style.color="red";
    status.innerText="‚ùå Password minimum 4 characters!";
    return;
  }

  localStorage.setItem("mr7Login","true");
  localStorage.setItem("mr7Email",email);

  status.style.color="lime";
  status.innerText="‚úÖ Login Successful!";

  setTimeout(()=>{
    openSection("mainMenu");
    startTypingTitle();
    showPopup("üî• Welcome to MR7 WORLD Boss!");
  },600);
}

function logoutUser(){
  localStorage.removeItem("mr7Login");
  localStorage.removeItem("mr7Email");
  closeDots();
  openSection("loginPage");
}

window.onload=()=>{
  let logged = localStorage.getItem("mr7Login");
  if(logged==="true"){
    openSection("mainMenu");
    startTypingTitle();
  }else{
    openSection("loginPage");
  }
};

/* =========================
   POPUP NOTIFICATION
========================= */
function showPopup(msg){
  let div=document.createElement("div");
  div.style.position="fixed";
  div.style.top="120px";
  div.style.left="50%";
  div.style.transform="translateX(-50%)";
  div.style.background="rgba(0,0,0,0.85)";
  div.style.color="lime";
  div.style.padding="12px 18px";
  div.style.border="1px solid lime";
  div.style.borderRadius="14px";
  div.style.fontWeight="bold";
  div.style.zIndex="9999";
  div.style.boxShadow="0 0 20px rgba(0,255,0,.4)";
  div.innerText=msg;
  document.body.appendChild(div);

  setTimeout(()=>div.remove(), 2500);
}

/* =========================
   CONTACT EMAIL
========================= */
function sendMail(){
  let n=document.getElementById("name").value.trim();
  let m=document.getElementById("mobile").value.trim();
  let msg=document.getElementById("message").value.trim();

  if(!n || !msg){
    alert("Please enter Name and Message üòÖ");
    return;
  }

  let subject = encodeURIComponent("MR7 Help from " + n);
  let body = encodeURIComponent("Name: " + n + "\nMobile: " + m + "\n\nMessage:\n" + msg);

  location.href="mailto:mrrehanofficial.1777@gmail.com?subject="+subject+"&body="+body;
}

/* =========================
   SMART AI SYSTEM (UPGRADED)
========================= */
let chat=document.getElementById("chat");
let aiInput=document.getElementById("aiInput");

function addMsg(text,cls){
  let div=document.createElement("div");
  div.className=cls;
  div.innerText=text;
  chat.appendChild(div);
  chat.scrollTop=chat.scrollHeight;
}

function typeBotMessage(text){
  let div=document.createElement("div");
  div.className="bot";
  chat.appendChild(div);

  let i=0;
  let t=setInterval(()=>{
    div.innerText = text.substring(0,i);
    i++;
    chat.scrollTop=chat.scrollHeight;
    if(i>text.length) clearInterval(t);
  }, 18);
}

function smartAI(q){
  let text=q.toLowerCase().trim();

  if(text==="") return "Boss kuch likho üòÑ";

  // memory name
  if(text.startsWith("my name is")){
    let nm=text.replace("my name is","").trim();
    localStorage.setItem("mr7UserName", nm);
    return "Nice Boss üòé Ab main yaad rakhunga: " + nm;
  }

  // saved name
  let savedName = localStorage.getItem("mr7UserName") || "Boss";

  // calculator
  if(text.startsWith("calc")){
    try{
      let exp=text.replace("calc","").trim();
      let result=eval(exp);
      return "üßÆ Result: " + result;
    }catch{
      return "‚ùå Calculator error! Example: calc 50+20";
    }
  }

  // time date
  if(text.includes("time")) return "‚è∞ Time: " + new Date().toLocaleTimeString();
  if(text.includes("date")) return "üìÖ Date: " + new Date().toLocaleDateString();
  if(text.includes("day")) return "üìå Today is: " + new Date().toLocaleDateString("en-US",{weekday:"long"});

  // greetings
  if(text.includes("hello")||text.includes("hi")||text.includes("hey")||text.includes("namaste"))
    return "Hello " + savedName + " üòéüî• MR7 AI ready!";

  // about AI
  if(text.includes("who are you")||text.includes("tum kaun ho"))
    return "Main MR7 AI hoon ü§ñüî• Main gaming, coding, study aur life advice sab me help karta hoon.";

  // coding help
  if(text.includes("html")) return "HTML is structure. Example: <h1>Hello</h1> . CSS is design, JS is logic üòé";
  if(text.includes("css")) return "CSS se website stylish banti hai. Example: color, background, animation, hover effects.";
  if(text.includes("javascript")||text.includes("js")) return "JavaScript website ko interactive banata hai. Buttons, games, AI sab JS se hota hai.";
  if(text.includes("python")) return "Python best language hai automation + AI + web dev ke liye. Daily practice karo loops, functions, list.";

  // science
  if(text.includes("black hole")) return "Black hole ek super strong gravity area hota hai jaha light bhi escape nahi kar pati.";
  if(text.includes("sun")) return "Sun ek star hai jo hydrogen fusion se energy produce karta hai.";
  if(text.includes("moon")) return "Moon Earth ka natural satellite hai. Ye tides create karta hai.";

  // motivation
  if(text.includes("motivation")||text.includes("sad")||text.includes("depressed"))
    return "Boss listen üòé Life me down aata hai, but winner wahi hota hai jo give up nahi karta. Small steps daily üî•";

  // youtube
  if(text.includes("youtube") && (text.includes("grow")||text.includes("views")||text.includes("subscriber")))
    return "YouTube grow ka formula: consistency + shorts daily + strong thumbnail + title short + trend follow + audience retention.";

  // jokes
  if(text.includes("joke"))
    return "üòÇ Joke: Programmer ka love bhi bug fix jaisa hota hai... jab tak solve na ho tab tak sleep nahi hoti!";

  // default smart response
  return "Boss " + savedName + ", main tumhara question samjha üòé\n\nTopic: " + q +
         "\n\nMain simple answer deta hoon:\nüëâ Ye ek deep topic hai, but generally iska best solution step-by-step approach hota hai.\n\nAgar tum chaho to main example ke sath explain kar dunga üî•";
}

function askAI(){
  let q=aiInput.value.trim();
  if(!q) return;

  addMsg("You: "+q,"user");
  aiInput.value="";

  setTimeout(()=>{
    let reply=smartAI(q);
    typeBotMessage("AI: " + reply);
  },220);
}

aiInput.addEventListener("keydown",(e)=>{
  if(e.key==="Enter" && !e.shiftKey){
    e.preventDefault();
    askAI();
  }
});

function clearChat(){
  if(confirm("Clear full chat?")){
    chat.innerHTML="";
  }
}

/* =========================
   GAME OPEN/CLOSE
========================= */
function openGame(id){
  closeGames();
  document.getElementById(id).style.display="block";
}
function closeGames(){
  document.getElementById("snakeBox").style.display="none";
  document.getElementById("carBox").style.display="none";
  document.getElementById("spaceBox").style.display="none";
}

/* =========================
   SNAKE GAME (REAL)
========================= */
let snakeCanvas=document.getElementById("snakeCanvas");
let sctx=snakeCanvas.getContext("2d");

let snake=[], food={}, dir="RIGHT", snakeInterval=null;
let snakeScore=0;
let snakeHigh = parseInt(localStorage.getItem("snakeHigh")||"0");

function resetSnake(){
  snake=[{x:160,y:160},{x:140,y:160},{x:120,y:160}];
  food={x:80,y:80};
  dir="RIGHT";
  snakeScore=0;
  updateSnakeText();
}

function updateSnakeText(){
  document.getElementById("snakeScoreText").innerText =
    "Score: " + snakeScore + " | High: " + snakeHigh;
}

function drawSnake(){
  sctx.clearRect(0,0,320,320);

  // background grid
  for(let i=0;i<320;i+=20){
    for(let j=0;j<320;j+=20){
      sctx.fillStyle = ( (i+j)/20 % 2==0 ) ? "#050505" : "#0a0a0a";
      sctx.fillRect(i,j,20,20);
    }
  }

  // food glow
  sctx.fillStyle="red";
  sctx.shadowColor="red";
  sctx.shadowBlur=15;
  sctx.fillRect(food.x,food.y,20,20);
  sctx.shadowBlur=0;

  // snake
  snake.forEach((part,index)=>{
    sctx.fillStyle = index==0 ? "#00ffaa" : "lime";
    sctx.shadowColor="lime";
    sctx.shadowBlur=10;
    sctx.fillRect(part.x,part.y,20,20);
    sctx.shadowBlur=0;
  });
}

function moveSnake(){
  let head={...snake[0]};

  if(dir==="RIGHT") head.x+=20;
  if(dir==="LEFT") head.x-=20;
  if(dir==="UP") head.y-=20;
  if(dir==="DOWN") head.y+=20;

  // wall hit
  if(head.x<0||head.y<0||head.x>=320||head.y>=320){
    gameOverSnake();
    return;
  }

  // self collision
  for(let i=1;i<snake.length;i++){
    if(snake[i].x===head.x && snake[i].y===head.y){
      gameOverSnake();
      return;
    }
  }

  snake.unshift(head);

  if(head.x===food.x && head.y===food.y){
    snakeScore++;
    if(snakeScore>snakeHigh){
      snakeHigh=snakeScore;
      localStorage.setItem("snakeHigh", snakeHigh);
    }
    updateSnakeText();

    food={
      x:Math.floor(Math.random()*16)*20,
      y:Math.floor(Math.random()*16)*20
    };
  }else{
    snake.pop();
  }

  drawSnake();
}

function gameOverSnake(){
  clearInterval(snakeInterval);
  snakeInterval=null;
  alert("üêç Game Over! Score: "+snakeScore);
}

function startSnake(){
  resetSnake();
  drawSnake();
  clearInterval(snakeInterval);
  snakeInterval=setInterval(moveSnake, 130);
}

document.addEventListener("keydown",(e)=>{
  if(e.key==="ArrowUp" && dir!=="DOWN") dir="UP";
  if(e.key==="ArrowDown" && dir!=="UP") dir="DOWN";
  if(e.key==="ArrowLeft" && dir!=="RIGHT") dir="LEFT";
  if(e.key==="ArrowRight" && dir!=="LEFT") dir="RIGHT";
});

// mobile swipe snake
let startX=0,startY=0;
snakeCanvas.addEventListener("touchstart",(e)=>{
  startX=e.touches[0].clientX;
  startY=e.touches[0].clientY;
});
snakeCanvas.addEventListener("touchend",(e)=>{
  let endX=e.changedTouches[0].clientX;
  let endY=e.changedTouches[0].clientY;
  let dx=endX-startX;
  let dy=endY-startY;

  if(Math.abs(dx)>Math.abs(dy)){
    if(dx>0 && dir!=="LEFT") dir="RIGHT";
    if(dx<0 && dir!=="RIGHT") dir="LEFT";
  }else{
    if(dy>0 && dir!=="UP") dir="DOWN";
    if(dy<0 && dir!=="DOWN") dir="UP";
  }
});

/* =========================
   CAR GAME (REAL + NITRO)
========================= */
let carCanvas=document.getElementById("carCanvas");
let cctx=carCanvas.getContext("2d");

let playerCar=null, enemies=[], carScore=0, carInterval=null;
let carHigh = parseInt(localStorage.getItem("carHigh")||"0");
let nitro=100;

function updateCarText(){
  document.getElementById("carScoreText").innerText =
    "Score: " + carScore + " | High: " + carHigh + " | Nitro: " + nitro + "%";
}

function resetCar(){
  playerCar={x:140,y:320,w:40,h:70,speed:5};
  enemies=[
    {x:70,y:-150,w:40,h:70,speed:4},
    {x:210,y:-450,w:40,h:70,speed:5}
  ];
  carScore=0;
  nitro=100;
  updateCarText();
}

function drawCar(x,y,w,h,color){
  cctx.fillStyle=color;
  cctx.fillRect(x,y,w,h);

  cctx.fillStyle="black";
  cctx.fillRect(x+6,y+10,w-12,22);

  cctx.fillStyle="#66ccff";
  cctx.fillRect(x+10,y+14,w-20,14);

  cctx.fillStyle="#111";
  cctx.fillRect(x-6,y+10,8,18);
  cctx.fillRect(x+w-2,y+10,8,18);
  cctx.fillRect(x-6,y+h-28,8,18);
  cctx.fillRect(x+w-2,y+h-28,8,18);

  cctx.fillStyle="yellow";
  cctx.fillRect(x+5,y+h-6,8,6);
  cctx.fillRect(x+w-13,y+h-6,8,6);
}

let roadOffset=0;

function drawCarGame(){
  cctx.clearRect(0,0,320,420);

  // road
  cctx.fillStyle="#2a2a2a";
  cctx.fillRect(0,0,320,420);

  // borders
  cctx.fillStyle="#111";
  cctx.fillRect(0,0,40,420);
  cctx.fillRect(280,0,40,420);

  // moving dashed line
  cctx.strokeStyle="white";
  cctx.lineWidth=4;
  cctx.setLineDash([20,20]);
  cctx.beginPath();
  cctx.moveTo(160, roadOffset);
  cctx.lineTo(160, 420);
  cctx.stroke();
  cctx.setLineDash([]);

  // player
  drawCar(playerCar.x,playerCar.y,playerCar.w,playerCar.h,"lime");

  // enemies
  enemies.forEach(e=>{
    drawCar(e.x,e.y,e.w,e.h,"red");
  });
}

function updateCarGame(){
  roadOffset += 10;
  if(roadOffset>40) roadOffset=0;

  enemies.forEach(e=>{
    e.y += e.speed;

    // collision
    if(playerCar.x < e.x+e.w &&
       playerCar.x+playerCar.w > e.x &&
       playerCar.y < e.y+e.h &&
       playerCar.y+playerCar.h > e.y){
      clearInterval(carInterval);
      carInterval=null;
      alert("üí• Crash! Score: "+carScore);
    }

    // reset enemy
    if(e.y>450){
      e.y = -Math.random()*300 - 100;
      e.x = 60 + Math.random()*160;
      carScore++;
      if(carScore>carHigh){
        carHigh=carScore;
        localStorage.setItem("carHigh", carHigh);
      }
      updateCarText();
    }
  });

  // nitro recharge
  if(nitro<100) nitro++;

  drawCarGame();
}

function startCar(){
  resetCar();
  drawCarGame();
  clearInterval(carInterval);
  carInterval=setInterval(updateCarGame, 30);
}

function nitroBoost(){
  if(!playerCar) return;
  if(nitro<=0) return;

  nitro -= 20;
  if(nitro<0) nitro=0;

  enemies.forEach(e=> e.speed += 2);
  setTimeout(()=>{
    enemies.forEach(e=> e.speed -= 2);
  }, 800);

  updateCarText();
}

// keyboard control
document.addEventListener("keydown",(e)=>{
  if(!playerCar) return;
  if(e.key==="ArrowLeft") playerCar.x -= playerCar.speed*3;
  if(e.key==="ArrowRight") playerCar.x += playerCar.speed*3;
  if(e.key===" ") nitroBoost();

  if(playerCar.x<45) playerCar.x=45;
  if(playerCar.x>235) playerCar.x=235;
});

// mobile drag
carCanvas.addEventListener("touchstart",(e)=>{
  startX=e.touches[0].clientX;
});
carCanvas.addEventListener("touchmove",(e)=>{
  if(!playerCar) return;
  let x=e.touches[0].clientX;
  let diff=x-startX;

  playerCar.x += diff*0.2;
  startX=x;

  if(playerCar.x<45) playerCar.x=45;
  if(playerCar.x>235) playerCar.x=235;
});

/* =========================
   SPACE SHOOTER GAME
========================= */
let spaceCanvas=document.getElementById("spaceCanvas");
let spctx=spaceCanvas.getContext("2d");

let ship=null, bullets=[], enemiesS=[], spaceScore=0, spaceInterval=null;
let spaceHigh = parseInt(localStorage.getItem("spaceHigh")||"0");

function updateSpaceText(){
  document.getElementById("spaceScoreText").innerText =
    "Score: " + spaceScore + " | High: " + spaceHigh;
}

function resetSpace(){
  ship={x:140,y:340,w:40,h:40,speed:6};
  bullets=[];
  enemiesS=[];
  spaceScore=0;
  updateSpaceText();
}

function spawnEnemy(){
  enemiesS.push({
    x:Math.random()*280,
    y:-40,
    w:35,
    h:35,
    speed:2 + Math.random()*2
  });
}

function drawSpace(){
  spctx.clearRect(0,0,320,420);

  // stars bg
  spctx.fillStyle="black";
  spctx.fillRect(0,0,320,420);

  for(let i=0;i<30;i++){
    spctx.fillStyle="white";
    spctx.fillRect(Math.random()*320,Math.random()*420,2,2);
  }

  // ship
  spctx.fillStyle="lime";
  spctx.beginPath();
  spctx.moveTo(ship.x+20, ship.y);
  spctx.lineTo(ship.x, ship.y+40);
  spctx.lineTo(ship.x+40, ship.y+40);
  spctx.closePath();
  spctx.fill();

  // bullets
  spctx.fillStyle="yellow";
  bullets.forEach(b=>{
    spctx.fillRect(b.x,b.y,4,12);
  });

  // enemies
  spctx.fillStyle="red";
  enemiesS.forEach(e=>{
    spctx.fillRect(e.x,e.y,e.w,e.h);
  });
}

function updateSpace(){
  // move bullets
  bullets.forEach(b=> b.y -= 8);
  bullets = bullets.filter(b=> b.y>-20);

  // move enemies
  enemiesS.forEach(e=> e.y += e.speed);

  // collision
  enemiesS.forEach((e,ei)=>{
    bullets.forEach((b,bi)=>{
      if(b.x < e.x+e.w &&
         b.x+4 > e.x &&
         b.y < e.y+e.h &&
         b.y+12 > e.y){

        enemiesS.splice(ei,1);
        bullets.splice(bi,1);

        spaceScore++;
        if(spaceScore>spaceHigh){
          spaceHigh=spaceScore;
          localStorage.setItem("spaceHigh", spaceHigh);
        }
        updateSpaceText();
      }
    });
  });

  // ship hit
  enemiesS.forEach(e=>{
    if(ship.x < e.x+e.w &&
       ship.x+ship.w > e.x &&
       ship.y < e.y+e.h &&
       ship.y+ship.h > e.y){
      clearInterval(spaceInterval);
      spaceInterval=null;
      alert("üí• Ship Destroyed! Score: "+spaceScore);
    }
  });

  // remove enemies out
  enemiesS = enemiesS.filter(e=> e.y<450);

  drawSpace();
}

function startSpace(){
  resetSpace();
  drawSpace();
  clearInterval(spaceInterval);

  spaceInterval=setInterval(updateSpace, 30);
  setInterval(()=>{
    if(spaceInterval) spawnEnemy();
  }, 900);
}

// keyboard
document.addEventListener("keydown",(e)=>{
  if(!ship) return;

  if(e.key==="ArrowLeft") ship.x -= ship.speed;
  if(e.key==="ArrowRight") ship.x += ship.speed;
  if(e.key==="ArrowUp") ship.y -= ship.speed;
  if(e.key==="ArrowDown") ship.y += ship.speed;

  if(e.key==="Enter"){
    bullets.push({x:ship.x+18,y:ship.y});
  }

  if(ship.x<0) ship.x=0;
  if(ship.x>280) ship.x=280;
  if(ship.y<0) ship.y=0;
  if(ship.y>380) ship.y=380;
});

// mobile touch shoot
spaceCanvas.addEventListener("touchmove",(e)=>{
  let x=e.touches[0].clientX - spaceCanvas.getBoundingClientRect().left;
  ship.x = x-20;
  if(ship.x<0) ship.x=0;
  if(ship.x>280) ship.x=280;
});
spaceCanvas.addEventListener("touchstart",()=>{
  bullets.push({x:ship.x+18,y:ship.y});
});
</script>

</body>
</html>
