<script>
// DARK MODE
if(localStorage.dark=="on"){ document.body.classList.add("dark-mode"); }
function toggleDark(){ 
  document.body.classList.toggle("dark-mode"); 
  localStorage.dark=document.body.classList.contains("dark-mode")?"on":"off"; 
}

// MENU
function toggleMenu(){ menuBox.style.display=menuBox.style.display=="block"?"none":"block"; }
function openContact(){ home.classList.remove("active"); ai.classList.remove("active"); contact.classList.add("active"); menuBox.style.display="none"; }
function openAI(){ home.classList.remove("active"); contact.classList.remove("active"); ai.classList.add("active"); menuBox.style.display="none"; }
function goBack(){ contact.classList.remove("active"); ai.classList.remove("active"); home.classList.add("active"); }

// CONTACT EMAIL
function sendMail(){ location.href="mailto:mrrehanofficial.1777@gmail.com"; }

// AI DATA
let jokes=[
 "Teacher: Homework done? Student: Yes sir, but at home ðŸ˜„",
 "Why phone went to school? To improve its *cell* ðŸ˜†",
 "Life is short, smile while you still have teeth ðŸ˜",
 "Why computer is cold? Because it forgot to close windows ðŸ˜‚",
 "Why did the bicycle fall? Because it was two-tired ðŸ˜­ðŸ˜‚",
 "Me: I need motivation. Brain: Sleep ðŸ˜´"
];

let facts=[
 "Honey never spoils ðŸ¯",
 "Bananas are berries, strawberries are not ðŸŒ",
 "Octopuses have three hearts ðŸ™",
 "Sharks existed before trees ðŸŒ²",
 "The human brain is faster than a supercomputer âš¡",
 "Water can boil and freeze at same time (triple point) ðŸ˜²"
];

let quiz=[
 {q:"Capital of India?",a:"new delhi"},
 {q:"5+7=?",a:"12"},
 {q:"Color of sky?",a:"blue"},
 {q:"Largest planet?",a:"jupiter"},
 {q:"Father of Computer?",a:"charles babbage"}
];

let currentQuiz=null;
let currentGame=null;
let userName=localStorage.userName || "";
let userMood=localStorage.userMood || "";
let chatMemory=localStorage.chat || "";
let weatherPending=false;

// Load chat memory
chat.innerHTML=chatMemory;

// Typing effect
function typeText(text,cls,speed=18){
 let i=0;
 let div=document.createElement("div");
 div.className=cls;
 chat.appendChild(div);
 chat.scrollTop=chat.scrollHeight;

 let t=setInterval(()=>{
   div.innerHTML += text.charAt(i);
   i++;
   chat.scrollTop=chat.scrollHeight;
   if(i>=text.length){
     clearInterval(t);
     chat.scrollTop=chat.scrollHeight;
     localStorage.chat=chat.innerHTML;
   }
 },speed);
}

// Clear chat
function clearChat(){ 
  chat.innerHTML=""; 
  localStorage.removeItem("chat"); 
}

// Math calculator
function calculateMath(text){
 try{
   let expr=text.replace(/[^0-9\+\-\*\/\.\(\) ]/g,'');
   if(expr.length>0 && expr.match(/[0-9]/)){
     return eval(expr);
   }
 }catch{}
 return null;
}

// Translator
function translate(text){ 
 let enToHi={
   "hello":"à¤¨à¤®à¤¸à¥à¤¤à¥‡",
   "hi":"à¤¹à¤¾à¤¯",
   "how are you":"à¤•à¥ˆà¤¸à¥‡ à¤¹à¥‹",
   "good morning":"à¤¸à¥à¤ªà¥à¤°à¤­à¤¾à¤¤",
   "good night":"à¤¶à¥à¤­ à¤°à¤¾à¤¤à¥à¤°à¤¿",
   "thank you":"à¤§à¤¨à¥à¤¯à¤µà¤¾à¤¦",
   "joke":"à¤®à¤œà¤¾à¤•",
   "time":"à¤¸à¤®à¤¯",
   "date":"à¤¤à¤¾à¤°à¥€à¤–"
 };

 let hiToEn={
   "à¤¨à¤®à¤¸à¥à¤¤à¥‡":"hello",
   "à¤¹à¤¾à¤¯":"hi",
   "à¤•à¥ˆà¤¸à¥‡ à¤¹à¥‹":"how are you",
   "à¤¸à¥à¤ªà¥à¤°à¤­à¤¾à¤¤":"good morning",
   "à¤¶à¥à¤­ à¤°à¤¾à¤¤à¥à¤°à¤¿":"good night",
   "à¤§à¤¨à¥à¤¯à¤µà¤¾à¤¦":"thank you",
   "à¤®à¤œà¤¾à¤•":"joke",
   "à¤¸à¤®à¤¯":"time",
   "à¤¤à¤¾à¤°à¥€à¤–":"date"
 };

 if(enToHi[text]) return enToHi[text]; 
 if(hiToEn[text]) return hiToEn[text]; 
 return "Translation not found ðŸ˜…"; 
}

// Weather fetch
async function getWeather(city){
 try{
   let res=await fetch(`https://wttr.in/${city}?format=3`);
   return await res.text();
 }catch{
   return "Weather not available ðŸ˜…";
 }
}

// Number guessing game
function startNumberGame(){
 currentGame=Math.floor(Math.random()*20)+1;
 return "ðŸŽ® Number Guessing Game started! Guess a number between 1 and 20.";
}

// Smart Google Search link
function googleSearch(query){
 return `https://www.google.com/search?q=${encodeURIComponent(query)}`;
}

// Smart YouTube Search link
function youtubeSearch(query){
 return `https://www.youtube.com/results?search_query=${encodeURIComponent(query)}`;
}

// Smart AI brain (more human replies)
function smartReply(text){
 let replies=[
   "Hmm interesting ðŸ˜„ thoda aur detail me batao.",
   "Acha! Samjha ðŸ˜Ž",
   "Bhai ye to solid question hai ðŸ”¥",
   "Main help kar sakta hoon ðŸ˜„ bol kya chahiye?",
   "MR7 AI ready hai ðŸ˜ˆ"
 ];
 return replies[Math.floor(Math.random()*replies.length)];
}

// ENTER to send
aiInput.addEventListener("keydown", function(e){
 if(e.key==="Enter"){
   askAI();
 }
});

async function askAI(){
 let q=aiInput.value.trim();
 if(!q) return;

 typeText("You: "+q,"user",14);
 aiInput.value="";
 typing.style.display="block";

 let reply="";
 let text=q.toLowerCase();

 await new Promise(r=>setTimeout(r,300));

 // WEATHER CITY FLOW
 if(weatherPending){
   weatherPending=false;
   let city=q.trim();
   reply="ðŸŒ¤ï¸ Weather check kar raha hoon...";
   typing.style.display="none";
   typeText("AI: "+reply,"bot",16);

   let w=await getWeather(city);
   setTimeout(()=>{
     typeText("AI: "+w,"bot",14);
   },400);
   return;
 }

 // NAME SAVE
 if(text.includes("mera name") || text.includes("my name is") || text.includes("i am")){
   let nameGuess=q.replace(/mera name|my name is|i am|hai|am/gi,"").trim();
   if(nameGuess.length<2) nameGuess="Friend";
   userName=nameGuess;
   localStorage.userName=userName;
   reply="Nice to meet you "+userName+" ðŸ˜„ðŸ”¥";
 }

 // MOOD SAVE
 else if(text.includes("i am sad") || text.includes("mai sad") || text.includes("mujhe bura lag raha")){
   userMood="sad";
   localStorage.userMood=userMood;
   reply="Aree "+(userName?userName:"bhai")+" ðŸ˜¥ tension mat le... main hoon na â¤ï¸";
 }
 else if(text.includes("i am happy") || text.includes("mai khush") || text.includes("mast")){
   userMood="happy";
   localStorage.userMood=userMood;
   reply="Wahh ðŸ”¥ "+(userName?userName:"bro")+"! Aaj mood full on hai ðŸ˜Ž";
 }

 // GREETINGS
 else if(/hello|hi|hey|namaste|hii|helo/i.test(text)){
   reply="Hello "+(userName?userName:"")+" ðŸ˜„ MR7 AI online! Kya help chahiye?";
 }

 // HOW ARE YOU
 else if(text.includes("how are you") || text.includes("kaise ho")){
   reply="Main ekdum mast ðŸ¤–âš¡ aur tum? "+(userMood?("Mood: "+userMood+" ðŸ˜„"):"");
 }

 // AI NAME
 else if(text.includes("your name") || text.includes("tumhara name")){
   reply="Mera naam MR7 AI hai ðŸ¤–ðŸ”¥ (Created by MR7 WORLD)";
 }

 // CREATOR
 else if(text.includes("who made you") || text.includes("kisne banaya") || text.includes("creator")){
   reply="Mujhe MR7 WORLD ke owner MD REHAN ne banaya hai ðŸ˜ŽðŸ”¥";
 }

 // TIME
 else if(text.includes("time") || text.includes("samay")){
   let now=new Date();
   reply="â° Abhi ka time: "+now.toLocaleTimeString();
 }

 // DATE
 else if(text.includes("date") || text.includes("aaj ki date")){
   let now=new Date();
   reply="ðŸ“… Aaj ki date: "+now.toLocaleDateString();
 }

 // JOKE
 else if(text.includes("joke") || text.includes("mazak")){
   reply=jokes[Math.floor(Math.random()*jokes.length)];
 }

 // FACT
 else if(text.includes("fact") || text.includes("interesting")){
   reply=facts[Math.floor(Math.random()*facts.length)];
 }

 // MATH
 else if(calculateMath(text)!==null){
   reply="ðŸ§® Answer: "+calculateMath(text);
 }

 // TRANSLATE
 else if(text.includes("translate")){
   let words=q.split(/translate/i)[1];
   if(!words) reply="Kya translate karna hai? Example: translate hello";
   else reply="ðŸŒ "+translate(words.trim().toLowerCase());
 }

 // WEATHER
 else if(text.includes("weather") || text.includes("mausam")){
   weatherPending=true;
   reply="ðŸŒ¤ï¸ Kaunsi city ka weather chahiye? (Example: Kolkata / Delhi)";
 }

 // QUIZ
 else if(text.includes("quiz")){
   currentQuiz=quiz[Math.floor(Math.random()*quiz.length)];
   reply="ðŸŽ¯ Quiz Time! "+currentQuiz.q;
 }

 // QUIZ ANSWER
 else if(currentQuiz){
   if(text.includes(currentQuiz.a)){
     reply="Correct! ðŸŽ‰ðŸ”¥ Tum genius ho!";
   }else{
     reply="Wrong ðŸ˜… Correct answer: "+currentQuiz.a;
   }
   currentQuiz=null;
 }

 // GAME
 else if(text.includes("game")){
   reply=startNumberGame();
 }

 // GAME GUESS
 else if(currentGame){
   let guess=parseInt(text);
   if(isNaN(guess)){
     reply="Please sirf number bhejo ðŸ˜… (1 to 20)";
   }else if(guess>currentGame){
     reply="Too high ðŸ“ˆ guess again!";
   }else if(guess<currentGame){
     reply="Too low ðŸ“‰ guess again!";
   }else{
     reply="ðŸŽ‰ Congrats "+(userName?userName:"")+"! Tumne sahi guess kiya ðŸ˜ŽðŸ”¥";
     currentGame=null;
   }
 }

 // YOUTUBE SEARCH
 else if(text.includes("youtube") || text.includes("yt search")){
   let query=q.replace(/youtube|yt search/gi,"").trim();
   if(query.length<2) reply="YouTube pe kya search karna hai?";
   else reply="ðŸ” YouTube Search Link: "+youtubeSearch(query);
 }

 // GOOGLE SEARCH
 else if(text.includes("google") || text.includes("search")){
   let query=q.replace(/google|search/gi,"").trim();
   if(query.length<2) reply="Google pe kya search karna hai?";
   else reply="ðŸŒ Google Search Link: "+googleSearch(query);
 }

 // HELP COMMANDS
 else if(text.includes("help") || text.includes("commands")){
   reply=
   "ðŸ¤– MR7 AI Commands:\n\n" +
   "1) time / date\n" +
   "2) joke / fact\n" +
   "3) quiz\n" +
   "4) game\n" +
   "5) weather\n" +
   "6) translate hello\n" +
   "7) youtube (topic)\n" +
   "8) google (topic)\n\n" +
   "Example: youtube ronaldo skills";
 }

 // DEFAULT SMART
 else{
   reply=smartReply(text);
 }

 setTimeout(()=>{
   typing.style.display="none";
   typeText("AI: "+reply,"bot",14);
 },450);
}
</script>
