<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MR7 - OFFICIAL</title>

<style>
body{
 margin:0;
 padding:0;
 text-align:center;
 font-family:Segoe UI;
 background:#000;
 color:#fff;
 transition:.4s;
 overflow-x:hidden;
}

/* LIGHT MODE */
body.light{
 background:#fff;
 color:#111;
}

.section{
 display:none;
 padding:20px;
 animation:fadeSlide .6s ease;
}

.section.active{
 display:block;
}

@keyframes fadeSlide{
 from{
   opacity:0;
   transform:translateY(25px) scale(0.97);
 }
 to{
   opacity:1;
   transform:translateY(0px) scale(1);
 }
}

/* PRELOADER */
#preloader{
 position:fixed;
 top:0;left:0;
 width:100%;
 height:100%;
 background:#000;
 display:flex;
 align-items:center;
 justify-content:center;
 z-index:99999;
}

.loader{
 width:80px;
 height:80px;
 border:6px solid #333;
 border-top:6px solid lime;
 border-radius:50%;
 animation:spin 1s linear infinite;
}

@keyframes spin{
 100%{transform:rotate(360deg);}
}

/* PARTICLES */
.particle{
 position:fixed;
 width:6px;
 height:6px;
 background:rgba(0,255,0,0.7);
 border-radius:50%;
 z-index:-1;
 animation:float 6s infinite linear;
}

@keyframes float{
 0%{transform:translateY(0px);}
 100%{transform:translateY(-900px);}
}

/* HEADER */
.header{
 display:flex;
 justify-content:space-between;
 align-items:center;
 padding:12px 15px;
 background:rgba(0,0,0,0.75);
 backdrop-filter:blur(6px);
 border-bottom:2px solid lime;
 position:sticky;
 top:0;
 z-index:999;
}

body.light .header{
 background:rgba(255,255,255,0.8);
 border-bottom:2px solid #111;
}

.dots{
 font-size:28px;
 cursor:pointer;
 padding:0 10px;
}

/* VERIFIED NAME */
#verifiedName{
 font-size:18px;
 font-weight:bold;
 color:lime;
 text-shadow:0 0 8px lime;
}

#verifiedName span{
 color:#00ffff;
 text-shadow:0 0 10px #00ffff;
 font-size:16px;
}

/* ONLINE STATUS */
#onlineStatus{
 font-size:14px;
 font-weight:bold;
}

/* DOT MENU */
#dotsMenu{
 position:absolute;
 top:55px;
 right:10px;
 background:#111;
 border:2px solid lime;
 border-radius:12px;
 padding:10px;
 display:none;
 z-index:9999;
 width:180px;
 text-align:left;
}

body.light #dotsMenu{
 background:#fff;
 border:2px solid #111;
}

#dotsMenu button{
 width:100%;
 margin:5px 0;
 padding:10px;
 border:none;
 border-radius:10px;
 cursor:pointer;
 font-weight:bold;
 background:lime;
}

#dotsMenu button:hover{
 transform:scale(1.03);
}

/* BUTTONS */
.btn{
 padding:12px 18px;
 margin:10px;
 border:none;
 border-radius:12px;
 background:lime;
 cursor:pointer;
 font-weight:bold;
 font-size:15px;
}

.btn:hover{
 transform:scale(1.05);
 transition:0.2s;
}

.card{
 background:rgba(0,0,0,0.6);
 padding:20px;
 margin:20px auto;
 max-width:350px;
 border-radius:20px;
 border:2px solid lime;
 box-shadow:0 0 20px rgba(0,255,0,0.4);
}

body.light .card{
 background:rgba(255,255,255,0.8);
 border:2px solid #111;
 color:#111;
}

input,textarea{
 width:90%;
 padding:12px;
 margin:8px;
 border-radius:10px;
 border:2px solid lime;
 outline:none;
 background:#111;
 color:#fff;
 font-size:15px;
}

body.light input, body.light textarea{
 background:#fff;
 color:#111;
 border:2px solid #111;
}

/* PROFILE IMAGE */
.profileImg{
 width:120px;
 height:120px;
 border-radius:50%;
 border:3px solid lime;
 box-shadow:0 0 20px lime;
}

/* CHAT */
#chat{
 height:250px;
 overflow:auto;
 background:#111;
 padding:12px;
 border-radius:15px;
 border:2px solid lime;
 text-align:left;
 margin-top:10px;
}

body.light #chat{
 background:#f3f3f3;
 border:2px solid #111;
}

.user{
 margin:8px 0;
 color:#00ffff;
 font-weight:bold;
}

.bot{
 margin:8px 0;
 color:lime;
 font-weight:bold;
}

small{
 opacity:0.8;
}

/* GAMES */
canvas{
 background:#000;
 border:2px solid lime;
 border-radius:15px;
 margin-top:10px;
}

/* POPUP */
#popup{
 position:fixed;
 bottom:20px;
 left:50%;
 transform:translateX(-50%);
 background:#111;
 border:2px solid lime;
 border-radius:20px;
 padding:15px 20px;
 z-index:99999;
 display:none;
 box-shadow:0 0 25px rgba(0,255,0,0.5);
 animation:pop 0.5s ease;
}

@keyframes pop{
 from{opacity:0;transform:translateX(-50%) translateY(20px);}
 to{opacity:1;transform:translateX(-50%) translateY(0);}
}

/* CUSTOM CURSOR */
@media (min-width:768px){
 body{
   cursor:crosshair;
 }
}

/* SETTINGS SWITCH */
.toggleBox{
 text-align:left;
 margin-top:10px;
}

.toggleBox label{
 display:flex;
 justify-content:space-between;
 align-items:center;
 margin:10px 0;
 font-size:15px;
}

.toggleBox input{
 width:20px;
 height:20px;
}
</style>
</head>

<body>

<!-- PRELOADER -->
<div id="preloader">
  <div class="loader"></div>
</div>

<!-- POPUP -->
<div id="popup">Welcome to MR7 WORLD ðŸ˜ŽðŸ”¥</div>

<!-- HEADER -->
<div class="header">
  <div id="verifiedName">MR7 WORLD <span>âœ” Verified</span></div>
  <div id="onlineStatus">ðŸŸ¢ Online</div>
  <div class="dots" onclick="toggleDots()">â‹®</div>

  <div id="dotsMenu">
    <button onclick="toggleMode()">Theme Mode</button>
    <button onclick="openSection('settingsPage'); closeDots()">Settings</button>
    <button onclick="logoutUser()">Logout</button>
  </div>
</div>

<!-- LOGIN -->
<div id="loginPage" class="section active">
  <h2>Login to MR7 WORLD</h2>
  <div class="card">
    <input type="email" id="loginEmail" placeholder="Enter Email">
    <input type="password" id="loginPassword" placeholder="Enter Password">
    <button class="btn" onclick="loginUser()">Login</button>
    <p id="loginStatus"></p>
  </div>
</div>

<!-- MAIN MENU -->
<div id="mainMenu" class="section">
  <h1 id="typingTitle"></h1>

  <div class="card">
    <img src="rehan.png" class="profileImg"><br><br>

    <h2>Md Rehan <span style="color:#00ffff;">âœ”</span></h2>
    <p><small>Gaming + AI + Cool Features ðŸ˜Ž</small></p>

    <input type="text" id="menuSearch" placeholder="Search (ai / games / contact / profile / settings)">
    <button class="btn" onclick="searchMenu()">Search</button>

    <br>
    <button class="btn" onclick="openSection('aiPage')">Open MR7 AI</button>
    <button class="btn" onclick="openSection('gamePage')">Open Games</button>
    <button class="btn" onclick="openSection('contactPage')">Contact</button>
    <button class="btn" onclick="openSection('profileCardPage')">Profile Card</button>
  </div>
</div>

<!-- PROFILE CARD PAGE -->
<div id="profileCardPage" class="section">
  <h2>Profile Card</h2>
  <div class="card">
    <h2>Md Rehan <span style="color:#00ffff;">âœ” Verified</span></h2>
    <p>Welcome to MR7 WORLD ðŸ˜ŽðŸ”¥</p>

    <button class="btn" onclick="window.open('https://youtube.com','_blank')">YouTube</button>
    <button class="btn" onclick="window.open('https://instagram.com','_blank')">Instagram</button>
    <button class="btn" onclick="window.open('https://wa.me/91XXXXXXXXXX','_blank')">WhatsApp</button>

    <br><br>
    <button class="btn" onclick="openSection('mainMenu')">Back</button>
  </div>
</div>

<!-- SETTINGS -->
<div id="settingsPage" class="section">
  <h2>Settings</h2>
  <div class="card">
    <div class="toggleBox">
      <label>Background Music
        <input type="checkbox" id="musicToggle" onchange="saveSettings()">
      </label>

      <label>Click Sound
        <input type="checkbox" id="clickToggle" onchange="saveSettings()">
      </label>

      <label>Vibration (Mobile)
        <input type="checkbox" id="vibrationToggle" onchange="saveSettings()">
      </label>
    </div>

    <button class="btn" onclick="openFullscreen()">Fullscreen ðŸ“±</button>
    <button class="btn" onclick="openSection('mainMenu')">Back</button>
  </div>
</div>

<!-- AI PAGE -->
<div id="aiPage" class="section">
  <h2>MR7 AI Chat</h2>
  <div class="card">
    <div id="chat"></div>

    <input type="text" id="aiInput" placeholder="Ask anything...">
    <button class="btn" onclick="askAI()">Send</button>
    <button class="btn" onclick="clearChat()">Clear Chat</button>

    <br>
    <button class="btn" onclick="openSection('mainMenu')">Back</button>
  </div>
</div>

<!-- GAME PAGE -->
<div id="gamePage" class="section">
  <h2>MR7 Games</h2>

  <button class="btn" onclick="openGame('snakeBox'); startSnake()">Snake Game</button>
  <button class="btn" onclick="openGame('carBox'); startCar()">Car Game</button>

  <p id="achievementText" style="color:gold;font-weight:bold;"></p>

  <div id="snakeBox" style="display:none;">
    <h3>Snake Game</h3>
    <p id="snakeScoreText">Score: 0 | High Score: 0</p>
    <canvas id="snakeCanvas" width="320" height="320"></canvas><br>
    <button class="btn" onclick="startSnake()">Restart Snake</button>
  </div>

  <div id="carBox" style="display:none;">
    <h3>Car Game</h3>
    <p id="carScoreText">Score: 0 | High Score: 0</p>
    <canvas id="carCanvas" width="320" height="420"></canvas><br>
    <button class="btn" onclick="startCar()">Restart Car</button>
  </div>

  <br><br>
  <button class="btn" onclick="openSection('mainMenu')">Back</button>
</div>

<!-- CONTACT PAGE -->
<div id="contactPage" class="section">
  <h2>Contact MR7</h2>
  <div class="card">
    <input type="text" id="name" placeholder="Your Name">
    <input type="text" id="mobile" placeholder="Mobile Number">
    <textarea id="message" placeholder="Your Message"></textarea>
    <button class="btn" onclick="sendMail()">Send</button>
    <br><br>
    <button class="btn" onclick="openSection('mainMenu')">Back</button>
  </div>
</div>

<!-- AUDIO -->
<audio id="bgMusic" loop>
  <source src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3">
</audio>

<audio id="clickSound">
  <source src="https://www.myinstants.com/media/sounds/mouse-click.mp3">
</audio>

<script>
/* PRELOADER + LOGIN */
window.addEventListener("load", () => {
  setTimeout(() => {
    document.getElementById("preloader").style.display = "none";
    showPopup("Welcome to MR7 WORLD ðŸ˜ŽðŸ”¥");
  }, 1200);

  createParticles();

  let logged = localStorage.getItem("mr7Login");
  if (logged === "true") {
    openSection("mainMenu");
    startTypingTitle();
  } else {
    openSection("loginPage");
  }

  loadSettings();
  updateOnlineStatus();
});

/* POPUP */
function showPopup(msg){
  let pop = document.getElementById("popup");
  pop.innerText = msg;
  pop.style.display = "block";
  setTimeout(()=> pop.style.display="none", 3500);
}

/* PARTICLES */
function createParticles(){
  for (let i = 0; i < 40; i++) {
    let p = document.createElement("div");
    p.className = "particle";
    p.style.left = Math.random() * 100 + "%";
    p.style.top = (Math.random() * 100) + "%";
    p.style.animationDuration = (4 + Math.random() * 6) + "s";
    document.body.appendChild(p);
  }
}

/* ONLINE OFFLINE */
function updateOnlineStatus(){
  let status = document.getElementById("onlineStatus");

  function check(){
    if(navigator.onLine){
      status.innerText = "ðŸŸ¢ Online";
      status.style.color="lime";
    }else{
      status.innerText = "ðŸ”´ Offline";
      status.style.color="red";
    }
  }
  check();
  window.addEventListener("online", check);
  window.addEventListener("offline", check);
}

/* DOT MENU */
function toggleDots() {
  let menu = document.getElementById("dotsMenu");
  menu.style.display = menu.style.display === "block" ? "none" : "block";
}
function closeDots() {
  document.getElementById("dotsMenu").style.display = "none";
}
document.addEventListener("click", (e) => {
  if (!e.target.classList.contains("dots") && !e.target.closest("#dotsMenu")) {
    closeDots();
  }
});

/* OPEN SECTION */
function openSection(id) {
  document.querySelectorAll(".section").forEach(s => s.classList.remove("active"));
  document.getElementById(id).classList.add("active");
}

/* TYPING TITLE */
function startTypingTitle() {
  let text = "- MR7 WORLD -";
  let i = 0;
  let el = document.getElementById("typingTitle");
  el.innerHTML = "";
  let t = setInterval(() => {
    el.innerHTML += text.charAt(i);
    i++;
    if (i >= text.length) clearInterval(t);
  }, 120);
}

/* THEME */
function applyMode() {
  let mode = localStorage.getItem("mode") || "dark";
  if (mode === "light") document.body.classList.add("light");
  else document.body.classList.remove("light");
}
applyMode();

function toggleMode() {
  if (document.body.classList.contains("light")) {
    document.body.classList.remove("light");
    localStorage.setItem("mode", "dark");
  } else {
    document.body.classList.add("light");
    localStorage.setItem("mode", "light");
  }
}

/* LOGIN */
function isValidEmail(email) {
  return /^[^\s@]+@[^\s@]+\.[^\s@]{2,}$/.test(email);
}

function loginUser() {
  let email = document.getElementById("loginEmail").value.trim();
  let pass = document.getElementById("loginPassword").value.trim();
  let status = document.getElementById("loginStatus");

  if (!email || !pass) {
    status.style.color = "red";
    status.innerText = "Email and Password required!";
    return;
  }

  if (!isValidEmail(email)) {
    status.style.color = "red";
    status.innerText = "Invalid Email!";
    return;
  }

  localStorage.setItem("mr7Login", "true");
  localStorage.setItem("mr7Email", email);

  status.style.color = "lime";
  status.innerText = "Login Successful Boss ðŸ˜ŽðŸ”¥";

  setTimeout(() => {
    openSection("mainMenu");
    startTypingTitle();
  }, 500);
}

function logoutUser() {
  localStorage.removeItem("mr7Login");
  localStorage.removeItem("mr7Email");
  closeDots();
  openSection("loginPage");
}

/* SEARCH MENU */
function searchMenu(){
  let q = document.getElementById("menuSearch").value.toLowerCase().trim();

  if(q.includes("ai")) openSection("aiPage");
  else if(q.includes("game")) openSection("gamePage");
  else if(q.includes("contact")) openSection("contactPage");
  else if(q.includes("profile")) openSection("profileCardPage");
  else if(q.includes("setting")) openSection("settingsPage");
  else showPopup("No match found ðŸ˜… Try: ai, games, profile");
}

/* CONTACT */
function sendMail() {
  let n = document.getElementById("name").value.trim();
  let m = document.getElementById("mobile").value.trim();
  let msg = document.getElementById("message").value.trim();

  if (!n || !msg) {
    alert("Please enter Name and Message ðŸ˜…");
    return;
  }

  let subject = encodeURIComponent("MR7 Help from " + n);
  let body = encodeURIComponent("Name: " + n + "\nMobile: " + m + "\n\nMessage:\n" + msg);

  location.href = "mailto:mrrehanofficial.1777@gmail.com?subject=" + subject + "&body=" + body;
}

/* SETTINGS */
function saveSettings(){
  localStorage.setItem("musicOn", document.getElementById("musicToggle").checked);
  localStorage.setItem("clickOn", document.getElementById("clickToggle").checked);
  localStorage.setItem("vibrationOn", document.getElementById("vibrationToggle").checked);

  handleMusic();
  showPopup("Settings saved ðŸ˜Ž");
}

function loadSettings(){
  document.getElementById("musicToggle").checked = localStorage.getItem("musicOn") === "true";
  document.getElementById("clickToggle").checked = localStorage.getItem("clickOn") === "true";
  document.getElementById("vibrationToggle").checked = localStorage.getItem("vibrationOn") === "true";
  handleMusic();
}

function handleMusic(){
  let bg = document.getElementById("bgMusic");
  if(localStorage.getItem("musicOn")==="true"){
    bg.volume = 0.2;
    bg.play().catch(()=>{});
  }else{
    bg.pause();
  }
}

function playClick(){
  if(localStorage.getItem("clickOn")==="true"){
    document.getElementById("clickSound").play().catch(()=>{});
  }
}

document.addEventListener("click", ()=>{
  playClick();
  if(localStorage.getItem("vibrationOn")==="true" && navigator.vibrate){
    navigator.vibrate(20);
  }
});

/* FULLSCREEN */
function openFullscreen(){
  let elem = document.documentElement;
  if (elem.requestFullscreen) elem.requestFullscreen();
  else if (elem.webkitRequestFullscreen) elem.webkitRequestFullscreen();
  showPopup("Fullscreen enabled ðŸ“±ðŸ”¥");
}

/* ======================
   SUPER SMART MR7 AI
====================== */
let chat = document.getElementById("chat");
let aiInput = document.getElementById("aiInput");

function addMsg(text, cls) {
  let div = document.createElement("div");
  div.className = cls;
  div.innerText = text;
  chat.appendChild(div);
  chat.scrollTop = chat.scrollHeight;
}

function typeAIReply(reply) {
  let div = document.createElement("div");
  div.className = "bot";
  chat.appendChild(div);

  let i = 0;
  let typing = setInterval(() => {
    div.innerText = "AI: " + reply.substring(0, i);
    i++;
    chat.scrollTop = chat.scrollHeight;
    if (i > reply.length) clearInterval(typing);
  }, 15);
}

/* AI MEMORY */
function saveChatToMemory(text){
  localStorage.setItem("mr7LastChat", text);
}
function loadMemory(){
  let last = localStorage.getItem("mr7LastChat");
  if(last){
    addMsg("AI: Welcome back Boss ðŸ˜Ž Last time you asked: " + last, "bot");
  }else{
    addMsg("AI: Hello Boss ðŸ˜Ž Ask me anything!", "bot");
  }
}
loadMemory();

/* AI BRAIN */
function smartAI(q) {
  let text = q.toLowerCase().trim();

  if(text.includes("your name") || text.includes("who are you")){
    return "Boss main MR7 AI hoon ðŸ˜Ž Main coding, gaming, tech, motivation sab me help karta hoon!";
  }

  if(text.includes("owner") || text.includes("creator")){
    return "Boss MR7 WORLD ka owner Md Rehan hai ðŸ˜ŽðŸ”¥";
  }

  if(text.includes("python")){
    return "Boss Python ek powerful language hai. AI, web, automation, hacking tools sab me use hota hai.";
  }

  if(text.includes("html")){
    return "Boss HTML website ka structure banata hai, jaise body skeleton.";
  }

  if(text.includes("css")){
    return "Boss CSS website ka design banata hai. Colors, animation, layout sab CSS se hota hai.";
  }

  if(text.includes("javascript") || text.includes("js")){
    return "Boss JavaScript website ka brain hai. Buttons, AI, games sab JS se control hota hai.";
  }

  if(text.includes("how to earn") || text.includes("earn money")){
    return "Boss earning ke best ways: freelancing, YouTube, website projects, affiliate marketing, and app development.";
  }

  if(text.includes("freelancing")){
    return "Boss freelancing start karo: Fiverr, Upwork, Freelancer. Small projects se start karo then big clients milenge.";
  }

  if(text.includes("youtube")){
    return "Boss YouTube grow ke liye: daily shorts + good thumbnail + trending topic + consistency = success.";
  }

  if(text.includes("ronaldo")){
    return "Boss Ronaldo best hai ðŸ˜Ž Discipline + hardwork = GOAT mindset!";
  }

  if(text.includes("motivation") || text.includes("depressed") || text.includes("sad")){
    return "Boss tension mat lo ðŸ˜Ž Tum ek din top pe jaoge. Bas daily thoda thoda progress karo.";
  }

  if(text.startsWith("calc")){
    try{
      let exp = text.replace("calc","").trim();
      if(!exp) return "Boss example: calc 50+20";
      let result = eval(exp);
      return "Boss answer is: " + result;
    }catch{
      return "Boss calculation error ðŸ˜… Example: calc 10*5";
    }
  }

  if(text.includes("open game") || text.includes("snake")){
    return "Boss Snake game open karne ke liye Games section me jao ðŸ˜Ž";
  }

  return "Boss ye interesting hai ðŸ˜Ž Thoda detail me bolo, main full clear answer dunga!";
}

function askAI() {
  let q = aiInput.value.trim();
  if (!q) return;

  addMsg("You: " + q, "user");
  aiInput.value = "";

  saveChatToMemory(q);

  setTimeout(() => {
    let reply = smartAI(q);
    typeAIReply(reply);
  }, 250);
}

aiInput.addEventListener("keypress", (e) => {
  if (e.key === "Enter") askAI();
});

function clearChat() {
  if (confirm("Clear full chat?")) {
    chat.innerHTML = "";
    localStorage.removeItem("mr7LastChat");
    loadMemory();
  }
}

/* ======================
   GAME SYSTEM
====================== */
function openGame(id) {
  document.getElementById("snakeBox").style.display = "none";
  document.getElementById("carBox").style.display = "none";
  document.getElementById(id).style.display = "block";
}

/* ACHIEVEMENTS */
function updateAchievement(score){
  let txt = document.getElementById("achievementText");

  if(score >= 50){
    txt.innerText = "ðŸ† Achievement Unlocked: LEGEND PLAYER!";
  }else if(score >= 20){
    txt.innerText = "ðŸŽ– Achievement Unlocked: PRO GAMER!";
  }else if(score >= 10){
    txt.innerText = "â­ Achievement Unlocked: Beginner Winner!";
  }else{
    txt.innerText = "";
  }
}

/* ======================
   SNAKE GAME (FIXED)
====================== */
let snakeCanvas = document.getElementById("snakeCanvas");
let sctx = snakeCanvas.getContext("2d");

let snake, food, dir, snakeInterval;
let snakeScore = 0;
let snakeHigh = localStorage.getItem("snakeHigh") ? parseInt(localStorage.getItem("snakeHigh")) : 0;

function resetSnake() {
  snake = [{ x: 160, y: 160 }];
  food = { x: 80, y: 80 };
  dir = "RIGHT";
  snakeScore = 0;
  updateSnakeScore();
}

function updateSnakeScore(){
  document.getElementById("snakeScoreText").innerText =
    "Score: " + snakeScore + " | High Score: " + snakeHigh;
}

function drawSnake() {
  sctx.clearRect(0, 0, 320, 320);

  sctx.fillStyle = "red";
  sctx.fillRect(food.x, food.y, 20, 20);

  sctx.fillStyle = "lime";
  snake.forEach(part => {
    sctx.fillRect(part.x, part.y, 20, 20);
  });
}

function moveSnake() {
  let head = { ...snake[0] };

  if (dir === "RIGHT") head.x += 20;
  if (dir === "LEFT") head.x -= 20;
  if (dir === "UP") head.y -= 20;
  if (dir === "DOWN") head.y += 20;

  if (head.x < 0 || head.y < 0 || head.x >= 320 || head.y >= 320) {
    clearInterval(snakeInterval);
    alert("Game Over ðŸ˜­");
    return;
  }

  for (let i = 1; i < snake.length; i++) {
    if (snake[i].x === head.x && snake[i].y === head.y) {
      clearInterval(snakeInterval);
      alert("Game Over ðŸ˜­");
      return;
    }
  }

  snake.unshift(head);

  if (head.x === food.x && head.y === food.y) {
    snakeScore++;
    if(snakeScore > snakeHigh){
      snakeHigh = snakeScore;
      localStorage.setItem("snakeHigh", snakeHigh);
    }
    updateAchievement(snakeScore);

    food = {
      x: Math.floor(Math.random() * 16) * 20,
      y: Math.floor(Math.random() * 16) * 20
    };
  } else {
    snake.pop();
  }

  updateSnakeScore();
  drawSnake();
}

function startSnake() {
  resetSnake();
  drawSnake();
  clearInterval(snakeInterval);
  snakeInterval = setInterval(moveSnake, 150);
}

document.addEventListener("keydown", (e) => {
  if (e.key === "ArrowUp" && dir !== "DOWN") dir = "UP";
  if (e.key === "ArrowDown" && dir !== "UP") dir = "DOWN";
  if (e.key === "ArrowLeft" && dir !== "RIGHT") dir = "LEFT";
  if (e.key === "ArrowRight" && dir !== "LEFT") dir = "RIGHT";
});

/* ======================
   CAR GAME (FIXED)
====================== */
let carCanvas = document.getElementById("carCanvas");
let cctx = carCanvas.getContext("2d");

let playerCar, enemies, carScore, carInterval;
let carHigh = localStorage.getItem("carHigh") ? parseInt(localStorage.getItem("carHigh")) : 0;

function resetCar() {
  playerCar = { x: 140, y: 320, w: 40, h: 70, speed: 6 };
  enemies = [
    { x: 60, y: -120, w: 40, h: 70, speed: 5 },
    { x: 220, y: -400, w: 40, h: 70, speed: 6 }
  ];
  carScore = 0;
  updateCarScore();
}

function updateCarScore(){
  document.getElementById("carScoreText").innerText =
    "Score: " + carScore + " | High Score: " + carHigh;
}

function drawRealCar(x, y, w, h, color) {
  cctx.fillStyle = color;
  cctx.fillRect(x, y, w, h);

  cctx.fillStyle = "black";
  cctx.fillRect(x + 6, y + 10, w - 12, h / 3);

  cctx.fillStyle = "#66ccff";
  cctx.fillRect(x + 10, y + 14, w - 20, 18);

  cctx.fillStyle = "#111";
  cctx.fillRect(x - 6, y + 10, 8, 18);
  cctx.fillRect(x + w - 2, y + 10, 8, 18);
  cctx.fillRect(x - 6, y + h - 28, 8, 18);
  cctx.fillRect(x + w - 2, y + h - 28, 8, 18);
}

function drawCarGame() {
  cctx.clearRect(0, 0, 320, 420);

  cctx.fillStyle = "#2a2a2a";
  cctx.fillRect(0, 0, 320, 420);

  cctx.fillStyle = "#111";
  cctx.fillRect(0, 0, 40, 420);
  cctx.fillRect(280, 0, 40, 420);

  cctx.strokeStyle = "white";
  cctx.lineWidth = 4;
  cctx.setLineDash([20, 20]);
  cctx.beginPath();
  cctx.moveTo(160, 0);
  cctx.lineTo(160, 420);
  cctx.stroke();
  cctx.setLineDash([]);

  cctx.fillStyle = "yellow";
  cctx.font = "bold 18px Arial";
  cctx.fillText("Score: " + carScore, 15, 30);

  drawRealCar(playerCar.x, playerCar.y, playerCar.w, playerCar.h, "lime");

  enemies.forEach(e => {
    drawRealCar(e.x, e.y, e.w, e.h, "red");
  });
}

function updateCarGame() {
  enemies.forEach(e => {
    e.y += e.speed;

    if (playerCar.x < e.x + e.w &&
      playerCar.x + playerCar.w > e.x &&
      playerCar.y < e.y + e.h &&
      playerCar.y + playerCar.h > e.y) {
      clearInterval(carInterval);
      alert("ðŸ’¥ Crash! Game Over! Score: " + carScore);
    }

    if (e.y > 450) {
      e.y = -Math.random() * 300 - 100;
      e.x = 60 + Math.random() * 160;
      carScore++;

      if(carScore > carHigh){
        carHigh = carScore;
        localStorage.setItem("carHigh", carHigh);
      }

      updateAchievement(carScore);
      updateCarScore();
    }
  });

  drawCarGame();
}

function startCar() {
  resetCar();
  drawCarGame();
  clearInterval(carInterval);
  carInterval = setInterval(updateCarGame, 30);
}

document.addEventListener("keydown", (e) => {
  if (!playerCar) return;

  if (e.key === "ArrowLeft") playerCar.x -= playerCar.speed * 3;
  if (e.key === "ArrowRight") playerCar.x += playerCar.speed * 3;

  if (playerCar.x < 45) playerCar.x = 45;
  if (playerCar.x > 235) playerCar.x = 235;
});
</script>

</body>
</html>
