<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>MR7 WORLD - Official</title>

<style>
    :root{
        --bg:#050805;
        --panel:#0b120b;
        --green:#00ff3c;
        --green2:#00cc30;
        --text:#eaffea;
        --muted:#9cffb2;
        --danger:#ff3b3b;
        --shadow: 0 0 25px rgba(0,255,60,.35);
        --shadow2: 0 0 60px rgba(0,255,60,.25);
        --radius:18px;
        --card:#071007;
    }

    body{
        margin:0;
        font-family:Segoe UI, Arial, sans-serif;
        background: radial-gradient(circle at top, #061506, #020402 70%);
        color:var(--text);
        overflow-x:hidden;
    }

    .container{
        max-width:1100px;
        margin:auto;
        padding:20px;
    }

    .topBar{
        display:flex;
        justify-content:space-between;
        align-items:center;
        margin-bottom:15px;
    }

    .logo{
        font-size:28px;
        font-weight:800;
        color:var(--green);
        text-shadow:var(--shadow);
        letter-spacing:1px;
    }

    .modeBtn{
        background:var(--green);
        color:black;
        border:none;
        padding:10px 18px;
        border-radius:30px;
        font-weight:700;
        cursor:pointer;
        box-shadow:var(--shadow);
        transition:.2s;
    }
    .modeBtn:hover{ transform:scale(1.05); }

    .mainCard{
        background:rgba(0,0,0,.55);
        border:2px solid var(--green);
        border-radius:var(--radius);
        box-shadow:var(--shadow2);
        padding:18px;
        min-height:70vh;
        position:relative;
    }

    .title{
        text-align:center;
        font-size:26px;
        font-weight:900;
        margin:5px 0 20px;
        text-shadow:var(--shadow);
    }

    .grid{
        display:grid;
        grid-template-columns:repeat(auto-fit, minmax(220px, 1fr));
        gap:16px;
    }

    .cardBtn{
        background:linear-gradient(180deg, rgba(0,255,60,.12), rgba(0,0,0,.65));
        border:2px solid rgba(0,255,60,.7);
        border-radius:16px;
        padding:18px;
        cursor:pointer;
        transition:.2s;
        box-shadow:0 0 25px rgba(0,255,60,.15);
        text-align:left;
    }
    .cardBtn:hover{
        transform:translateY(-5px);
        box-shadow:0 0 35px rgba(0,255,60,.35);
    }

    .cardBtn h3{
        margin:0;
        color:var(--green);
        font-size:18px;
        font-weight:900;
    }
    .cardBtn p{
        margin:8px 0 0;
        color:var(--muted);
        font-size:14px;
        line-height:1.3;
    }

    .hidden{ display:none; }

    .backBtn{
        margin-top:18px;
        display:flex;
        justify-content:center;
    }
    .backBtn button{
        padding:10px 18px;
        border-radius:12px;
        border:none;
        background:#3a3a3a;
        color:white;
        font-weight:700;
        cursor:pointer;
        transition:.2s;
    }
    .backBtn button:hover{ transform:scale(1.05); }

    /* 3 DOT MENU */
    .menuBtn{
        width:50px;
        height:50px;
        border-radius:50%;
        background:rgba(0,255,60,.18);
        border:2px solid var(--green);
        display:flex;
        align-items:center;
        justify-content:center;
        cursor:pointer;
        box-shadow:var(--shadow);
        transition:.2s;
    }
    .menuBtn:hover{ transform:scale(1.05); }

    .dots{
        font-size:26px;
        color:var(--green);
        font-weight:900;
        transform:rotate(90deg);
        user-select:none;
    }

    .menuBox{
        position:absolute;
        top:70px;
        left:20px;
        background:rgba(0,0,0,.9);
        border:2px solid var(--green);
        border-radius:14px;
        padding:10px;
        box-shadow:var(--shadow2);
        width:170px;
        z-index:99;
    }
    .menuBox button{
        width:100%;
        padding:10px;
        margin:6px 0;
        background:rgba(0,255,60,.15);
        border:1px solid rgba(0,255,60,.6);
        color:var(--text);
        border-radius:10px;
        cursor:pointer;
        font-weight:800;
    }
    .menuBox button:hover{
        background:rgba(0,255,60,.3);
    }

    /* LOGIN */
    .loginWrap{
        display:flex;
        justify-content:center;
        align-items:center;
        min-height:90vh;
    }

    .loginCard{
        width:380px;
        background:rgba(0,0,0,.75);
        border:2px solid var(--green);
        border-radius:18px;
        padding:22px;
        box-shadow:var(--shadow2);
    }

    .loginCard h2{
        margin:0 0 15px;
        color:var(--green);
        text-align:center;
        font-size:24px;
        font-weight:900;
        text-shadow:var(--shadow);
    }

    .loginCard input{
        width:100%;
        padding:12px;
        border-radius:12px;
        border:1px solid rgba(0,255,60,.6);
        background:rgba(0,0,0,.65);
        color:var(--text);
        outline:none;
        margin-bottom:12px;
        font-size:14px;
    }

    .loginCard button{
        width:100%;
        padding:12px;
        border-radius:12px;
        border:none;
        background:var(--green);
        color:black;
        font-weight:900;
        cursor:pointer;
        box-shadow:var(--shadow);
        font-size:15px;
    }
    .loginCard button:hover{ background:var(--green2); }

    .error{
        color:var(--danger);
        font-weight:800;
        text-align:center;
        margin-top:10px;
    }

    /* AI CHAT */
    .chatBox{
        background:rgba(0,0,0,.6);
        border:2px solid rgba(0,255,60,.7);
        border-radius:16px;
        padding:12px;
        height:320px;
        overflow-y:auto;
        box-shadow:0 0 25px rgba(0,255,60,.15);
    }

    .msg{
        padding:10px 12px;
        border-radius:14px;
        margin:8px 0;
        font-weight:700;
        line-height:1.4;
        max-width:95%;
        word-wrap:break-word;
    }

    .userMsg{
        background:rgba(0,255,60,.12);
        border:1px solid rgba(0,255,60,.5);
        color:var(--muted);
    }

    .aiMsg{
        background:rgba(0,120,255,.15);
        border:1px solid rgba(0,120,255,.4);
        color:#cde7ff;
    }

    .inputRow{
        display:flex;
        gap:10px;
        margin-top:12px;
    }
    .inputRow input{
        flex:1;
        padding:12px;
        border-radius:12px;
        border:1px solid rgba(0,255,60,.5);
        background:rgba(0,0,0,.65);
        color:var(--text);
        outline:none;
    }
    .inputRow button{
        padding:12px 16px;
        border-radius:12px;
        border:none;
        background:var(--green);
        font-weight:900;
        cursor:pointer;
        box-shadow:var(--shadow);
    }

    /* GAME CANVAS */
    canvas{
        background:#111;
        border:2px solid var(--green);
        border-radius:14px;
        box-shadow:0 0 30px rgba(0,255,60,.25);
        max-width:100%;
    }

    .gameRow{
        display:flex;
        justify-content:center;
        flex-direction:column;
        align-items:center;
        gap:10px;
    }

    .gameInfo{
        color:var(--muted);
        font-weight:800;
        text-align:center;
    }

    .bigBtn{
        padding:12px 20px;
        border:none;
        background:var(--green);
        font-weight:900;
        border-radius:12px;
        cursor:pointer;
        box-shadow:var(--shadow);
    }

    /* LIGHT MODE */
    body.light{
        background:#f4fff4;
        color:#111;
    }
    body.light .mainCard,
    body.light .loginCard{
        background:white;
        color:black;
    }
    body.light .chatBox{
        background:#f8fff8;
    }
    body.light .aiMsg{
        color:#000;
    }
</style>
</head>

<body>

<!-- LOGIN SCREEN -->
<div id="loginScreen" class="loginWrap">
    <div class="loginCard">
        <h2>üîê MR7 LOGIN</h2>
        <input id="email" type="email" placeholder="Enter Real Email" />
        <input id="password" type="password" placeholder="Enter Password" />
        <button onclick="login()">LOGIN</button>
        <div id="loginError" class="error"></div>
        <p style="text-align:center;color:#88ff9c;font-weight:700;margin-top:12px;">
            Default: <b>mr7@gmail.com</b> | Pass: <b>mr7</b>
        </p>
    </div>
</div>

<!-- MAIN WEBSITE -->
<div id="site" class="container hidden">

    <div class="topBar">
        <div class="menuBtn" id="menuBtn" onclick="toggleMenu()">
            <div class="dots">‚ãÆ</div>
        </div>

        <div class="logo">‚ö° MR7 WORLD</div>

        <button class="modeBtn" onclick="toggleMode()">üåô Mode</button>
    </div>

    <div id="menuBox" class="menuBox hidden">
        <button onclick="openPage('home')">üè† Home</button>
        <button onclick="openPage('leaderboard')">üèÜ Leaderboard</button>
        <button onclick="logout()">üö™ Logout</button>
    </div>

    <div class="mainCard">

        <!-- HOME PAGE -->
        <div id="homePage">
            <div class="title">üî• Welcome to MR7 FUTURE WORLD</div>

            <div class="grid">
                <div class="cardBtn" onclick="openPage('ai')">
                    <h3>ü§ñ MR7 AI</h3>
                    <p>Smart Offline AI + Commands + Quiz Mode</p>
                </div>

                <div class="cardBtn" onclick="openPage('games')">
                    <h3>üéÆ Games Zone</h3>
                    <p>Car, Snake, Dino, Flappy, Shooter & More</p>
                </div>

                <div class="cardBtn" onclick="openPage('quiz')">
                    <h3>üß† Quiz Game</h3>
                    <p>Answer questions & win points</p>
                </div>

                <div class="cardBtn" onclick="openPage('contact')">
                    <h3>üìû Help / Contact</h3>
                    <p>Support and information page</p>
                </div>
            </div>

            <div style="margin-top:20px;text-align:center;color:#9cffb2;font-weight:900;">
                üëÅ Visitors: <span id="visitorCount">0</span>
            </div>
        </div>

        <!-- AI PAGE -->
        <div id="aiPage" class="hidden">
            <div class="title">ü§ñ MR7 AI (Smart Offline)</div>

            <div id="chatBox" class="chatBox"></div>

            <div class="inputRow">
                <input id="userInput" placeholder="Ask anything..." />
                <button onclick="sendMsg()">Send</button>
                <button onclick="clearChat()">Clear</button>
            </div>

            <p style="text-align:center;color:#88ff9c;font-weight:800;margin-top:10px;">
                Example: <b>calc 50+20</b>, <b>news</b>, <b>weather kolkata</b>, <b>joke</b>, <b>quiz</b>
            </p>

            <div class="backBtn"><button onclick="openPage('home')">‚¨Ö Back</button></div>
        </div>

        <!-- GAMES PAGE -->
        <div id="gamesPage" class="hidden">
            <div class="title">üéÆ MR7 Games Zone</div>

            <div class="grid">
                <div class="cardBtn" onclick="openPage('snake')">
                    <h3>üêç Snake Game</h3>
                    <p>Real snake + sound + highscore</p>
                </div>

                <div class="cardBtn" onclick="openPage('car')">
                    <h3>üöó Car Racing</h3>
                    <p>Real car + enemy cars + crash sound</p>
                </div>

                <div class="cardBtn" onclick="openPage('dino')">
                    <h3>ü¶ñ Dino Jump</h3>
                    <p>Jump & survive (like Chrome dino)</p>
                </div>

                <div class="cardBtn" onclick="openPage('flappy')">
                    <h3>üê¶ Flappy Bird</h3>
                    <p>Tap to fly and avoid pipes</p>
                </div>
            </div>

            <div class="backBtn"><button onclick="openPage('home')">‚¨Ö Back</button></div>
        </div>

        <!-- CONTACT PAGE -->
        <div id="contactPage" class="hidden">
            <div class="title">üìû Help / Contact</div>
            <p style="text-align:center;color:#9cffb2;font-weight:800;">
                MR7 Official Support<br><br>
                üìß Email: <b>support@mr7world.com</b><br>
                üåê Website: <b>MR7 WORLD</b><br><br>
                üî• Future updates coming soon!
            </p>
            <div class="backBtn"><button onclick="openPage('home')">‚¨Ö Back</button></div>
        </div>

        <!-- LEADERBOARD PAGE -->
        <div id="leaderboardPage" class="hidden">
            <div class="title">üèÜ Leaderboard</div>
            <p style="text-align:center;font-weight:900;color:#9cffb2;">
                Snake Highscore: <span id="snakeHigh">0</span><br><br>
                Car Highscore: <span id="carHigh">0</span><br><br>
                Dino Highscore: <span id="dinoHigh">0</span><br><br>
                Flappy Highscore: <span id="flappyHigh">0</span>
            </p>
            <div class="backBtn"><button onclick="openPage('home')">‚¨Ö Back</button></div>
        </div>

        <!-- QUIZ PAGE -->
        <div id="quizPage" class="hidden">
            <div class="title">üß† Quiz Game</div>

            <div style="text-align:center;font-weight:900;color:#9cffb2;">
                <div id="quizQ" style="font-size:18px;margin-bottom:12px;"></div>
                <div id="quizOptions"></div>
                <p id="quizResult" style="margin-top:12px;"></p>
                <button class="bigBtn" onclick="nextQuiz()">Next Question</button>
            </div>

            <div class="backBtn"><button onclick="openPage('home')">‚¨Ö Back</button></div>
        </div>

        <!-- SNAKE GAME -->
        <div id="snakePage" class="hidden">
            <div class="title">üêç Snake Game</div>
            <div class="gameRow">
                <div class="gameInfo">Score: <span id="snakeScore">0</span></div>
                <canvas id="snakeCanvas" width="320" height="320"></canvas>
                <button class="bigBtn" onclick="startSnake()">Start Snake</button>
            </div>
            <div class="backBtn"><button onclick="openPage('games')">‚¨Ö Back</button></div>
        </div>

        <!-- CAR GAME -->
        <div id="carPage" class="hidden">
            <div class="title">üöó Car Racing</div>
            <div class="gameRow">
                <div class="gameInfo">Score: <span id="carScore">0</span></div>
                <canvas id="carCanvas" width="320" height="420"></canvas>
                <button class="bigBtn" onclick="startCar()">Start Car</button>
            </div>
            <div class="backBtn"><button onclick="openPage('games')">‚¨Ö Back</button></div>
        </div>

        <!-- DINO -->
        <div id="dinoPage" class="hidden">
            <div class="title">ü¶ñ Dino Jump</div>
            <div class="gameRow">
                <div class="gameInfo">Score: <span id="dinoScore">0</span></div>
                <canvas id="dinoCanvas" width="320" height="220"></canvas>
                <button class="bigBtn" onclick="startDino()">Start Dino</button>
            </div>
            <div class="backBtn"><button onclick="openPage('games')">‚¨Ö Back</button></div>
        </div>

        <!-- FLAPPY -->
        <div id="flappyPage" class="hidden">
            <div class="title">üê¶ Flappy Bird</div>
            <div class="gameRow">
                <div class="gameInfo">Score: <span id="flappyScore">0</span></div>
                <canvas id="flappyCanvas" width="320" height="420"></canvas>
                <button class="bigBtn" onclick="startFlappy()">Start Flappy</button>
            </div>
            <div class="backBtn"><button onclick="openPage('games')">‚¨Ö Back</button></div>
        </div>

    </div>
</div>

<script>
/* ===============================
   LOGIN SYSTEM (PROTECTED)
================================ */
let loggedIn = localStorage.getItem("mr7_logged") === "yes";

function validateEmail(email){
    const re = /^[^\s@]+@[^\s@]+\.[^\s@]{2,}$/;
    return re.test(email);
}

function login(){
    let email = document.getElementById("email").value.trim();
    let pass  = document.getElementById("password").value.trim();
    let err   = document.getElementById("loginError");

    if(!validateEmail(email)){
        err.innerHTML = "‚ùå Invalid Email Format!";
        return;
    }

    if(email === "mr7@gmail.com" && pass === "mr7"){
        localStorage.setItem("mr7_logged","yes");
        loggedIn = true;
        document.getElementById("loginScreen").classList.add("hidden");
        document.getElementById("site").classList.remove("hidden");
        updateVisitors();
        updateLeaderboard();
    }else{
        err.innerHTML = "‚ùå Wrong Email or Password!";
    }
}

function logout(){
    localStorage.removeItem("mr7_logged");
    loggedIn = false;
    location.reload();
}

function protectSite(){
    if(loggedIn){
        document.getElementById("loginScreen").classList.add("hidden");
        document.getElementById("site").classList.remove("hidden");
        updateVisitors();
        updateLeaderboard();
    }else{
        document.getElementById("loginScreen").classList.remove("hidden");
        document.getElementById("site").classList.add("hidden");
    }
}
protectSite();

/* ===============================
   VISITOR COUNTER
================================ */
function updateVisitors(){
    let v = localStorage.getItem("mr7_visitors");
    if(!v) v = 0;
    v = parseInt(v) + 1;
    localStorage.setItem("mr7_visitors", v);
    document.getElementById("visitorCount").innerText = v;
}

/* ===============================
   DARK MODE SAVE
================================ */
function toggleMode(){
    document.body.classList.toggle("light");
    localStorage.setItem("mr7_mode", document.body.classList.contains("light") ? "light" : "dark");
}

if(localStorage.getItem("mr7_mode") === "light"){
    document.body.classList.add("light");
}

/* ===============================
   MENU (3 DOTS) PROTECTED
================================ */
function toggleMenu(){
    if(!loggedIn) return;
    document.getElementById("menuBox").classList.toggle("hidden");
}

/* ===============================
   PAGE ROUTER
================================ */
function openPage(page){
    if(!loggedIn) return;

    document.getElementById("menuBox").classList.add("hidden");

    let pages = ["home","ai","games","snake","car","quiz","contact","leaderboard","dino","flappy"];
    pages.forEach(p=>{
        document.getElementById(p+"Page").classList.add("hidden");
    });

    document.getElementById(page+"Page").classList.remove("hidden");
}

/* ===============================
   LEADERBOARD
================================ */
function updateLeaderboard(){
    document.getElementById("snakeHigh").innerText = localStorage.getItem("snakeHigh") || 0;
    document.getElementById("carHigh").innerText = localStorage.getItem("carHigh") || 0;
    document.getElementById("dinoHigh").innerText = localStorage.getItem("dinoHigh") || 0;
    document.getElementById("flappyHigh").innerText = localStorage.getItem("flappyHigh") || 0;
}

/* ===============================
   SOUND FX (Simple)
================================ */
function playBeep(freq=400, time=0.12){
    let ctx = new (window.AudioContext || window.webkitAudioContext)();
    let osc = ctx.createOscillator();
    let gain = ctx.createGain();
    osc.frequency.value = freq;
    osc.connect(gain);
    gain.connect(ctx.destination);
    osc.start();
    gain.gain.setValueAtTime(0.2, ctx.currentTime);
    osc.stop(ctx.currentTime + time);
}

/* ===============================
   SMART OFFLINE AI
================================ */
function addMsg(text, type){
    let box = document.getElementById("chatBox");
    let div = document.createElement("div");
    div.className = "msg " + (type==="user" ? "userMsg" : "aiMsg");
    div.innerHTML = text;
    box.appendChild(div);
    box.scrollTop = box.scrollHeight;
}

function clearChat(){
    document.getElementById("chatBox").innerHTML = "";
}

function smartAI(msg){
    msg = msg.toLowerCase().trim();

    // calculator
    if(msg.startsWith("calc")){
        try{
            let exp = msg.replace("calc","").trim();
            let result = Function("return "+exp)();
            return "üßÆ Result: <b>"+result+"</b>";
        }catch(e){
            return "‚ùå Calculation error. Example: calc 50+20";
        }
    }

    // weather
    if(msg.includes("weather")){
        return "üå¶ Weather feature offline mode me limited hai.<br>‡§≤‡•á‡§ï‡§ø‡§® agar tum OpenAI API add karoge to real live weather info de dunga.";
    }

    // news
    if(msg.includes("news")){
        return "üì∞ Offline mode me live news nahi aa sakta.<br>‡§≤‡•á‡§ï‡§ø‡§® main suggest kar sakta hu:<br>1Ô∏è‚É£ India Politics<br>2Ô∏è‚É£ Sports Updates<br>3Ô∏è‚É£ Tech Updates<br><br>API add karoge to main daily top 3 news real de dunga.";
    }

    // jokes
    if(msg.includes("joke")){
        let jokes = [
            "üòÇ Teacher: Tum late kyu aaye? Student: Sir, sapne me coding kar raha tha!",
            "ü§£ Programmer ka favorite place? Ctrl + Alt + Delete!",
            "üòÜ GF: Tum mujhe time nahi dete. BF: Wait... loading..."
        ];
        return jokes[Math.floor(Math.random()*jokes.length)];
    }

    // greetings
    if(msg.includes("hello") || msg.includes("hi") || msg.includes("hey")){
        return "üòéüî• Hello Boss! MR7 AI ready hai. Batao kya help chahiye?";
    }

    // motivation
    if(msg.includes("motivation") || msg.includes("sad")){
        return "üî• Boss, tu ekdin bada developer banega. Bas daily practice kar. MR7 never stops üòé‚ö°";
    }

    // coding help
    if(msg.includes("python")){
        return "üêç Python help ready boss!<br>Tu mujhe topic bol: if-else, loop, function, list, string, OOP.";
    }

    if(msg.includes("html")){
        return "üåê HTML help ready! Tum website ka design, buttons, layout, CSS effects kuch bhi puch sakte ho.";
    }

    // quiz mode
    if(msg.includes("quiz")){
        return "üß† Quiz Mode ON! Home page me Quiz Game open karo aur start karo üòéüî•";
    }

    // fallback smart reply
    return "ü§ñ MR7 AI: Boss main samajh gaya üòéüî•<br>Tu thoda clear bol, main full answer de dunga!";
}

function sendMsg(){
    let input = document.getElementById("userInput");
    let text = input.value.trim();
    if(text==="") return;

    addMsg("You: "+text,"user");
    playBeep(700,0.08);

    setTimeout(()=>{
        let reply = smartAI(text);
        addMsg("AI: "+reply,"ai");
        playBeep(400,0.09);
    },400);

    input.value="";
}

document.getElementById("userInput").addEventListener("keydown", function(e){
    if(e.key==="Enter") sendMsg();
});

/* ===============================
   QUIZ GAME
================================ */
let quizData = [
    {q:"HTML ka full form kya hai?", a:["Hyper Text Markup Language","High Text Machine Language","Hyper Tool Markup"], c:0},
    {q:"Python kis type ki language hai?", a:["Low Level","High Level","Machine"], c:1},
    {q:"CSS use hota hai?", a:["Design ke liye","Database ke liye","Game banane"], c:0},
    {q:"JavaScript use hota hai?", a:["Web interactivity","Cooking","Photoshop"], c:0},
    {q:"CPU ka full form?", a:["Central Processing Unit","Computer Power Unit","Control Process Unit"], c:0}
];
let quizIndex = 0;

function loadQuiz(){
    let q = quizData[quizIndex];
    document.getElementById("quizQ").innerText = "Q: " + q.q;
    let optBox = document.getElementById("quizOptions");
    optBox.innerHTML = "";

    q.a.forEach((opt,i)=>{
        let btn = document.createElement("button");
        btn.className="bigBtn";
        btn.style.margin="6px";
        btn.innerText = opt;
        btn.onclick = ()=>checkQuiz(i);
        optBox.appendChild(btn);
    });

    document.getElementById("quizResult").innerText="";
}

function checkQuiz(i){
    let q = quizData[quizIndex];
    if(i === q.c){
        document.getElementById("quizResult").innerText="‚úÖ Correct!";
        playBeep(900,0.12);
    }else{
        document.getElementById("quizResult").innerText="‚ùå Wrong!";
        playBeep(200,0.2);
    }
}

function nextQuiz(){
    quizIndex++;
    if(quizIndex >= quizData.length) quizIndex = 0;
    loadQuiz();
}
loadQuiz();

/* ===============================
   SNAKE GAME (REAL)
================================ */
let snakeInterval;
function startSnake(){
    clearInterval(snakeInterval);
    let canvas = document.getElementById("snakeCanvas");
    let ctx = canvas.getContext("2d");

    let grid = 20;
    let snake = [{x:160,y:160}];
    let dir = {x:grid,y:0};
    let food = {x:100,y:100};
    let score = 0;

    document.getElementById("snakeScore").innerText=0;

    function randomFood(){
        food.x = Math.floor(Math.random()*(canvas.width/grid))*grid;
        food.y = Math.floor(Math.random()*(canvas.height/grid))*grid;
    }
    randomFood();

    document.onkeydown = (e)=>{
        if(e.key==="ArrowUp" && dir.y===0) dir={x:0,y:-grid};
        if(e.key==="ArrowDown" && dir.y===0) dir={x:0,y:grid};
        if(e.key==="ArrowLeft" && dir.x===0) dir={x:-grid,y:0};
        if(e.key==="ArrowRight" && dir.x===0) dir={x:grid,y:0};
    };

    // mobile swipe
    let startX=0,startY=0;
    canvas.ontouchstart=(e)=>{
        startX=e.touches[0].clientX;
        startY=e.touches[0].clientY;
    };
    canvas.ontouchend=(e)=>{
        let endX=e.changedTouches[0].clientX;
        let endY=e.changedTouches[0].clientY;
        let dx=endX-startX;
        let dy=endY-startY;

        if(Math.abs(dx)>Math.abs(dy)){
            if(dx>20 && dir.x===0) dir={x:grid,y:0};
            if(dx<-20 && dir.x===0) dir={x:-grid,y:0};
        }else{
            if(dy>20 && dir.y===0) dir={x:0,y:grid};
            if(dy<-20 && dir.y===0) dir={x:0,y:-grid};
        }
    };

    snakeInterval = setInterval(()=>{
        ctx.clearRect(0,0,canvas.width,canvas.height);

        let head = {x:snake[0].x + dir.x, y:snake[0].y + dir.y};

        // wall wrap
        if(head.x<0) head.x=canvas.width-grid;
        if(head.x>=canvas.width) head.x=0;
        if(head.y<0) head.y=canvas.height-grid;
        if(head.y>=canvas.height) head.y=0;

        // collision
        for(let i=1;i<snake.length;i++){
            if(head.x===snake[i].x && head.y===snake[i].y){
                playBeep(150,0.3);
                clearInterval(snakeInterval);
                alert("Game Over! Score: "+score);
                let high = parseInt(localStorage.getItem("snakeHigh")||0);
                if(score>high) localStorage.setItem("snakeHigh",score);
                updateLeaderboard();
                return;
            }
        }

        snake.unshift(head);

        // food eat
        if(head.x===food.x && head.y===food.y){
            score++;
            playBeep(900,0.12);
            document.getElementById("snakeScore").innerText=score;
            randomFood();
        }else{
            snake.pop();
        }

        // draw food
        ctx.fillStyle="red";
        ctx.fillRect(food.x,food.y,grid,grid);

        // draw snake
        snake.forEach((p,idx)=>{
            ctx.fillStyle = idx===0 ? "#00ff3c" : "#00aa2b";
            ctx.fillRect(p.x,p.y,grid,grid);
        });

    },110);
}

/* ===============================
   CAR GAME (REAL CAR)
================================ */
let carInterval;
function startCar(){
    clearInterval(carInterval);
    let canvas = document.getElementById("carCanvas");
    let ctx = canvas.getContext("2d");

    let car = {x:140,y:330,w:40,h:70};
    let enemies = [];
    let score = 0;
    document.getElementById("carScore").innerText=0;

    function spawnEnemy(){
        let laneX = [60,140,220];
        enemies.push({x:laneX[Math.floor(Math.random()*3)], y:-80, w:40, h:70});
    }

    function drawRoad(){
        ctx.fillStyle="#333";
        ctx.fillRect(40,0,240,420);

        ctx.strokeStyle="white";
        ctx.lineWidth=4;
        ctx.setLineDash([20,20]);
        ctx.beginPath();
        ctx.moveTo(160,0);
        ctx.lineTo(160,420);
        ctx.stroke();
        ctx.setLineDash([]);
    }

    function drawCar(obj,color){
        ctx.fillStyle=color;
        ctx.fillRect(obj.x,obj.y,obj.w,obj.h);

        // windows
        ctx.fillStyle="black";
        ctx.fillRect(obj.x+8,obj.y+10,obj.w-16,18);

        // wheels
        ctx.fillStyle="#111";
        ctx.fillRect(obj.x-6,obj.y+10,6,18);
        ctx.fillRect(obj.x+obj.w,obj.y+10,6,18);
        ctx.fillRect(obj.x-6,obj.y+45,6,18);
        ctx.fillRect(obj.x+obj.w,obj.y+45,6,18);
    }

    document.onkeydown=(e)=>{
        if(e.key==="ArrowLeft") car.x -= 80;
        if(e.key==="ArrowRight") car.x += 80;
        if(car.x<60) car.x=60;
        if(car.x>220) car.x=220;
    };

    // mobile swipe
    let sx=0;
    canvas.ontouchstart=(e)=>{ sx=e.touches[0].clientX; };
    canvas.ontouchend=(e)=>{
        let ex=e.changedTouches[0].clientX;
        if(ex-sx>30) car.x+=80;
        if(ex-sx<-30) car.x-=80;
        if(car.x<60) car.x=60;
        if(car.x>220) car.x=220;
    };

    spawnEnemy();

    carInterval = setInterval(()=>{
        ctx.clearRect(0,0,canvas.width,canvas.height);

        drawRoad();
        drawCar(car,"#00ff3c");

        if(Math.random()<0.04) spawnEnemy();

        enemies.forEach(en=>{
            en.y += 6;

            drawCar(en,"red");

            // collision
            if(car.x < en.x+en.w && car.x+car.w > en.x && car.y < en.y+en.h && car.y+car.h > en.y){
                playBeep(120,0.4);
                clearInterval(carInterval);
                alert("CRASH! Score: "+score);
                let high = parseInt(localStorage.getItem("carHigh")||0);
                if(score>high) localStorage.setItem("carHigh",score);
                updateLeaderboard();
            }
        });

        enemies = enemies.filter(e=>e.y<450);

        score++;
        document.getElementById("carScore").innerText=score;

    },50);
}

/* ===============================
   DINO GAME
================================ */
let dinoInterval;
function startDino(){
    clearInterval(dinoInterval);

    let canvas = document.getElementById("dinoCanvas");
    let ctx = canvas.getContext("2d");

    let dino = {x:40,y:150,w:30,h:40,vy:0};
    let gravity=1.2;
    let obstacle={x:320,y:170,w:20,h:30};
    let score=0;

    document.getElementById("dinoScore").innerText=0;

    function jump(){
        if(dino.y>=150){
            dino.vy=-14;
            playBeep(700,0.08);
        }
    }

    document.onkeydown=(e)=>{ if(e.key===" ") jump(); };
    canvas.onclick=jump;

    dinoInterval=setInterval(()=>{
        ctx.clearRect(0,0,canvas.width,canvas.height);

        // ground
        ctx.fillStyle="#444";
        ctx.fillRect(0,190,320,30);

        // dino physics
        dino.vy+=gravity;
        dino.y+=dino.vy;
        if(dino.y>150){ dino.y=150; dino.vy=0; }

        // obstacle move
        obstacle.x-=6;
        if(obstacle.x<-20){
            obstacle.x=320;
            score++;
            document.getElementById("dinoScore").innerText=score;
        }

        // draw dino
        ctx.fillStyle="#00ff3c";
        ctx.fillRect(dino.x,dino.y,dino.w,dino.h);

        // draw obstacle
        ctx.fillStyle="red";
        ctx.fillRect(obstacle.x,obstacle.y,obstacle.w,obstacle.h);

        // collision
        if(dino.x < obstacle.x+obstacle.w && dino.x+dino.w > obstacle.x && dino.y < obstacle.y+obstacle.h && dino.y+dino.h > obstacle.y){
            playBeep(150,0.3);
            clearInterval(dinoInterval);
            alert("Game Over! Score: "+score);
            let high=parseInt(localStorage.getItem("dinoHigh")||0);
            if(score>high) localStorage.setItem("dinoHigh",score);
            updateLeaderboard();
        }

    },40);
}

/* ===============================
   FLAPPY BIRD
================================ */
let flappyInterval;
function startFlappy(){
    clearInterval(flappyInterval);

    let canvas=document.getElementById("flappyCanvas");
    let ctx=canvas.getContext("2d");

    let bird={x:60,y:200,vy:0};
    let gravity=0.7;
    let pipes=[{x:320, gapY:200}];
    let score=0;

    document.getElementById("flappyScore").innerText=0;

    function flap(){
        bird.vy=-10;
        playBeep(800,0.06);
    }
    canvas.onclick=flap;
    document.onkeydown=(e)=>{ if(e.key===" ") flap(); };

    flappyInterval=setInterval(()=>{
        ctx.clearRect(0,0,canvas.width,canvas.height);

        bird.vy+=gravity;
        bird.y+=bird.vy;

        // draw bird
        ctx.fillStyle="#00ff3c";
        ctx.beginPath();
        ctx.arc(bird.x,bird.y,12,0,Math.PI*2);
        ctx.fill();

        // pipes
        pipes.forEach(p=>{
            p.x-=4;

            ctx.fillStyle="green";
            ctx.fillRect(p.x,0,40,p.gapY-60);
            ctx.fillRect(p.x,p.gapY+60,40,420);

            // collision
            if(bird.x+12>p.x && bird.x-12<p.x+40){
                if(bird.y-12<p.gapY-60 || bird.y+12>p.gapY+60){
                    playBeep(120,0.4);
                    clearInterval(flappyInterval);
                    alert("Game Over! Score: "+score);
                    let high=parseInt(localStorage.getItem("flappyHigh")||0);
                    if(score>high) localStorage.setItem("flappyHigh",score);
                    updateLeaderboard();
                }
            }

            if(p.x===60){
                score++;
                document.getElementById("flappyScore").innerText=score;
            }
        });

        pipes=pipes.filter(p=>p.x>-60);

        if(pipes.length<3 && Math.random()<0.03){
            pipes.push({x:320,gapY:120+Math.random()*200});
        }

        // floor/ceiling
        if(bird.y<0 || bird.y>420){
            playBeep(150,0.3);
            clearInterval(flappyInterval);
            alert("Game Over! Score: "+score);
        }

    },30);
}
</script>

</body>
</html>
