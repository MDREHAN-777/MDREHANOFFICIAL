<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MR7 - OFFICIAL</title>

<style>
*{margin:0;padding:0;box-sizing:border-box;}
body{
  font-family:Segoe UI;
  background:#111;
  color:white;
  text-align:center;
  transition:0.4s;
  overflow-x:hidden;
  padding:15px;
}

/* CUSTOM CURSOR (PC) */
@media(min-width:700px){
  body{
    cursor:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32"><text y="24" font-size="24">‚ö°</text></svg>') 16 16, auto;
  }
}

/* BACKGROUND ANIMATION */
body::before{
  content:"";
  position:fixed;
  top:0;left:0;
  width:100%;height:100%;
  z-index:-3;
  background:linear-gradient(120deg,#0f0f0f,#003300,#000,#001a00);
  background-size:400% 400%;
  animation:bgMove 10s infinite alternate;
  opacity:.25;
}
@keyframes bgMove{
  0%{background-position:0% 50%}
  50%{background-position:100% 50%}
  100%{background-position:0% 50%}
}

body.light{
  background:#fff;
  color:#111;
}

/* PARTICLES CANVAS */
#particles{
  position:fixed;
  top:0;left:0;
  width:100%;
  height:100%;
  z-index:-2;
  opacity:0.7;
}

/* PRELOADER */
#preloader{
  position:fixed;
  top:0;left:0;
  width:100%;
  height:100%;
  background:#000;
  display:flex;
  justify-content:center;
  align-items:center;
  flex-direction:column;
  z-index:99999;
}
.loader-circle{
  width:90px;
  height:90px;
  border-radius:50%;
  border:6px solid rgba(0,255,0,0.2);
  border-top:6px solid lime;
  animation:spin 1s linear infinite;
}
@keyframes spin{
  0%{transform:rotate(0deg)}
  100%{transform:rotate(360deg)}
}
#preloader p{
  margin-top:15px;
  font-size:18px;
  color:lime;
  text-shadow:0 0 10px lime;
}

/* DARK TOGGLE */
.dark-toggle{
  position:fixed;
  top:15px;
  right:15px;
  padding:10px 20px;
  border:none;
  border-radius:30px;
  background:lime;
  color:black;
  font-weight:bold;
  cursor:pointer;
  z-index:999;
}

/* FULLSCREEN BTN */
.full-btn{
  position:fixed;
  bottom:15px;
  right:15px;
  padding:10px 18px;
  border:none;
  border-radius:30px;
  background:rgba(0,255,0,0.2);
  border:1px solid lime;
  color:lime;
  font-weight:bold;
  cursor:pointer;
  z-index:999;
  box-shadow:0 0 12px rgba(0,255,0,0.4);
}

/* ONLINE OFFLINE STATUS */
#netStatus{
  position:fixed;
  top:65px;
  right:15px;
  padding:7px 15px;
  border-radius:20px;
  font-weight:bold;
  font-size:14px;
  z-index:999;
  border:1px solid lime;
  background:rgba(0,0,0,0.7);
  color:lime;
}

/* 3 DOT MENU */
.dots{
  position:fixed;
  top:15px;
  left:15px;
  width:45px;
  height:45px;
  border-radius:50%;
  border:none;
  cursor:pointer;
  background:rgba(0,255,0,0.2);
  color:lime;
  font-size:25px;
  font-weight:bold;
  z-index:999;
  border:1px solid lime;
  box-shadow:0 0 15px rgba(0,255,0,0.4);
}
.dots-menu{
  position:fixed;
  top:70px;
  left:15px;
  width:200px;
  padding:10px;
  border-radius:15px;
  background:rgba(0,0,0,0.85);
  border:1px solid lime;
  display:none;
  z-index:999;
}
.dots-menu input{
  width:100%;
  padding:10px;
  border-radius:12px;
  border:1px solid #444;
  outline:none;
  margin-bottom:10px;
}
.dots-menu button{
  width:100%;
  padding:10px;
  margin:6px 0;
  border:none;
  border-radius:12px;
  cursor:pointer;
  background:#222;
  color:white;
  font-weight:bold;
  transition:.3s;
}
.dots-menu button:hover{
  background:lime;
  color:black;
  transform:scale(1.05);
}

/* SECTIONS + SMOOTH TRANSITION */
.section{
  display:none;
  animation:pageAnim .55s ease;
}
.section.active{
  display:block;
}
@keyframes pageAnim{
  from{opacity:0;transform:translateY(25px) scale(0.95)}
  to{opacity:1;transform:translateY(0) scale(1)}
}

/* TITLE */
#typingTitle{
  font-size:34px;
  font-weight:bold;
  color:lime;
  margin-top:30px;
  text-shadow:0 0 15px lime;
}

/* VERIFIED BADGE */
.verified{
  display:inline-block;
  padding:4px 10px;
  border-radius:20px;
  background:rgba(0,255,0,0.15);
  border:1px solid lime;
  color:lime;
  font-size:13px;
  margin-top:8px;
  box-shadow:0 0 15px rgba(0,255,0,0.3);
}

/* PROFILE */
.profile-pic{
  width:200px;
  height:200px;
  border-radius:50%;
  border:5px solid lime;
  box-shadow:0 0 30px lime;
  margin-top:15px;
}

/* BUTTONS */
.btn{
  padding:12px 25px;
  margin:10px;
  border:none;
  border-radius:12px;
  cursor:pointer;
  background:lime;
  font-weight:bold;
  color:black;
  transition:0.3s;
}
.btn:hover{
  transform:scale(1.08);
  box-shadow:0 0 20px lime;
}

.back-btn{
  margin-top:20px;
  background:gray;
  color:white;
}

/* BOX */
.box{
  max-width:540px;
  margin:30px auto;
  padding:20px;
  border-radius:20px;
  background:rgba(0,0,0,.55);
  border:1px solid lime;
  box-shadow:0 0 20px rgba(0,255,0,.4);
}
body.light .box{
  background:rgba(255,255,255,.9);
  color:black;
}

/* INPUT */
input,textarea{
  width:95%;
  padding:12px;
  margin:8px 0;
  border-radius:10px;
  border:1px solid #777;
  outline:none;
}
textarea{height:100px;}

/* CHAT */
#chat{
  height:320px;
  overflow-y:auto;
  background:#000;
  border-radius:15px;
  padding:10px;
  text-align:left;
  border:1px solid lime;
}
body.light #chat{
  background:#f5f5f5;
}
.user{
  background:#00ff8833;
  padding:10px;
  margin:8px 0;
  border-radius:12px;
  color:lime;
}
.bot{
  background:#0088ff33;
  padding:10px;
  margin:8px 0;
  border-radius:12px;
  color:#66ccff;
}

/* MENU GRID */
.menu-grid{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(200px,1fr));
  gap:15px;
  margin-top:20px;
}

/* SOCIAL CARD */
.social-card{
  display:flex;
  justify-content:space-around;
  flex-wrap:wrap;
  gap:10px;
  margin-top:15px;
}
.social-card a{
  flex:1;
  min-width:130px;
  text-decoration:none;
}
.social-card button{
  width:100%;
}

/* GAMES GRID */
.games-grid{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
  gap:15px;
  margin-top:20px;
}

/* CANVAS */
canvas{
  background:#000;
  border-radius:15px;
  border:2px solid lime;
  max-width:100%;
  touch-action:none;
}

/* POPUP NOTIFICATION */
#popup{
  position:fixed;
  top:20px;
  left:50%;
  transform:translateX(-50%);
  background:rgba(0,0,0,0.85);
  border:1px solid lime;
  color:lime;
  padding:12px 20px;
  border-radius:18px;
  font-weight:bold;
  display:none;
  z-index:9999;
  box-shadow:0 0 25px rgba(0,255,0,0.4);
  animation:pop .4s ease;
}
@keyframes pop{
  from{opacity:0;transform:translateX(-50%) translateY(-20px)}
  to{opacity:1;transform:translateX(-50%) translateY(0)}
}

/* MOBILE FIX */
@media(max-width:600px){
  #typingTitle{font-size:26px;}
  .profile-pic{width:160px;height:160px;}
}
</style>
</head>

<body>

<!-- PRELOADER -->
<div id="preloader">
  <div class="loader-circle"></div>
  <p>Loading MR7 WORLD...</p>
</div>

<!-- PARTICLES -->
<canvas id="particles"></canvas>

<!-- POPUP -->
<div id="popup">üî• Welcome to MR7 WORLD!</div>

<!-- NET STATUS -->
<div id="netStatus">üü¢ Online</div>

<!-- 3 DOT MENU -->
<button class="dots" onclick="toggleDots()">‚ãÆ</button>
<div class="dots-menu" id="dotsMenu">
  <input id="menuSearch" placeholder="Search page...">
  <button onclick="openSection('mainMenu'); closeDots()">üè† Home</button>
  <button onclick="openSection('aiPage'); closeDots()">ü§ñ MR7 AI</button>
  <button onclick="openSection('gamesPage'); closeDots()">üéÆ Games</button>
  <button onclick="openSection('settingsPage'); closeDots()">‚öô Settings</button>
  <button onclick="openSection('helpPage'); closeDots()">üì© Help</button>
  <button onclick="logoutUser()">üö™ Logout</button>
</div>

<button class="dark-toggle" onclick="toggleMode()">üåô Mode</button>
<button class="full-btn" onclick="goFull()">‚õ∂ Fullscreen</button>

<!-- AUDIO -->
<audio id="bgMusic" loop>
  <source src="music.mp3" type="audio/mpeg">
</audio>
<audio id="clickSound">
  <source src="click.mp3" type="audio/mpeg">
</audio>

<!-- LOGIN PAGE -->
<div id="loginPage" class="section active">
  <div class="box">
    <h2>üîê Login Required</h2>
    <p style="margin-top:8px;color:lime;">Login first to enter MR7 WORLD üî•</p>

    <input id="loginEmail" placeholder="Enter Email">
    <input id="loginPassword" type="password" placeholder="Enter Password">

    <button class="btn" onclick="loginUser()">Login</button>

    <p id="loginStatus" style="margin-top:10px;font-weight:bold;"></p>
  </div>
</div>

<!-- MAIN MENU PAGE -->
<div id="mainMenu" class="section">
  <h1 id="typingTitle"></h1>

  <h2>MD REHAN</h2>
  <div class="verified">‚úî Verified MR7 OFFICIAL</div>

  <a href="https://www.youtube.com/@MR7OFFICIAL777" target="_blank">
    <button class="btn">üî• SUBSCRIBE</button>
  </a>

  <p>üëÜ Click here ‚òù</p>

  <img src="rehan.png" class="profile-pic">

  <!-- SOCIAL LINKS -->
  <div class="box">
    <h2>üåê Social Links</h2>
    <div class="social-card">
      <a href="https://www.youtube.com/@MR7OFFICIAL777" target="_blank">
        <button class="btn">üì∫ YouTube</button>
      </a>

      <a href="https://instagram.com/" target="_blank">
        <button class="btn">üì∏ Instagram</button>
      </a>

      <a href="https://wa.me/91" target="_blank">
        <button class="btn">üí¨ WhatsApp</button>
      </a>
    </div>
  </div>

  <div class="box">
    <h2>üöÄ Features</h2>
    <div class="menu-grid">
      <button class="btn" onclick="openSection('aiPage')">ü§ñ MR7 AI</button>
      <button class="btn" onclick="openSection('gamesPage')">üéÆ Games</button>
      <button class="btn" onclick="openSection('helpPage')">üì© Help</button>
    </div>
  </div>

  <div class="box">
    <h2>üèÜ Achievements</h2>
    <p id="achievementsText" style="color:lime;font-weight:bold;"></p>
  </div>
</div>

<!-- SETTINGS PAGE -->
<div id="settingsPage" class="section">
  <div class="box">
    <h2>‚öô Settings</h2>

    <button class="btn" onclick="toggleMusic()">üéµ Music ON/OFF</button>
    <button class="btn" onclick="toggleClick()">üñ± Click Sound ON/OFF</button>
    <button class="btn" onclick="toggleVibration()">üì≥ Vibration ON/OFF</button>

    <p id="settingsStatus" style="margin-top:10px;color:lime;font-weight:bold;"></p>
  </div>

  <button class="btn back-btn" onclick="openSection('mainMenu')">‚¨Ö Back</button>
</div>

<!-- AI PAGE -->
<div id="aiPage" class="section">
  <div class="box">
    <h2>ü§ñ MR7 AI (Smart Mode)</h2>

    <div id="chat"></div>

    <input id="aiInput" placeholder="Ask anything...">
    <button class="btn" onclick="askAI()">Send</button>
    <button class="btn" onclick="clearChat()">Clear</button>
  </div>

  <button class="btn back-btn" onclick="openSection('mainMenu')">‚¨Ö Back</button>
</div>

<!-- GAMES PAGE -->
<div id="gamesPage" class="section">
  <div class="box">
    <h2>üéÆ MR7 Games Zone</h2>

    <div class="games-grid">
      <button class="btn" onclick="openGame('snakeBox')">üêç Snake Game</button>
      <button class="btn" onclick="openGame('carBox')">üöó Car Racing</button>
      <button class="btn" onclick="openGame('tttBox')">‚ùå‚≠ï Tic Tac Toe</button>
    </div>
  </div>

  <!-- Snake -->
  <div id="snakeBox" class="box" style="display:none;">
    <h2>üêç Snake Game</h2>
    <p style="color:lime;font-weight:bold;">Best Score: <span id="snakeBest">0</span></p>
    <canvas id="snakeCanvas" width="320" height="320"></canvas>
    <button class="btn" onclick="startSnake()">Start Snake</button>
    <button class="btn back-btn" onclick="closeGames()">‚¨Ö Back</button>
  </div>

  <!-- Car -->
  <div id="carBox" class="box" style="display:none;">
    <h2>üöó Car Racing</h2>
    <p style="color:lime;font-weight:bold;">Best Score: <span id="carBest">0</span></p>
    <canvas id="carCanvas" width="320" height="420"></canvas>
    <button class="btn" onclick="startCar()">Start Car</button>
    <button class="btn back-btn" onclick="closeGames()">‚¨Ö Back</button>
  </div>

  <!-- Tic Tac Toe -->
  <div id="tttBox" class="box" style="display:none;">
    <h2>‚ùå‚≠ï Tic Tac Toe</h2>
    <div id="tttBoard" style="display:grid;grid-template-columns:repeat(3,1fr);gap:10px;margin-top:15px;"></div>
    <p id="tttStatus" style="margin-top:10px;color:lime;font-weight:bold;"></p>
    <button class="btn" onclick="resetTTT()">Restart</button>
    <button class="btn back-btn" onclick="closeGames()">‚¨Ö Back</button>
  </div>

  <button class="btn back-btn" onclick="openSection('mainMenu')">‚¨Ö Back Menu</button>
</div>

<!-- HELP PAGE -->
<div id="helpPage" class="section">
  <div class="box">
    <h2>üì© Help / Contact</h2>
    <input id="name" placeholder="Name">
    <input id="mobile" placeholder="Mobile">
    <textarea id="message" placeholder="Message"></textarea>
    <button class="btn" onclick="sendMail()">Send Email</button>
  </div>

  <button class="btn back-btn" onclick="openSection('mainMenu')">‚¨Ö Back</button>
</div>

<script>
/* =======================
   PRELOADER
======================= */
window.addEventListener("load",()=>{
  setTimeout(()=>{
    document.getElementById("preloader").style.display="none";
    showPopup("üî• Welcome to MR7 WORLD!");
  },1200);
});

/* =======================
   POPUP
======================= */
function showPopup(text){
  let p=document.getElementById("popup");
  p.innerText=text;
  p.style.display="block";
  setTimeout(()=>p.style.display="none",2500);
}

/* =======================
   PARTICLES BACKGROUND
======================= */
let pCanvas=document.getElementById("particles");
let pctx=pCanvas.getContext("2d");
let particles=[];

function resizeParticles(){
  pCanvas.width=window.innerWidth;
  pCanvas.height=window.innerHeight;
}
window.addEventListener("resize",resizeParticles);
resizeParticles();

for(let i=0;i<60;i++){
  particles.push({
    x:Math.random()*pCanvas.width,
    y:Math.random()*pCanvas.height,
    r:Math.random()*2+1,
    dx:(Math.random()-0.5)*1.2,
    dy:(Math.random()-0.5)*1.2
  });
}

function drawParticles(){
  pctx.clearRect(0,0,pCanvas.width,pCanvas.height);
  pctx.fillStyle="rgba(0,255,0,0.6)";

  particles.forEach(pt=>{
    pt.x+=pt.dx;
    pt.y+=pt.dy;

    if(pt.x<0||pt.x>pCanvas.width) pt.dx*=-1;
    if(pt.y<0||pt.y>pCanvas.height) pt.dy*=-1;

    pctx.beginPath();
    pctx.arc(pt.x,pt.y,pt.r,0,Math.PI*2);
    pctx.fill();
  });

  requestAnimationFrame(drawParticles);
}
drawParticles();

/* =======================
   ONLINE / OFFLINE STATUS
======================= */
function updateNet(){
  let s=document.getElementById("netStatus");
  if(navigator.onLine){
    s.innerText="üü¢ Online";
    s.style.color="lime";
  }else{
    s.innerText="üî¥ Offline";
    s.style.color="red";
  }
}
window.addEventListener("online",updateNet);
window.addEventListener("offline",updateNet);
updateNet();

/* =======================
   FULLSCREEN
======================= */
function goFull(){
  if(!document.fullscreenElement){
    document.documentElement.requestFullscreen();
  }else{
    document.exitFullscreen();
  }
}

/* =======================
   SOUND SETTINGS
======================= */
let bgMusic=document.getElementById("bgMusic");
let clickSound=document.getElementById("clickSound");

let musicOn = localStorage.getItem("musicOn") || "off";
let clickOn = localStorage.getItem("clickOn") || "on";
let vibOn = localStorage.getItem("vibOn") || "on";

function playClick(){
  if(clickOn==="on"){
    clickSound.currentTime=0;
    clickSound.play().catch(()=>{});
  }
  if(vibOn==="on" && navigator.vibrate){
    navigator.vibrate(40);
  }
}

document.addEventListener("click",()=>playClick());

function toggleMusic(){
  if(musicOn==="off"){
    musicOn="on";
    bgMusic.play().catch(()=>{});
    showPopup("üéµ Music Enabled");
  }else{
    musicOn="off";
    bgMusic.pause();
    showPopup("üéµ Music Disabled");
  }
  localStorage.setItem("musicOn",musicOn);
  updateSettingsStatus();
}

function toggleClick(){
  clickOn = clickOn==="on" ? "off" : "on";
  localStorage.setItem("clickOn",clickOn);
  showPopup("üñ± Click Sound: "+clickOn.toUpperCase());
  updateSettingsStatus();
}

function toggleVibration(){
  vibOn = vibOn==="on" ? "off" : "on";
  localStorage.setItem("vibOn",vibOn);
  showPopup("üì≥ Vibration: "+vibOn.toUpperCase());
  updateSettingsStatus();
}

function updateSettingsStatus(){
  document.getElementById("settingsStatus").innerText =
    "Music: "+musicOn.toUpperCase()+" | Click: "+clickOn.toUpperCase()+" | Vibration: "+vibOn.toUpperCase();
}
updateSettingsStatus();

if(musicOn==="on"){
  setTimeout(()=>bgMusic.play().catch(()=>{}),1000);
}

/* =======================
   DOTS MENU
======================= */
function toggleDots(){
  let menu=document.getElementById("dotsMenu");
  menu.style.display = menu.style.display==="block" ? "none" : "block";
}
function closeDots(){
  document.getElementById("dotsMenu").style.display="none";
}
document.addEventListener("click",(e)=>{
  if(!e.target.classList.contains("dots") && !e.target.closest("#dotsMenu")){
    closeDots();
  }
});

/* MENU SEARCH */
document.getElementById("menuSearch").addEventListener("keyup",(e)=>{
  let val=e.target.value.toLowerCase();

  if(val.includes("home")) openSection("mainMenu");
  if(val.includes("ai")) openSection("aiPage");
  if(val.includes("game")) openSection("gamesPage");
  if(val.includes("help")) openSection("helpPage");
  if(val.includes("setting")) openSection("settingsPage");
});

/* =======================
   OPEN SECTION
======================= */
function openSection(id){
  document.querySelectorAll(".section").forEach(s=>s.classList.remove("active"));
  document.getElementById(id).classList.add("active");
}

/* =======================
   TYPING TITLE
======================= */
function startTypingTitle(){
  let text="- MR7 WORLD -";
  let i=0;
  let el=document.getElementById("typingTitle");
  el.innerHTML="";
  let t=setInterval(()=>{
    el.innerHTML += text.charAt(i);
    i++;
    if(i>=text.length) clearInterval(t);
  },120);
}

/* =======================
   DARK MODE SAVE
======================= */
function applyMode(){
  let mode = localStorage.getItem("mode") || "dark";
  if(mode==="light") document.body.classList.add("light");
  else document.body.classList.remove("light");
}
applyMode();

function toggleMode(){
  if(document.body.classList.contains("light")){
    document.body.classList.remove("light");
    localStorage.setItem("mode","dark");
    showPopup("üåô Dark Mode Enabled");
  }else{
    document.body.classList.add("light");
    localStorage.setItem("mode","light");
    showPopup("‚òÄ Light Mode Enabled");
  }
}

/* =======================
   EMAIL VALIDATION
======================= */
function isValidEmail(email){
  return /^[^\s@]+@[^\s@]+\.[^\s@]{2,}$/.test(email);
}

/* =======================
   LOGIN SYSTEM
======================= */
function loginUser(){
  let email=document.getElementById("loginEmail").value.trim();
  let pass=document.getElementById("loginPassword").value.trim();
  let status=document.getElementById("loginStatus");

  if(!email || !pass){
    status.style.color="red";
    status.innerText="‚ùå Fill Email and Password!";
    return;
  }

  if(!isValidEmail(email)){
    status.style.color="red";
    status.innerText="‚ùå Invalid Email!";
    return;
  }

  if(pass.length < 4){
    status.style.color="red";
    status.innerText="‚ùå Password must be at least 4 chars!";
    return;
  }

  localStorage.setItem("mr7Login","true");
  localStorage.setItem("mr7Email",email);

  status.style.color="lime";
  status.innerText="‚úÖ Login Successful!";

  setTimeout(()=>{
    openSection("mainMenu");
    startTypingTitle();
    loadAchievements();
  },600);
}

function logoutUser(){
  localStorage.removeItem("mr7Login");
  localStorage.removeItem("mr7Email");
  closeDots();
  openSection("loginPage");
}

/* AUTO LOGIN CHECK */
window.onload=()=>{
  let logged = localStorage.getItem("mr7Login");
  if(logged==="true"){
    openSection("mainMenu");
    startTypingTitle();
    loadAchievements();
  }else{
    openSection("loginPage");
  }
};

/* =======================
   CONTACT EMAIL
======================= */
function sendMail(){
  let n=document.getElementById("name").value.trim();
  let m=document.getElementById("mobile").value.trim();
  let msg=document.getElementById("message").value.trim();

  if(!n || !msg){
    alert("Please enter Name and Message üòÖ");
    return;
  }

  let subject = encodeURIComponent("MR7 Help from " + n);
  let body = encodeURIComponent("Name: " + n + "\nMobile: " + m + "\n\nMessage:\n" + msg);

  location.href="mailto:mrrehanofficial.1777@gmail.com?subject="+subject+"&body="+body;
}

/* =======================
   MR7 AI MEMORY + SMART
======================= */
let chat=document.getElementById("chat");
let aiInput=document.getElementById("aiInput");

function addMsg(text,cls){
  let div=document.createElement("div");
  div.className=cls;
  chat.appendChild(div);

  let i=0;
  let speed=15;

  function type(){
    div.innerText = text.slice(0,i);
    i++;
    chat.scrollTop=chat.scrollHeight;
    if(i<=text.length) setTimeout(type,speed);
  }
  type();
}

function saveChat(){
  localStorage.setItem("mr7Chat",chat.innerHTML);
}

function loadChat(){
  let saved=localStorage.getItem("mr7Chat");
  if(saved){
    chat.innerHTML=saved;
  }else{
    chat.innerHTML="";
    addMsg("AI: Hello boss üòé I'm MR7 AI. Ask me anything!", "bot");
  }
}
loadChat();

function smartAI(q){
  let text=q.toLowerCase();

  if(text.startsWith("calc")){
    try{
      let exp=text.replace("calc","").trim();
      let result=eval(exp);
      return "üßÆ Result: " + result;
    }catch{
      return "‚ùå Calculator error! Example: calc 50+20";
    }
  }

  if(text.includes("hello")||text.includes("hi")||text.includes("hey"))
    return "Hello boss üòéüî• MR7 AI is ready!";

  if(text.includes("who are you"))
    return "I'm MR7 AI ü§ñüî• I can help with coding, YouTube, games, and ideas.";

  if(text.includes("time"))
    return "‚è∞ Time: " + new Date().toLocaleTimeString();

  if(text.includes("date"))
    return "üìÖ Date: " + new Date().toLocaleDateString();

  if(text.includes("youtube") && (text.includes("grow")||text.includes("viral")))
    return "üî• YouTube growth tip: consistency + good thumbnails + strong title + daily shorts.";

  if(text.includes("thumbnail"))
    return "üé® Thumbnail tip: face zoom + bright colors + max 3 words + outline text.";

  if(text.includes("html") || text.includes("css") || text.includes("javascript"))
    return "üíª Coding tip: build projects daily. Practice HTML structure + CSS design + JS logic.";

  if(text.includes("python"))
    return "üêç Python is great for automation + AI + web dev. Practice loops, functions, lists daily.";

  if(text.includes("football"))
    return "‚öΩ Football tip: do dribbling cone practice + ball control 30 mins daily.";

  if(text.includes("motivation"))
    return "üî• Boss remember: discipline beats talent every time üòé";

  if(text.includes("love"))
    return "‚ù§Ô∏è Love rule: respect + trust + time. Keep it simple üòÑ";

  if(text.includes("game") && text.includes("snake"))
    return "üêç Snake game logic: direction movement + food spawn + collision detect + score system.";

  if(text.includes("how") || text.includes("what") || text.includes("why")){
    return "üòé Boss I got it! Just explain a little more clearly, I'll give full solution.";
  }

  let random=[
    "üòé Boss interesting question! Explain a bit more.",
    "üî• MR7 WORLD never gives up!",
    "ü§ñ I'm ready boss, ask more!",
    "‚ö° Boss you're improving fast üòÑ",
    "üíö I can help you. Ask anything!"
  ];
  return random[Math.floor(Math.random()*random.length)];
}

function askAI(){
  let q=aiInput.value.trim();
  if(!q) return;

  addMsg("You: "+q,"user");
  aiInput.value="";

  setTimeout(()=>{
    let reply=smartAI(q);
    addMsg("AI: "+reply,"bot");
    saveChat();
  },400);
}

aiInput.addEventListener("keypress",(e)=>{
  if(e.key==="Enter") askAI();
});

function clearChat(){
  if(confirm("Clear full chat?")){
    chat.innerHTML="";
    localStorage.removeItem("mr7Chat");
    loadChat();
  }
}

/* =======================
   GAME OPEN FIX
======================= */
function openGame(id){
  document.getElementById("snakeBox").style.display="none";
  document.getElementById("carBox").style.display="none";
  document.getElementById("tttBox").style.display="none";
  document.getElementById(id).style.display="block";
}
function closeGames(){
  document.getElementById("snakeBox").style.display="none";
  document.getElementById("carBox").style.display="none";
  document.getElementById("tttBox").style.display="none";
}

/* =======================
   SCORE SAVE SYSTEM
======================= */
let snakeBest = parseInt(localStorage.getItem("snakeBest") || "0");
let carBest = parseInt(localStorage.getItem("carBest") || "0");

document.getElementById("snakeBest").innerText=snakeBest;
document.getElementById("carBest").innerText=carBest;

/* =======================
   ACHIEVEMENTS SYSTEM
======================= */
function loadAchievements(){
  let text="No achievements yet üòÖ";

  if(snakeBest>=5) text="üéñ Snake Beginner (5+ score)";
  if(snakeBest>=15) text="üèÜ Snake Pro (15+ score)";
  if(carBest>=5) text="üéñ Car Beginner (5+ score)";
  if(carBest>=15) text="üèÜ Car Pro (15+ score)";
  if(snakeBest>=15 && carBest>=15) text="üëë MR7 LEGEND (15+ in both games)";

  document.getElementById("achievementsText").innerText=text;
}

/* =======================
   SNAKE GAME
======================= */
let snakeCanvas=document.getElementById("snakeCanvas");
let sctx=snakeCanvas.getContext("2d");

let snake,food,dir,snakeInterval,snakeScore;

function resetSnake(){
  snake=[{x:160,y:160}];
  food={x:80,y:80};
  dir="RIGHT";
  snakeScore=0;
}

function drawSnake(){
  sctx.clearRect(0,0,320,320);

  sctx.fillStyle="red";
  sctx.fillRect(food.x,food.y,20,20);

  sctx.fillStyle="lime";
  snake.forEach(part=>{
    sctx.fillRect(part.x,part.y,20,20);
  });

  sctx.fillStyle="yellow";
  sctx.font="bold 16px Arial";
  sctx.fillText("Score: "+snakeScore,10,20);
}

function moveSnake(){
  let head={...snake[0]};

  if(dir==="RIGHT") head.x+=20;
  if(dir==="LEFT") head.x-=20;
  if(dir==="UP") head.y-=20;
  if(dir==="DOWN") head.y+=20;

  if(head.x<0||head.y<0||head.x>=320||head.y>=320){
    clearInterval(snakeInterval);
    alert("Game Over! Score: "+snakeScore);
    if(snakeScore>snakeBest){
      snakeBest=snakeScore;
      localStorage.setItem("snakeBest",snakeBest);
      document.getElementById("snakeBest").innerText=snakeBest;
      showPopup("üèÜ New Snake Best Score: "+snakeBest);
      loadAchievements();
    }
    return;
  }

  for(let i=1;i<snake.length;i++){
    if(snake[i].x===head.x && snake[i].y===head.y){
      clearInterval(snakeInterval);
      alert("Game Over! Score: "+snakeScore);
      if(snakeScore>snakeBest){
        snakeBest=snakeScore;
        localStorage.setItem("snakeBest",snakeBest);
        document.getElementById("snakeBest").innerText=snakeBest;
        showPopup("üèÜ New Snake Best Score: "+snakeBest);
        loadAchievements();
      }
      return;
    }
  }

  snake.unshift(head);

  if(head.x===food.x && head.y===food.y){
    snakeScore++;
    food={
      x:Math.floor(Math.random()*16)*20,
      y:Math.floor(Math.random()*16)*20
    };
  }else{
    snake.pop();
  }

  drawSnake();
}

function startSnake(){
  resetSnake();
  drawSnake();
  clearInterval(snakeInterval);
  snakeInterval=setInterval(moveSnake,140);
}

document.addEventListener("keydown",(e)=>{
  if(e.key==="ArrowUp" && dir!=="DOWN") dir="UP";
  if(e.key==="ArrowDown" && dir!=="UP") dir="DOWN";
  if(e.key==="ArrowLeft" && dir!=="RIGHT") dir="LEFT";
  if(e.key==="ArrowRight" && dir!=="LEFT") dir="RIGHT";
});

let startX=0,startY=0;
snakeCanvas.addEventListener("touchstart",(e)=>{
  startX=e.touches[0].clientX;
  startY=e.touches[0].clientY;
});
snakeCanvas.addEventListener("touchend",(e)=>{
  let endX=e.changedTouches[0].clientX;
  let endY=e.changedTouches[0].clientY;
  let dx=endX-startX;
  let dy=endY-startY;

  if(Math.abs(dx)>Math.abs(dy)){
    if(dx>0 && dir!=="LEFT") dir="RIGHT";
    if(dx<0 && dir!=="RIGHT") dir="LEFT";
  }else{
    if(dy>0 && dir!=="UP") dir="DOWN";
    if(dy<0 && dir!=="DOWN") dir="UP";
  }
});

/* =======================
   CAR GAME
======================= */
let carCanvas=document.getElementById("carCanvas");
let cctx=carCanvas.getContext("2d");

let playerCar, enemies, carScore, carInterval;

function resetCar(){
  playerCar={x:140,y:320,w:40,h:70,speed:6};
  enemies=[
    {x:60,y:-120,w:40,h:70,speed:5},
    {x:220,y:-400,w:40,h:70,speed:6}
  ];
  carScore=0;
}

function drawRealCar(x,y,w,h,color){
  cctx.fillStyle=color;
  cctx.fillRect(x,y,w,h);

  cctx.fillStyle="black";
  cctx.fillRect(x+6,y+10,w-12,h/3);

  cctx.fillStyle="#66ccff";
  cctx.fillRect(x+10,y+14,w-20,18);

  cctx.fillStyle="#111";
  cctx.fillRect(x-6,y+10,8,18);
  cctx.fillRect(x+w-2,y+10,8,18);
  cctx.fillRect(x-6,y+h-28,8,18);
  cctx.fillRect(x+w-2,y+h-28,8,18);

  cctx.fillStyle="yellow";
  cctx.fillRect(x+5,y+h-6,8,6);
  cctx.fillRect(x+w-13,y+h-6,8,6);
}

function drawCarGame(){
  cctx.clearRect(0,0,320,420);

  cctx.fillStyle="#2a2a2a";
  cctx.fillRect(0,0,320,420);

  cctx.fillStyle="#111";
  cctx.fillRect(0,0,40,420);
  cctx.fillRect(280,0,40,420);

  cctx.strokeStyle="white";
  cctx.lineWidth=4;
  cctx.setLineDash([20,20]);
  cctx.beginPath();
  cctx.moveTo(160,0);
  cctx.lineTo(160,420);
  cctx.stroke();
  cctx.setLineDash([]);

  cctx.fillStyle="yellow";
  cctx.font="bold 18px Arial";
  cctx.fillText("Score: "+carScore,15,30);

  drawRealCar(playerCar.x,playerCar.y,playerCar.w,playerCar.h,"lime");

  enemies.forEach(e=>{
    drawRealCar(e.x,e.y,e.w,e.h,"red");
  });
}

function updateCarGame(){
  enemies.forEach(e=>{
    e.y += e.speed;

    if(playerCar.x < e.x+e.w &&
       playerCar.x+playerCar.w > e.x &&
       playerCar.y < e.y+e.h &&
       playerCar.y+playerCar.h > e.y){
      clearInterval(carInterval);
      alert("üí• Crash! Game Over! Score: "+carScore);

      if(carScore>carBest){
        carBest=carScore;
        localStorage.setItem("carBest",carBest);
        document.getElementById("carBest").innerText=carBest;
        showPopup("üèÜ New Car Best Score: "+carBest);
        loadAchievements();
      }
    }

    if(e.y>450){
      e.y = -Math.random()*300 - 100;
      e.x = 60 + Math.random()*160;
      carScore++;
    }
  });

  drawCarGame();
}

function startCar(){
  resetCar();
  drawCarGame();
  clearInterval(carInterval);
  carInterval=setInterval(updateCarGame,30);
}

document.addEventListener("keydown",(e)=>{
  if(!playerCar) return;

  if(e.key==="ArrowLeft") playerCar.x -= playerCar.speed*3;
  if(e.key==="ArrowRight") playerCar.x += playerCar.speed*3;

  if(playerCar.x<45) playerCar.x=45;
  if(playerCar.x>235) playerCar.x=235;
});

carCanvas.addEventListener("touchstart",(e)=>{
  startX=e.touches[0].clientX;
});
carCanvas.addEventListener("touchmove",(e)=>{
  if(!playerCar) return;

  let x=e.touches[0].clientX;
  let diff=x-startX;

  playerCar.x += diff*0.2;
  startX=x;

  if(playerCar.x<45) playerCar.x=45;
  if(player.playerCar>235) playerCar.x=235;
});

/* =======================
   TIC TAC TOE
======================= */
let tttBoard=document.getElementById("tttBoard");
let tttStatus=document.getElementById("tttStatus");
let tttCells=[],currentPlayer="X";

function createTTT(){
  tttBoard.innerHTML="";
  tttCells=new Array(9).fill("");
  currentPlayer="X";
  tttStatus.innerText="Player X turn";

  for(let i=0;i<9;i++){
    let btn=document.createElement("button");
    btn.style.height="80px";
    btn.style.fontSize="30px";
    btn.style.borderRadius="15px";
    btn.style.border="2px solid lime";
    btn.style.cursor="pointer";
    btn.style.background="#111";
    btn.style.color="lime";
    btn.innerText="";

    btn.onclick=()=>playTTT(i,btn);
    tttBoard.appendChild(btn);
  }
}
createTTT();

function playTTT(i,btn){
  if(tttCells[i]!=="" ) return;

  tttCells[i]=currentPlayer;
  btn.innerText=currentPlayer;

  if(checkWin()){
    tttStatus.innerText="üèÜ Player "+currentPlayer+" Wins!";
    return;
  }

  if(tttCells.every(c=>c!=="")){
    tttStatus.innerText="üòê Draw!";
    return;
  }

  currentPlayer = currentPlayer==="X" ? "O" : "X";
  tttStatus.innerText="Player "+currentPlayer+" turn";
}

function checkWin(){
  let w=[
    [0,1,2],[3,4,5],[6,7,8],
    [0,3,6],[1,4,7],[2,5,8],
    [0,4,8],[2,4,6]
  ];
  return w.some(p=>{
    return tttCells[p[0]] && tttCells[p[0]]===tttCells[p[1]] && tttCells[p[1]]===tttCells[p[2]];
  });
}

function resetTTT(){
  createTTT();
}
</script>

</body>
</html>
