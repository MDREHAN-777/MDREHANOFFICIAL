<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title> -MR7 WORLD- </title>

<style>
  :root{
    --bg:#050505;
    --card:#0b0b0b;
    --green:#00ff44;
    --green2:#00cc33;
    --text:#eaffea;
    --muted:#a6f8b2;
    --border:rgba(0,255,68,.35);
    --shadow:0 0 25px rgba(0,255,68,.35);
  }

  *{margin:0;padding:0;box-sizing:border-box;font-family:Segoe UI,Arial;}
  body{
    background:var(--bg);
    color:var(--text);
    overflow-x:hidden;
    min-height:100vh;
  }

  /* Smooth page transition */
  .page{
    display:none;
    opacity:0;
    transform:translateY(20px) scale(.98);
    transition:.35s ease;
    padding:18px;
  }
  .page.active{
    display:block;
    opacity:1;
    transform:translateY(0) scale(1);
  }

  /* Top Bar */
  .topbar{
    position:fixed;
    top:0;left:0;right:0;
    height:65px;
    background:rgba(0,0,0,.85);
    backdrop-filter: blur(8px);
    border-bottom:1px solid var(--border);
    display:flex;
    align-items:center;
    justify-content:space-between;
    padding:0 15px;
    z-index:999;
  }

  .brand{
    display:flex;
    align-items:center;
    gap:10px;
  }
  .logo{
    width:45px;height:45px;
    border-radius:50%;
    border:2px solid var(--green);
    display:flex;
    align-items:center;
    justify-content:center;
    font-weight:bold;
    color:var(--green);
    box-shadow:var(--shadow);
  }
  .brand h2{
    font-size:18px;
    color:var(--green);
  }
  .brand span{
    font-size:13px;
    color:#b6ffbf;
  }

  .status{
    display:flex;
    align-items:center;
    gap:8px;
    font-size:14px;
    color:#b6ffbf;
  }
  .dot{
    width:10px;height:10px;
    border-radius:50%;
    background:lime;
    box-shadow:0 0 10px lime;
  }

  .menuBtn{
    font-size:26px;
    cursor:pointer;
    color:var(--green);
    user-select:none;
  }

  /* Dropdown menu */
  .menu{
    position:fixed;
    top:70px;
    right:15px;
    width:240px;
    background:rgba(0,0,0,.92);
    border:1px solid var(--border);
    border-radius:14px;
    padding:12px;
    box-shadow:var(--shadow);
    display:none;
    z-index:1000;
  }
  .menu.show{display:block;}

  .menu input{
    width:100%;
    padding:10px;
    border-radius:10px;
    border:1px solid var(--border);
    outline:none;
    background:#0b0b0b;
    color:var(--text);
    margin-bottom:10px;
  }

  .menu button{
    width:100%;
    padding:10px;
    border-radius:12px;
    border:none;
    margin:5px 0;
    background:rgba(0,255,68,.15);
    color:var(--green);
    font-weight:bold;
    cursor:pointer;
    transition:.2s;
  }
  .menu button:hover{
    background:rgba(0,255,68,.25);
    transform:scale(1.02);
  }

  /* Background particles canvas */
  canvas#particles{
    position:fixed;
    top:0;left:0;
    width:100%;
    height:100%;
    z-index:-1;
    opacity:.8;
  }

  /* Main container spacing */
  .container{
    padding-top:80px;
    max-width:1100px;
    margin:auto;
  }

  .card{
    background:rgba(0,0,0,.7);
    border:1px solid var(--border);
    border-radius:18px;
    padding:18px;
    box-shadow:var(--shadow);
    margin:15px 0;
  }

  .title{
    text-align:center;
    font-size:26px;
    color:var(--green);
    margin-bottom:6px;
    text-shadow:0 0 15px rgba(0,255,68,.6);
  }
  .subtitle{
    text-align:center;
    color:#c7ffd0;
    font-size:14px;
    margin-bottom:14px;
    opacity:.9;
  }

  /* Profile Card */
  .profileCard{
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap:15px;
    flex-wrap:wrap;
  }
  .profileLeft{
    display:flex;
    align-items:center;
    gap:12px;
  }
  .avatar{
    width:55px;height:55px;
    border-radius:50%;
    border:2px solid var(--green);
    display:flex;
    align-items:center;
    justify-content:center;
    font-weight:bold;
    color:var(--green);
    box-shadow:var(--shadow);
    background:rgba(0,255,68,.05);
  }
  .profileName{
    font-size:16px;
    color:var(--text);
    font-weight:bold;
  }
  .verified{
    color:var(--green);
    font-weight:bold;
    margin-left:6px;
    text-shadow:0 0 10px rgba(0,255,68,.7);
  }

  .socialBtns{
    display:flex;
    gap:10px;
    flex-wrap:wrap;
  }
  .socialBtns a{
    text-decoration:none;
    padding:10px 14px;
    border-radius:12px;
    border:1px solid var(--border);
    color:var(--green);
    font-weight:bold;
    background:rgba(0,255,68,.08);
    transition:.2s;
  }
  .socialBtns a:hover{
    background:rgba(0,255,68,.2);
    transform:scale(1.05);
  }

  /* Buttons */
  .btnRow{
    display:flex;
    justify-content:center;
    gap:12px;
    flex-wrap:wrap;
    margin-top:12px;
  }
  .btn{
    padding:12px 18px;
    border-radius:14px;
    border:none;
    cursor:pointer;
    background:var(--green);
    color:#000;
    font-weight:bold;
    transition:.2s;
    box-shadow:0 0 18px rgba(0,255,68,.5);
  }
  .btn:hover{transform:scale(1.05);}

  .btnOutline{
    background:transparent;
    border:1px solid var(--border);
    color:var(--green);
  }

  /* AI Chat */
  .chatBox{
    height:280px;
    overflow-y:auto;
    padding:12px;
    border-radius:14px;
    border:1px solid var(--border);
    background:rgba(0,0,0,.7);
  }
  .msg{
    margin:8px 0;
    line-height:1.4;
  }
  .ai{color:var(--green);}
  .you{color:#6fdcff;}

  .chatInput{
    width:100%;
    padding:12px;
    border-radius:14px;
    border:1px solid var(--border);
    outline:none;
    background:#0b0b0b;
    color:var(--text);
    margin-top:12px;
  }

  /* Games canvas */
  .gameWrap{
    display:flex;
    flex-direction:column;
    align-items:center;
    gap:12px;
  }
  canvas.game{
    background:#070707;
    border:2px solid rgba(0,255,68,.5);
    border-radius:16px;
    box-shadow:0 0 30px rgba(0,255,68,.25);
  }

  .hud{
    display:flex;
    gap:14px;
    flex-wrap:wrap;
    justify-content:center;
    color:#c7ffd0;
    font-weight:bold;
  }

  /* Fullscreen */
  .fullscreenBtn{
    position:fixed;
    bottom:18px;
    right:18px;
    padding:12px 16px;
    border-radius:14px;
    background:rgba(0,255,68,.2);
    border:1px solid var(--border);
    color:var(--green);
    font-weight:bold;
    cursor:pointer;
    box-shadow:var(--shadow);
    z-index:999;
  }

  /* Notification popup */
  .popup{
    position:fixed;
    top:80px;
    left:50%;
    transform:translateX(-50%);
    background:rgba(0,0,0,.92);
    border:1px solid var(--border);
    padding:12px 18px;
    border-radius:14px;
    box-shadow:var(--shadow);
    color:var(--green);
    font-weight:bold;
    display:none;
    z-index:2000;
    animation:pop .35s ease;
  }
  @keyframes pop{
    from{opacity:0;transform:translateX(-50%) translateY(-20px) scale(.9);}
    to{opacity:1;transform:translateX(-50%) translateY(0) scale(1);}
  }

  /* Settings */
  .toggle{
    display:flex;
    align-items:center;
    justify-content:space-between;
    padding:12px;
    border-radius:14px;
    border:1px solid var(--border);
    margin:10px 0;
    background:rgba(0,255,68,.06);
  }
  .toggle input{
    transform:scale(1.4);
    accent-color:var(--green);
  }

  /* Custom Cursor */
  @media (pointer:fine){
    body{
      cursor: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40"><circle cx="10" cy="10" r="6" fill="lime" stroke="black" stroke-width="2"/></svg>') 10 10, auto;
    }
    button,a,input{
      cursor: pointer;
    }
  }
</style>
</head>

<body>

<canvas id="particles"></canvas>

<div class="popup" id="popup">Welcome to MR7 WORLD - Gaming + AI + Cool Features üòé</div>

<div class="topbar">
  <div class="brand">
    <div class="logo">MR7</div>
    <div>
      <h2>MR7 WORLD <span class="verified">‚úî Verified</span></h2>
      <span id="ownerText">Owner: MR7</span>
    </div>
  </div>

  <div class="status">
    <div class="dot" id="netDot"></div>
    <div id="netText">Online</div>
  </div>

  <div class="menuBtn" onclick="toggleMenu()">‚ãÆ</div>
</div>

<div class="menu" id="menu">
  <input type="text" id="menuSearch" placeholder="Search page (home, ai, car, snake, space)..." oninput="searchMenu()">
  <button onclick="openPage('home')">üè† Home</button>
  <button onclick="openPage('ai')">ü§ñ MR7 AI Chat</button>
  <button onclick="openPage('car')">üöó Car Racing</button>
  <button onclick="openPage('snake')">üêç Snake Game</button>
  <button onclick="openPage('space')">üöÄ Space War</button>
  <button onclick="openPage('settings')">‚öô Settings</button>
</div>

<div class="container">

  <!-- HOME PAGE -->
  <div class="page active" id="home">
    <div class="card">
      <div class="title">MR7 WORLD</div>
      <div class="subtitle">Gaming + AI + Premium Neon Experience</div>

      <div class="profileCard">
        <div class="profileLeft">
          <div class="avatar">MR7</div>
          <div>
            <div class="profileName">MR7 WORLD <span class="verified">‚úî</span></div>
            <div style="color:#b6ffbf;font-size:13px;">Official Website</div>
          </div>
        </div>

        <div class="socialBtns">
          <a href="https://youtube.com" target="_blank">YouTube</a>
          <a href="https://instagram.com" target="_blank">Instagram</a>
          <a href="https://wa.me/919999999999" target="_blank">WhatsApp</a>
        </div>
      </div>

      <div class="btnRow">
        <button class="btn" onclick="openPage('ai')">Open MR7 AI</button>
        <button class="btn" onclick="openPage('car')">Play Car Game</button>
        <button class="btn" onclick="openPage('snake')">Play Snake</button>
        <button class="btn btnOutline" onclick="openPage('space')">Space War</button>
      </div>
    </div>

    <div class="card">
      <div class="title" style="font-size:20px;">üî• Achievements</div>
      <div class="subtitle" id="achievementsText">No achievements unlocked yet.</div>
    </div>

    <div class="card">
      <div class="title" style="font-size:20px;">üèÜ Leaderboard</div>
      <div class="subtitle" id="leaderboardText">Loading...</div>
    </div>

  </div>

  <!-- AI PAGE -->
  <div class="page" id="ai">
    <div class="card">
      <div class="title">MR7 AI Chat</div>
      <div class="subtitle">Smart AI (Offline + API Support)</div>

      <input class="chatInput" id="apiKey" placeholder="Paste OpenAI API Key (optional)">

      <div class="chatBox" id="chatBox"></div>

      <input class="chatInput" id="chatInput" placeholder="Type your message... (Enter = Send)">
      
      <div class="btnRow">
        <button class="btn" onclick="sendMsg()">Send</button>
        <button class="btn btnOutline" onclick="clearChat()">Clear</button>
        <button class="btn btnOutline" onclick="openPage('home')">Back</button>
      </div>
    </div>
  </div>

  <!-- CAR GAME -->
  <div class="page" id="car">
    <div class="card">
      <div class="title">MR7 Car Racing</div>
      <div class="subtitle">Steering + Nitro Boost + HighScore</div>

      <div class="hud" id="carHud">Score: 0 | HighScore: 0 | Speed: 0</div>

      <div class="gameWrap">
        <button class="btn" onclick="startCarGame()">Start Game</button>
        <canvas class="game" id="carCanvas" width="360" height="520"></canvas>
        <button class="btn btnOutline" onclick="openPage('home')">Back</button>
      </div>
    </div>
  </div>

  <!-- SNAKE GAME -->
  <div class="page" id="snake">
    <div class="card">
      <div class="title">MR7 Snake Game</div>
      <div class="subtitle">Smooth Snake + Neon Food + HighScore</div>

      <div class="hud" id="snakeHud">Score: 0 | HighScore: 0</div>

      <div class="gameWrap">
        <button class="btn" onclick="startSnakeGame()">Start Game</button>
        <canvas class="game" id="snakeCanvas" width="360" height="360"></canvas>
        <button class="btn btnOutline" onclick="openPage('home')">Back</button>
      </div>
    </div>
  </div>

  <!-- SPACE WAR -->
  <div class="page" id="space">
    <div class="card">
      <div class="title">MR7 Space War</div>
      <div class="subtitle">Shoot Enemies + Survive</div>

      <div class="hud" id="spaceHud">Score: 0 | HighScore: 0</div>

      <div class="gameWrap">
        <button class="btn" onclick="startSpaceGame()">Start Game</button>
        <canvas class="game" id="spaceCanvas" width="360" height="520"></canvas>
        <button class="btn btnOutline" onclick="openPage('home')">Back</button>
      </div>
    </div>
  </div>

  <!-- SETTINGS -->
  <div class="page" id="settings">
    <div class="card">
      <div class="title">Settings</div>
      <div class="subtitle">Customize MR7 WORLD</div>

      <div class="toggle">
        <div>Dark Mode</div>
        <input type="checkbox" id="darkToggle" checked onchange="toggleDarkMode()">
      </div>

      <div class="toggle">
        <div>Vibration (Mobile)</div>
        <input type="checkbox" id="vibrateToggle" checked onchange="saveSettings()">
      </div>

      <div class="toggle">
        <div>Sound Effects</div>
        <input type="checkbox" id="soundToggle" onchange="saveSettings()">
      </div>

      <div class="toggle">
        <div>Daily Reward Coins</div>
        <div id="coinsText">0 Coins</div>
      </div>

      <div class="btnRow">
        <button class="btn" onclick="claimDailyReward()">Claim Reward</button>
        <button class="btn btnOutline" onclick="openPage('home')">Back</button>
      </div>
    </div>
  </div>

</div>

<button class="fullscreenBtn" onclick="toggleFullscreen()">‚õ∂ Fullscreen</button>

<script>
/* ------------------ MENU ------------------ */
function toggleMenu(){
  document.getElementById("menu").classList.toggle("show");
}
window.addEventListener("click", (e)=>{
  if(!e.target.closest(".menu") && !e.target.closest(".menuBtn")){
    document.getElementById("menu").classList.remove("show");
  }
});

function searchMenu(){
  let q = document.getElementById("menuSearch").value.toLowerCase();
  if(q.includes("home")) openPage("home");
  if(q.includes("ai")) openPage("ai");
  if(q.includes("car")) openPage("car");
  if(q.includes("snake")) openPage("snake");
  if(q.includes("space")) openPage("space");
  if(q.includes("setting")) openPage("settings");
}

/* ------------------ PAGE SWITCH ------------------ */
function openPage(id){
  document.querySelectorAll(".page").forEach(p=>p.classList.remove("active"));
  document.getElementById(id).classList.add("active");
  document.getElementById("menu").classList.remove("show");
}

/* ------------------ POPUP ------------------ */
function showPopup(){
  let pop = document.getElementById("popup");
  pop.style.display="block";
  setTimeout(()=>pop.style.display="none", 3500);
}
setTimeout(showPopup, 600);

/* ------------------ ONLINE OFFLINE ------------------ */
function updateNet(){
  let dot=document.getElementById("netDot");
  let txt=document.getElementById("netText");
  if(navigator.onLine){
    dot.style.background="lime";
    dot.style.boxShadow="0 0 10px lime";
    txt.innerText="Online";
  }else{
    dot.style.background="red";
    dot.style.boxShadow="0 0 10px red";
    txt.innerText="Offline";
  }
}
window.addEventListener("online",updateNet);
window.addEventListener("offline",updateNet);
updateNet();

/* ------------------ PARTICLES ------------------ */
const pCanvas=document.getElementById("particles");
const pCtx=pCanvas.getContext("2d");
let W,H;
function resizeParticles(){
  W=pCanvas.width=window.innerWidth;
  H=pCanvas.height=window.innerHeight;
}
window.addEventListener("resize",resizeParticles);
resizeParticles();

let particles=[];
for(let i=0;i<80;i++){
  particles.push({
    x:Math.random()*W,
    y:Math.random()*H,
    r:Math.random()*2+1,
    dx:(Math.random()-.5)*1.2,
    dy:(Math.random()-.5)*1.2
  });
}
function drawParticles(){
  pCtx.clearRect(0,0,W,H);
  particles.forEach(p=>{
    p.x+=p.dx; p.y+=p.dy;
    if(p.x<0||p.x>W) p.dx*=-1;
    if(p.y<0||p.y>H) p.dy*=-1;

    pCtx.beginPath();
    pCtx.arc(p.x,p.y,p.r,0,Math.PI*2);
    pCtx.fillStyle="rgba(0,255,68,0.7)";
    pCtx.fill();
  });
  requestAnimationFrame(drawParticles);
}
drawParticles();

/* ------------------ SETTINGS + COINS ------------------ */
let coins = parseInt(localStorage.getItem("mr7_coins") || "0");
document.getElementById("coinsText").innerText = coins + " Coins";

function claimDailyReward(){
  let last = localStorage.getItem("mr7_lastReward");
  let now = new Date().toDateString();
  if(last === now){
    alert("Boss, reward already claimed today üòé");
    return;
  }
  coins += 50;
  localStorage.setItem("mr7_coins", coins);
  localStorage.setItem("mr7_lastReward", now);
  document.getElementById("coinsText").innerText = coins + " Coins";
  alert("üî• Daily Reward Claimed: +50 Coins!");
}

function saveSettings(){
  localStorage.setItem("mr7_sound", document.getElementById("soundToggle").checked ? "1":"0");
  localStorage.setItem("mr7_vibrate", document.getElementById("vibrateToggle").checked ? "1":"0");
}

function toggleDarkMode(){
  // already dark by default
  saveSettings();
}

document.getElementById("soundToggle").checked = localStorage.getItem("mr7_sound")==="1";
document.getElementById("vibrateToggle").checked = localStorage.getItem("mr7_vibrate")!=="0";

/* ------------------ FULLSCREEN ------------------ */
function toggleFullscreen(){
  if(!document.fullscreenElement){
    document.documentElement.requestFullscreen();
  }else{
    document.exitFullscreen();
  }
}

/* ------------------ ACHIEVEMENTS + LEADERBOARD ------------------ */
function updateAchievements(){
  let snakeHS=parseInt(localStorage.getItem("snake_high")||"0");
  let carHS=parseInt(localStorage.getItem("car_high")||"0");
  let spaceHS=parseInt(localStorage.getItem("space_high")||"0");

  let list=[];
  if(snakeHS>=10) list.push("üêç Snake Beginner (10+)");
  if(snakeHS>=30) list.push("üêç Snake Pro (30+)");
  if(carHS>=10) list.push("üöó Car Racer (10+)");
  if(spaceHS>=15) list.push("üöÄ Space Fighter (15+)");
  if(list.length===0) list.push("No achievements unlocked yet.");

  document.getElementById("achievementsText").innerText=list.join(" | ");
}

function updateLeaderboard(){
  let snakeHS=parseInt(localStorage.getItem("snake_high")||"0");
  let carHS=parseInt(localStorage.getItem("car_high")||"0");
  let spaceHS=parseInt(localStorage.getItem("space_high")||"0");

  document.getElementById("leaderboardText").innerText=
    "Car HighScore: "+carHS+" | Snake HighScore: "+snakeHS+" | Space HighScore: "+spaceHS;
}
updateAchievements();
updateLeaderboard();

/* ------------------ MR7 AI SMART ------------------ */
const chatBox=document.getElementById("chatBox");
let memory = JSON.parse(localStorage.getItem("mr7_ai_memory") || "[]");

function renderMemory(){
  chatBox.innerHTML="";
  memory.forEach(m=>{
    let div=document.createElement("div");
    div.className="msg";
    div.innerHTML = `<span class="${m.role}">${m.role.toUpperCase()}:</span> ${m.text}`;
    chatBox.appendChild(div);
  });
  chatBox.scrollTop=chatBox.scrollHeight;
}
renderMemory();

function addMsg(role,text){
  memory.push({role,text});
  if(memory.length>50) memory.shift();
  localStorage.setItem("mr7_ai_memory", JSON.stringify(memory));
  renderMemory();
}

function clearChat(){
  memory=[];
  localStorage.setItem("mr7_ai_memory","[]");
  renderMemory();
}

function offlineSmartAnswer(q){
  q=q.toLowerCase();

  if(q.includes("time")) return "Boss current time aapke system ke hisaab se hota hai üòé";
  if(q.includes("weather")) return "Boss weather ke liye API chahiye, but aap Google weather ya OpenWeather API connect kar sakte ho.";
  if(q.includes("python")) return "Boss Python ek programming language hai, simple aur powerful. Aap chaho to mai roadmap bhi de dunga.";
  if(q.includes("html")) return "Boss HTML website ka skeleton hota hai. CSS design deta hai, JS magic karta hai üòé";
  if(q.includes("css")) return "CSS se website ka design, color, animation sab hota hai.";
  if(q.includes("javascript")) return "JavaScript website ko interactive banata hai jaise games, AI chat, buttons etc.";
  if(q.includes("who are you") || q.includes("tum kaun")) return "Boss mai MR7 AI hu üòé aapka personal assistant!";
  if(q.includes("help")) return "Boss aap kuch bhi puch sakte ho: coding, games, tech, ideas, motivation.";

  return "Boss ye question interesting hai üòé Agar aap real world answer chahte ho to OpenAI API key paste kar do, tab mai full powerful ChatGPT ban jaunga!";
}

async function sendMsg(){
  let input=document.getElementById("chatInput");
  let text=input.value.trim();
  if(!text) return;

  addMsg("you", text);
  input.value="";

  let key=document.getElementById("apiKey").value.trim();

  // If no API key -> offline smart mode
  if(!key){
    let ans=offlineSmartAnswer(text);
    setTimeout(()=>addMsg("ai", ans), 400);
    return;
  }

  // Real ChatGPT API (requires backend normally, but direct call works in some cases)
  try{
    addMsg("ai", "Boss thinking... üòé");

    let res = await fetch("https://api.openai.com/v1/chat/completions",{
      method:"POST",
      headers:{
        "Content-Type":"application/json",
        "Authorization":"Bearer "+key
      },
      body:JSON.stringify({
        model:"gpt-4o-mini",
        messages:[
          {role:"system",content:"You are MR7 AI. Reply only in Hinglish. Be fast, smart, and friendly."},
          {role:"user",content:text}
        ],
        temperature:0.7
      })
    });

    let data = await res.json();

    // remove "thinking"
    memory.pop();

    if(data.error){
      addMsg("ai","Boss API error: "+data.error.message);
      return;
    }

    let reply = data.choices[0].message.content;
    addMsg("ai", reply);

  }catch(e){
    memory.pop();
    addMsg("ai","Boss API not working üò≠ GitHub Pages me direct API sometimes block hota hai. Best is backend server.");
  }
}

/* Enter key = Send fix */
document.getElementById("chatInput").addEventListener("keydown",(e)=>{
  if(e.key==="Enter"){
    e.preventDefault();
    sendMsg();
  }
});

/* ------------------ SNAKE GAME ------------------ */
let snakeRunning=false;
let snakeInterval;
let snakeScore=0;
let snakeHigh=parseInt(localStorage.getItem("snake_high")||"0");
let snakeCanvas=document.getElementById("snakeCanvas");
let sctx=snakeCanvas.getContext("2d");

let snake=[];
let food={x:5,y:5};
let dir={x:1,y:0};

function startSnakeGame(){
  clearInterval(snakeInterval);
  snakeRunning=true;
  snakeScore=0;
  snake=[{x:8,y:8},{x:7,y:8},{x:6,y:8}];
  dir={x:1,y:0};
  food=randomFood();
  snakeInterval=setInterval(updateSnake,110);
}

function randomFood(){
  return {x:Math.floor(Math.random()*18), y:Math.floor(Math.random()*18)};
}

function updateSnake(){
  if(!snakeRunning) return;

  let head={x:snake[0].x+dir.x, y:snake[0].y+dir.y};

  if(head.x<0||head.y<0||head.x>=18||head.y>=18){
    return endSnake();
  }

  for(let p of snake){
    if(p.x===head.x && p.y===head.y){
      return endSnake();
    }
  }

  snake.unshift(head);

  if(head.x===food.x && head.y===food.y){
    snakeScore++;
    food=randomFood();
  }else{
    snake.pop();
  }

  drawSnake();
  document.getElementById("snakeHud").innerText=`Score: ${snakeScore} | HighScore: ${snakeHigh}`;
}

function endSnake(){
  snakeRunning=false;
  clearInterval(snakeInterval);

  if(snakeScore>snakeHigh){
    snakeHigh=snakeScore;
    localStorage.setItem("snake_high",snakeHigh);
  }

  updateAchievements();
  updateLeaderboard();

  alert("Game Over üò≠ Snake Score: "+snakeScore);
}

function drawSnake(){
  sctx.clearRect(0,0,360,360);

  // grid glow
  for(let i=0;i<18;i++){
    for(let j=0;j<18;j++){
      sctx.strokeStyle="rgba(0,255,68,0.08)";
      sctx.strokeRect(i*20,j*20,20,20);
    }
  }

  // food
  sctx.fillStyle="red";
  sctx.shadowBlur=15;
  sctx.shadowColor="red";
  sctx.fillRect(food.x*20, food.y*20, 20, 20);

  // snake
  snake.forEach((p,idx)=>{
    sctx.fillStyle = idx===0 ? "#00ff44" : "#00cc33";
    sctx.shadowBlur=15;
    sctx.shadowColor="#00ff44";
    sctx.fillRect(p.x*20, p.y*20, 20, 20);
  });

  sctx.shadowBlur=0;
}

window.addEventListener("keydown",(e)=>{
  if(!document.getElementById("snake").classList.contains("active")) return;

  if(e.key==="ArrowUp" && dir.y!==1){dir={x:0,y:-1}}
  if(e.key==="ArrowDown" && dir.y!==-1){dir={x:0,y:1}}
  if(e.key==="ArrowLeft" && dir.x!==1){dir={x:-1,y:0}}
  if(e.key==="ArrowRight" && dir.x!==-1){dir={x:1,y:0}}
});

/* ------------------ CAR GAME ------------------ */
let carCanvas=document.getElementById("carCanvas");
let cctx=carCanvas.getContext("2d");

let carRunning=false;
let carScore=0;
let carHigh=parseInt(localStorage.getItem("car_high")||"0");
let carSpeed=5;
let nitro=false;

let car={x:160,y:420,w:40,h:70};
let obstacles=[];

function startCarGame(){
  carRunning=true;
  carScore=0;
  carSpeed=5;
  obstacles=[];
  car.x=160;
  spawnObstacle();
  requestAnimationFrame(updateCar);
}

function spawnObstacle(){
  obstacles.push({
    x:Math.random()*300+20,
    y:-80,
    w:40,
    h:70
  });
}

function updateCar(){
  if(!carRunning) return;

  cctx.clearRect(0,0,360,520);

  // road
  cctx.fillStyle="#111";
  cctx.fillRect(0,0,360,520);

  // road lines
  for(let i=0;i<12;i++){
    cctx.fillStyle="rgba(255,255,255,0.12)";
    cctx.fillRect(175, i*50 + (carScore%50), 10, 30);
  }

  // draw player car
  cctx.fillStyle="#00ff44";
  cctx.shadowBlur=20;
  cctx.shadowColor="#00ff44";
  cctx.fillRect(car.x,car.y,car.w,car.h);

  // obstacles
  let speedNow = nitro ? carSpeed+4 : carSpeed;

  obstacles.forEach(o=>{
    o.y += speedNow;
    cctx.fillStyle="red";
    cctx.shadowBlur=20;
    cctx.shadowColor="red";
    cctx.fillRect(o.x,o.y,o.w,o.h);

    // collision
    if(car.x < o.x+o.w && car.x+car.w > o.x && car.y < o.y+o.h && car.y+car.h > o.y){
      return endCarGame();
    }
  });

  obstacles = obstacles.filter(o=>o.y<600);

  if(Math.random()<0.03){
    spawnObstacle();
  }

  carScore++;
  if(carScore%200===0) carSpeed++;

  document.getElementById("carHud").innerText=`Score: ${carScore} | HighScore: ${carHigh} | Speed: ${speedNow}`;

  requestAnimationFrame(updateCar);
}

function endCarGame(){
  carRunning=false;
  cctx.shadowBlur=0;

  if(carScore>carHigh){
    carHigh=carScore;
    localStorage.setItem("car_high",carHigh);
  }

  updateAchievements();
  updateLeaderboard();

  alert("Game Over üò≠ Car Score: "+carScore);
}

window.addEventListener("keydown",(e)=>{
  if(!document.getElementById("car").classList.contains("active")) return;

  if(e.key==="ArrowLeft") car.x -= 18;
  if(e.key==="ArrowRight") car.x += 18;

  if(e.key==="Shift") nitro=true;

  if(car.x<0) car.x=0;
  if(car.x>320) car.x=320;
});
window.addEventListener("keyup",(e)=>{
  if(e.key==="Shift") nitro=false;
});

/* ------------------ SPACE WAR GAME ------------------ */
let spaceCanvas=document.getElementById("spaceCanvas");
let spctx=spaceCanvas.getContext("2d");

let spaceRunning=false;
let spaceScore=0;
let spaceHigh=parseInt(localStorage.getItem("space_high")||"0");

let ship={x:170,y:450,w:30,h:40};
let bullets=[];
let enemies=[];

function startSpaceGame(){
  spaceRunning=true;
  spaceScore=0;
  bullets=[];
  enemies=[];
  ship.x=170;
  spawnEnemy();
  requestAnimationFrame(updateSpace);
}

function spawnEnemy(){
  enemies.push({x:Math.random()*320,y:-40,w:30,h:30});
}

function updateSpace(){
  if(!spaceRunning) return;

  spctx.clearRect(0,0,360,520);

  spctx.fillStyle="#050505";
  spctx.fillRect(0,0,360,520);

  // ship
  spctx.fillStyle="#00ff44";
  spctx.shadowBlur=20;
  spctx.shadowColor="#00ff44";
  spctx.fillRect(ship.x,ship.y,ship.w,ship.h);

  // bullets
  bullets.forEach(b=>{
    b.y-=10;
    spctx.fillStyle="#6fdcff";
    spctx.shadowBlur=10;
    spctx.shadowColor="#6fdcff";
    spctx.fillRect(b.x,b.y,5,12);
  });
  bullets=bullets.filter(b=>b.y>-20);

  // enemies
  enemies.forEach(en=>{
    en.y+=4;
    spctx.fillStyle="red";
    spctx.shadowBlur=15;
    spctx.shadowColor="red";
    spctx.fillRect(en.x,en.y,en.w,en.h);

    // collision with ship
    if(ship.x < en.x+en.w && ship.x+ship.w > en.x && ship.y < en.y+en.h && ship.y+ship.h > en.y){
      return endSpaceGame();
    }
  });

  // bullet hit
  enemies.forEach((en,ei)=>{
    bullets.forEach((b,bi)=>{
      if(b.x < en.x+en.w && b.x+5 > en.x && b.y < en.y+en.h && b.y+12 > en.y){
        enemies.splice(ei,1);
        bullets.splice(bi,1);
        spaceScore+=10;
      }
    });
  });

  if(Math.random()<0.03) spawnEnemy();
  enemies=enemies.filter(e=>e.y<600);

  document.getElementById("spaceHud").innerText=`Score: ${spaceScore} | HighScore: ${spaceHigh}`;

  requestAnimationFrame(updateSpace);
}

function endSpaceGame(){
  spaceRunning=false;
  if(spaceScore>spaceHigh){
    spaceHigh=spaceScore;
    localStorage.setItem("space_high",spaceHigh);
  }

  updateAchievements();
  updateLeaderboard();

  alert("Game Over üò≠ Space Score: "+spaceScore);
}

window.addEventListener("keydown",(e)=>{
  if(!document.getElementById("space").classList.contains("active")) return;

  if(e.key==="ArrowLeft") ship.x-=15;
  if(e.key==="ArrowRight") ship.x+=15;

  if(e.key===" "){
    bullets.push({x:ship.x+12,y:ship.y});
  }

  if(ship.x<0) ship.x=0;
  if(ship.x>330) ship.x=330;
});
</script>

</body>
</html>
