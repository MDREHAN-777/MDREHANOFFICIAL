<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MR7 WORLD - OFFICIAL</title>

<style>
*{margin:0;padding:0;box-sizing:border-box;}
body{
  font-family:Segoe UI, sans-serif;
  background:#111;
  color:white;
  text-align:center;
  transition:0.4s;
  overflow-x:hidden;
  padding:15px;
}

/* BACKGROUND ANIMATION */
body::before{
  content:"";
  position:fixed;
  top:0;left:0;
  width:100%;height:100%;
  z-index:-1;
  background:linear-gradient(120deg,#0f0f0f,#003300,#000,#001a00);
  background-size:400% 400%;
  animation:bgMove 10s infinite alternate;
  opacity:.25;
}
@keyframes bgMove{
  0%{background-position:0% 50%}
  50%{background-position:100% 50%}
  100%{background-position:0% 50%}
}

body.light{
  background:#fff;
  color:#111;
}

/* MENU */
.menu{
  position:fixed;
  top:15px;
  left:15px;
  font-size:32px;
  cursor:pointer;
  z-index:999;
}
.menu-box{
  position:fixed;
  top:60px;
  left:15px;
  background:#111;
  border:1px solid lime;
  border-radius:15px;
  padding:10px;
  display:none;
  z-index:999;
  width:190px;
  box-shadow:0 0 25px rgba(0,255,0,.5);
}
.menu-box button{
  width:100%;
  padding:10px;
  margin:5px 0;
  border:none;
  border-radius:10px;
  cursor:pointer;
  background:#222;
  color:white;
  transition:0.3s;
  font-weight:bold;
}
.menu-box button:hover{
  background:lime;
  color:black;
  transform:scale(1.05);
}

/* DARK TOGGLE */
.dark-toggle{
  position:fixed;
  top:15px;
  right:15px;
  padding:10px 20px;
  border:none;
  border-radius:30px;
  background:lime;
  color:black;
  font-weight:bold;
  cursor:pointer;
  z-index:999;
}

/* SECTIONS */
.section{
  display:none;
  animation:fadeIn .5s ease;
}
.section.active{
  display:block;
}
@keyframes fadeIn{
  from{opacity:0;transform:translateY(20px)}
  to{opacity:1;transform:translateY(0)}
}

/* TITLE */
#typingTitle{
  font-size:34px;
  font-weight:bold;
  color:lime;
  margin-top:30px;
  text-shadow:0 0 15px lime;
}

/* PROFILE PIC */
.profile-pic{
  width:200px;
  height:200px;
  border-radius:50%;
  border:5px solid lime;
  box-shadow:0 0 30px lime;
  margin-top:15px;
}

/* BUTTONS */
.btn{
  padding:12px 25px;
  margin:10px;
  border:none;
  border-radius:12px;
  cursor:pointer;
  background:lime;
  font-weight:bold;
  color:black;
  transition:0.3s;
}
.btn:hover{
  transform:scale(1.08);
  box-shadow:0 0 20px lime;
}
.back-btn{
  margin-top:20px;
  background:gray;
  color:white;
}

/* BOX */
.box{
  max-width:520px;
  margin:30px auto;
  padding:20px;
  border-radius:20px;
  background:rgba(0,0,0,.55);
  border:1px solid lime;
  box-shadow:0 0 25px rgba(0,255,0,.4);
}
body.light .box{
  background:rgba(255,255,255,.9);
  color:black;
}

/* INPUT */
input,textarea{
  width:95%;
  padding:12px;
  margin:8px 0;
  border-radius:10px;
  border:1px solid #777;
  outline:none;
  font-size:15px;
}
textarea{height:100px;}
input:focus,textarea:focus{
  border:1px solid lime;
  box-shadow:0 0 15px rgba(0,255,0,.4);
}

/* CHAT */
#chat{
  height:320px;
  overflow-y:auto;
  background:#000;
  border-radius:15px;
  padding:10px;
  text-align:left;
  border:1px solid lime;
}
body.light #chat{
  background:#f5f5f5;
}
.user{
  background:#00ff8833;
  padding:10px;
  margin:8px 0;
  border-radius:12px;
  color:lime;
  font-weight:bold;
}
.bot{
  background:#0088ff33;
  padding:10px;
  margin:8px 0;
  border-radius:12px;
  color:#66ccff;
  font-weight:bold;
}

/* GAMES GRID */
.games-grid{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
  gap:15px;
  margin-top:20px;
}

/* CANVAS */
canvas{
  background:#000;
  border-radius:15px;
  border:2px solid lime;
  max-width:100%;
  touch-action:none;
}

/* MOBILE */
@media(max-width:600px){
  #typingTitle{font-size:26px;}
  .profile-pic{width:160px;height:160px;}
  .menu-box{width:170px;}
}
</style>
</head>

<body>

<div class="menu" onclick="toggleMenu()">‚ò∞</div>

<div class="menu-box" id="menuBox">
  <button onclick="secureOpen('home')">üè† Home</button>
  <button onclick="secureOpen('ai')">ü§ñ MR7 AI</button>
  <button onclick="secureOpen('games')">üéÆ Games</button>
  <button onclick="secureOpen('contact')">üì© Contact</button>
  <button onclick="openSection('login')">üîê Login</button>
</div>

<button class="dark-toggle" onclick="toggleMode()">üåô Mode</button>

<!-- LOGIN -->
<div id="login" class="section active">
  <div class="box">
    <h2 style="color:lime;">üîê MR7 LOGIN SYSTEM</h2>
    <p style="margin-top:10px;">Login karoge tabhi website open hogi üòéüî•</p>

    <input id="email" placeholder="Enter Gmail / Email">
    <input id="password" type="password" placeholder="Enter Password">

    <button class="btn" onclick="signupUser()">Signup</button>
    <button class="btn" onclick="loginUser()">Login</button>
    <button class="btn" onclick="logoutUser()">Logout</button>

    <p id="loginStatus" style="margin-top:10px;color:lime;font-weight:bold;"></p>
  </div>
</div>

<!-- PROFILE SETUP -->
<div id="profile" class="section">
  <div class="box">
    <h2 style="color:lime;">üë§ Create Your Profile</h2>
    <p style="margin-top:10px;">Profile banaoge tabhi website unlock hogi üî•</p>

    <input id="pname" placeholder="Your Name">
    <input id="page" placeholder="Your Age">
    <input id="pcity" placeholder="Your City">
    <input id="pfav" placeholder="Your Favourite Game">
    
    <button class="btn" onclick="saveProfile()">Save Profile</button>
    <button class="btn back-btn" onclick="backToLogin()">‚¨Ö Back</button>

    <p id="profileStatus" style="margin-top:10px;color:lime;font-weight:bold;"></p>
  </div>
</div>

<!-- HOME -->
<div id="home" class="section">
  <h1 id="typingTitle"></h1>
  <h2>- MD -</h2>
  <h3>- REHAN -</h3>

  <a href="https://www.youtube.com/@MR7OFFICIAL777" target="_blank">
    <button class="btn">üî• SUBSCRIBE</button>
  </a>

  <p>üëÜ CLICK HERE ‚òù</p>

  <img src="rehan.png" class="profile-pic">

  <div class="box">
    <h2 style="color:lime;">üî• Welcome to MR7 WORLD</h2>
    <p id="welcomeUser" style="margin-top:10px;"></p>
    <p style="margin-top:10px;">Gaming + AI + Future System üòéüî•</p>
  </div>

  <button class="btn back-btn" onclick="logoutUser()">üö™ Logout</button>
</div>

<!-- CONTACT -->
<div id="contact" class="section">
  <div class="box">
    <h2 style="color:lime;">üì© Contact Me</h2>
    <input id="name" placeholder="Name">
    <input id="mobile" placeholder="Mobile">
    <textarea id="message" placeholder="Message"></textarea>
    <button class="btn" onclick="sendMail()">Send Email</button>
  </div>
  <button class="btn back-btn" onclick="secureOpen('home')">‚¨Ö Back</button>
</div>

<!-- AI -->
<div id="ai" class="section">
  <div class="box">
    <h2 style="color:lime;">ü§ñ MR7 AI (ULTRA SMART OFFLINE)</h2>
    <div id="chat"></div>

    <input id="aiInput" placeholder="Ask anything...">
    <button class="btn" onclick="askAI()">Send</button>
    <button class="btn" onclick="clearChat()">Clear</button>

    <p style="margin-top:10px;color:lime;">üí° Tip: type "calc 50+20" | "joke" | "story" | "quiz"</p>
  </div>

  <button class="btn back-btn" onclick="secureOpen('home')">‚¨Ö Back</button>
</div>

<!-- GAMES -->
<div id="games" class="section">
  <div class="box">
    <h2 style="color:lime;">üéÆ MR7 Games Zone</h2>
    <p>Mobile + PC dono me perfect chalega üî•</p>

    <div class="games-grid">
      <button class="btn" onclick="openGame('snakeBox')">üêç Snake Game</button>
      <button class="btn" onclick="openGame('carBox')">üöó Car Racing</button>
      <button class="btn" onclick="openGame('tttBox')">‚ùå‚≠ï Tic Tac Toe</button>
      <button class="btn" onclick="openGame('ballBox')">‚öΩ Bounce Ball</button>
      <button class="btn" onclick="openGame('memoryBox')">üß† Memory Game</button>
    </div>
  </div>

  <!-- Snake -->
  <div id="snakeBox" class="box" style="display:none;">
    <h2 style="color:lime;">üêç Snake Game (REAL SNAKE)</h2>
    <canvas id="snakeCanvas" width="320" height="320"></canvas>
    <p style="margin-top:10px;">Controls: Swipe | Arrow Keys</p>
    <p id="snakeScore" style="margin-top:10px;color:lime;font-weight:bold;">Score: 0</p>
    <button class="btn" onclick="startSnake()">Start Snake</button>
    <button class="btn back-btn" onclick="closeGames()">‚¨Ö Back</button>
  </div>

  <!-- Car -->
  <div id="carBox" class="box" style="display:none;">
    <h2 style="color:lime;">üöó Car Racing (UPGRADED)</h2>
    <canvas id="carCanvas" width="320" height="400"></canvas>
    <p style="margin-top:10px;">Controls: Swipe | Arrow Keys</p>
    <p id="carScore" style="margin-top:10px;color:lime;font-weight:bold;">Score: 0</p>
    <button class="btn" onclick="startCar()">Start Car</button>
    <button class="btn back-btn" onclick="closeGames()">‚¨Ö Back</button>
  </div>

  <!-- Tic Tac Toe -->
  <div id="tttBox" class="box" style="display:none;">
    <h2 style="color:lime;">‚ùå‚≠ï Tic Tac Toe (AI BOT)</h2>
    <div id="tttBoard" style="display:grid;grid-template-columns:repeat(3,1fr);gap:10px;margin-top:15px;"></div>
    <p id="tttStatus" style="margin-top:10px;color:lime;font-weight:bold;"></p>
    <button class="btn" onclick="resetTTT()">Restart</button>
    <button class="btn back-btn" onclick="closeGames()">‚¨Ö Back</button>
  </div>

  <!-- Bounce Ball -->
  <div id="ballBox" class="box" style="display:none;">
    <h2 style="color:lime;">‚öΩ Bounce Ball Game</h2>
    <canvas id="ballCanvas" width="320" height="400"></canvas>
    <p style="margin-top:10px;">Tap / Click to Jump</p>
    <p id="ballScore" style="margin-top:10px;color:lime;font-weight:bold;">Score: 0</p>
    <button class="btn" onclick="startBall()">Start Ball</button>
    <button class="btn back-btn" onclick="closeGames()">‚¨Ö Back</button>
  </div>

  <!-- Memory Game -->
  <div id="memoryBox" class="box" style="display:none;">
    <h2 style="color:lime;">üß† Memory Match Game</h2>
    <div id="memoryGrid" style="display:grid;grid-template-columns:repeat(4,1fr);gap:10px;margin-top:15px;"></div>
    <p id="memoryStatus" style="margin-top:10px;color:lime;font-weight:bold;"></p>
    <button class="btn" onclick="startMemory()">Start Memory</button>
    <button class="btn back-btn" onclick="closeGames()">‚¨Ö Back</button>
  </div>

  <button class="btn back-btn" onclick="secureOpen('home')">‚¨Ö Back Home</button>
</div>

<script>
/* MENU */
function toggleMenu(){
  let box=document.getElementById("menuBox");
  box.style.display = box.style.display==="block" ? "none" : "block";
}

/* OPEN SECTION */
function openSection(id){
  document.querySelectorAll(".section").forEach(s=>s.classList.remove("active"));
  document.getElementById(id).classList.add("active");
  document.getElementById("menuBox").style.display="none";
}

/* SECURE OPEN */
function secureOpen(id){
  let loggedIn = localStorage.getItem("mr7LoggedIn");

  if(loggedIn !== "yes"){
    alert("‚ö† Pehle login karo!");
    openSection("login");
    return;
  }

  let profileDone = localStorage.getItem("mr7ProfileDone");
  if(profileDone !== "yes"){
    alert("‚ö† Pehle profile complete karo!");
    openSection("profile");
    return;
  }

  openSection(id);
}

/* TYPING TITLE */
function startTypingTitle(){
  let text="- MR7 WORLD -";
  let i=0;
  let el=document.getElementById("typingTitle");
  el.innerHTML="";
  let t=setInterval(()=>{
    el.innerHTML += text.charAt(i);
    i++;
    if(i>=text.length) clearInterval(t);
  },120);
}
startTypingTitle();

/* DARK MODE PERMANENT */
function applyMode(){
  let mode = localStorage.getItem("mode") || "dark";
  if(mode==="light"){
    document.body.classList.add("light");
  }else{
    document.body.classList.remove("light");
  }
}
applyMode();

function toggleMode(){
  if(document.body.classList.contains("light")){
    document.body.classList.remove("light");
    localStorage.setItem("mode","dark");
  }else{
    document.body.classList.add("light");
    localStorage.setItem("mode","light");
  }
}

/* CONTACT EMAIL */
function sendMail(){
  let n=document.getElementById("name").value.trim();
  let m=document.getElementById("mobile").value.trim();
  let msg=document.getElementById("message").value.trim();

  if(!n || !msg){
    alert("Please enter Name and Message üòÖ");
    return;
  }

  let subject = encodeURIComponent("MR7 Contact from " + n);
  let body = encodeURIComponent("Name: " + n + "\nMobile: " + m + "\n\nMessage:\n" + msg);

  location.href="mailto:mrrehanofficial.1777@gmail.com?subject="+subject+"&body="+body;
}

/* SIGNUP SYSTEM */
function signupUser(){
  let email=document.getElementById("email").value.trim();
  let p=document.getElementById("password").value.trim();

  if(!email || !p){
    alert("‚ö† Email aur Password daalo!");
    return;
  }

  if(!email.includes("@") || !email.includes(".")){
    alert("‚ùå Valid Email daalo! Example: example@gmail.com");
    return;
  }

  let users = JSON.parse(localStorage.getItem("mr7Users") || "[]");

  if(users.find(x=>x.email===email)){
    alert("‚ö† Ye Email already registered hai!");
    return;
  }

  users.push({email:email,password:p});
  localStorage.setItem("mr7Users", JSON.stringify(users));

  alert("‚úÖ Signup Successful! Ab Login karo üòéüî•");
}

/* LOGIN SYSTEM */
function loginUser(){
  let email=document.getElementById("email").value.trim();
  let p=document.getElementById("password").value.trim();

  if(!email || !p){
    alert("‚ö† Email aur Password daalo!");
    return;
  }

  let users = JSON.parse(localStorage.getItem("mr7Users") || "[]");
  let found = users.find(x => x.email === email && x.password === p);

  if(!found){
    alert("‚ùå Galat hai! Email ya Password wrong üòÖ");
    return;
  }

  localStorage.setItem("mr7LoggedIn","yes");
  localStorage.setItem("mr7CurrentUser",email);

  document.getElementById("loginStatus").innerText="‚úÖ Login Successful!";

  if(localStorage.getItem("mr7ProfileDone") !== "yes"){
    openSection("profile");
  }else{
    openSection("home");
  }

  showWelcome();
}

/* LOGOUT */
function logoutUser(){
  localStorage.removeItem("mr7LoggedIn");
  localStorage.removeItem("mr7CurrentUser");
  localStorage.removeItem("mr7ProfileDone");
  localStorage.removeItem("mr7Profile");

  alert("Logout Successful!");
  openSection("login");
}

/* BACK TO LOGIN */
function backToLogin(){
  openSection("login");
}

/* SAVE PROFILE */
function saveProfile(){
  let name=document.getElementById("pname").value.trim();
  let age=document.getElementById("page").value.trim();
  let city=document.getElementById("pcity").value.trim();
  let fav=document.getElementById("pfav").value.trim();

  if(!name || !age || !city){
    document.getElementById("profileStatus").innerText="‚ùå Fill all details!";
    return;
  }

  let profileData={
    name:name,
    age:age,
    city:city,
    fav:fav
  };

  localStorage.setItem("mr7Profile", JSON.stringify(profileData));
  localStorage.setItem("mr7ProfileDone","yes");

  document.getElementById("profileStatus").innerText="‚úÖ Profile Saved Successfully!";

  showWelcome();
  setTimeout(()=>{
    openSection("home");
  },800);
}

/* SHOW WELCOME */
function showWelcome(){
  let p = JSON.parse(localStorage.getItem("mr7Profile") || "{}");
  if(p.name){
    document.getElementById("welcomeUser").innerHTML =
      "üëë Welcome <b style='color:lime;'>" + p.name + "</b> üî•<br>üèô City: " + p.city + "<br>üéÆ Fav: " + (p.fav||"Not set");
  }
}

/* AUTO LOGIN CHECK */
window.onload = ()=>{
  let loggedIn = localStorage.getItem("mr7LoggedIn");
  let profileDone = localStorage.getItem("mr7ProfileDone");

  if(loggedIn==="yes"){
    if(profileDone==="yes"){
      openSection("home");
      showWelcome();
    }else{
      openSection("profile");
    }
  }else{
    openSection("login");
  }
};

/* =========================================================
   ü§ñ MR7 AI (ULTRA SMART OFFLINE SYSTEM)
========================================================= */
let chat=document.getElementById("chat");
let aiInput=document.getElementById("aiInput");

function addMsg(text,cls){
  let div=document.createElement("div");
  div.className=cls;
  div.innerText=text;
  chat.appendChild(div);
  chat.scrollTop=chat.scrollHeight;
}

function safeCalc(exp){
  exp = exp.replace(/[^0-9+\-*/().% ]/g,"");
  if(exp.length>50) return "‚ùå Too long calculation!";
  try{
    let result = Function("return ("+exp+")")();
    return result;
  }catch{
    return null;
  }
}

function getUserProfile(){
  return JSON.parse(localStorage.getItem("mr7Profile") || "{}");
}

function smartReply(q){
  let original=q;
  q=q.toLowerCase().trim();

  let profile = getUserProfile();
  let userName = profile.name || "Boss";

  // greetings
  if(q==="hi" || q==="hello" || q.includes("namaste")){
    return "Hello "+userName+" üòéüî• MR7 AI ready hai!";
  }

  // calc
  if(q.startsWith("calc")){
    let exp=q.replace("calc","").trim();
    let r=safeCalc(exp);
    if(r===null) return "‚ùå Calculator error! Example: calc 50+20";
    return "üßÆ Result: " + r;
  }

  // time/date/day
  if(q.includes("time")){
    return "‚è∞ Current Time: " + new Date().toLocaleTimeString();
  }
  if(q.includes("date")){
    return "üìÖ Today Date: " + new Date().toLocaleDateString();
  }
  if(q.includes("day")){
    return "üìå Today is: " + new Date().toLocaleDateString("en-US",{weekday:"long"});
  }

  // owner
  if(q.includes("owner") || q.includes("creator") || q.includes("banaya")){
    return "üî• MR7 WORLD ka creator MD REHAN hai üòéüëë";
  }

  // youtube tips
  if(q.includes("youtube") || q.includes("channel") || q.includes("subscriber")){
    return "üìå YouTube Tip: Shorts daily + thumbnail bright + title short rakho üòéüî•";
  }

  // gaming tips
  if(q.includes("game") || q.includes("gaming")){
    return "üéÆ Gaming Tip: sensitivity fixed rakho + daily aim practice karo üòéüî•";
  }

  // football tips
  if(q.includes("football") || q.includes("cr7") || q.includes("ronaldo")){
    return "‚öΩ CR7 Tip: daily sprint + dribbling + shooting practice karo üî•";
  }

  // motivation
  if(q.includes("motivation") || q.includes("sad") || q.includes("depressed") || q.includes("give up")){
    return "üî• "+userName+" tu legend banega! Failures se hi hero banta hai üí™üòé";
  }

  // joke
  if(q.includes("joke")){
    let jokes=[
      "üòÇ Teacher: Tum late kyu aaye? Student: Sir sapna pura karne gaya tha üòé",
      "ü§£ Wifi aur pyaar dono weak ho to dard hota hai!",
      "üòÜ Boss: Main dieting pe hoon... Pizza: Tu jhooth bol raha hai!",
      "üòÇ Programming me sabse bada dukh: semicolon missing üò≠"
    ];
    return jokes[Math.floor(Math.random()*jokes.length)];
  }

  // story
  if(q.includes("story")){
    return "üìñ Ek baar MR7 WORLD ka Boss Rehan ne decide kiya: 'Main coder banunga!' Sab hans rahe the... par aaj woh legend ban raha hai üòéüî•";
  }

  // quiz mode
  if(q.includes("quiz")){
    let qs=[
      "üß† Quiz: Python me print ka use kisliye hota hai?",
      "üß† Quiz: HTML ka full form kya hai?",
      "üß† Quiz: JavaScript kis kaam aata hai?",
      "üß† Quiz: CSS ka use kya hota hai?"
    ];
    return qs[Math.floor(Math.random()*qs.length)];
  }

  // weather (offline)
  if(q.includes("weather")){
    return "üå¶ Weather feature offline hai boss üòÖ Live weather ke liye API lagana padega.";
  }

  // AI fallback smart
  let replies=[
    "üòé "+userName+" boss ye question mast hai! Thoda aur detail me likho.",
    "ü§ñ Main samajh raha hoon boss... tum kya exactly chahte ho?",
    "üî• MR7 AI ready hai! Tum bas clear bol do.",
    "‚ö° Interesting! Agar example doge to main perfect answer dunga üòé",
    "üíö Boss tum smart ho! Main help karunga full.",
    "üöÄ Future system active! Tum question repeat kar do thoda simple me."
  ];
  return replies[Math.floor(Math.random()*replies.length)];
}

function askAI(){
  let q=aiInput.value.trim();
  if(!q) return;

  addMsg("You: "+q,"user");
  aiInput.value="";

  setTimeout(()=>{
    let reply=smartReply(q);
    addMsg("AI: "+reply,"bot");
  },350);
}

aiInput.addEventListener("keypress",(e)=>{
  if(e.key==="Enter") askAI();
});

function clearChat(){
  if(confirm("Clear full chat?")){
    chat.innerHTML="";
  }
}

/* =========================================================
   üéÆ GAME OPEN
========================================================= */
function openGame(id){
  document.getElementById("snakeBox").style.display="none";
  document.getElementById("carBox").style.display="none";
  document.getElementById("tttBox").style.display="none";
  document.getElementById("ballBox").style.display="none";
  document.getElementById("memoryBox").style.display="none";
  document.getElementById(id).style.display="block";
}
function closeGames(){
  document.getElementById("snakeBox").style.display="none";
  document.getElementById("carBox").style.display="none";
  document.getElementById("tttBox").style.display="none";
  document.getElementById("ballBox").style.display="none";
  document.getElementById("memoryBox").style.display="none";
}

/* =========================================================
   üêç SNAKE GAME (REAL IMPROVED)
========================================================= */
let snakeCanvas=document.getElementById("snakeCanvas");
let sctx=snakeCanvas.getContext("2d");

let snake,food,dir,snakeInterval,snakeScore=0;

function resetSnake(){
  snake=[{x:160,y:160},{x:140,y:160},{x:120,y:160}];
  food={x:Math.floor(Math.random()*16)*20,y:Math.floor(Math.random()*16)*20};
  dir="RIGHT";
  snakeScore=0;
  document.getElementById("snakeScore").innerText="Score: 0";
}

function drawSnake(){
  sctx.clearRect(0,0,320,320);

  // food
  sctx.fillStyle="red";
  sctx.fillRect(food.x,food.y,20,20);

  // snake head
  sctx.fillStyle="lime";
  sctx.fillRect(snake[0].x,snake[0].y,20,20);

  // snake body
  sctx.fillStyle="#00aa00";
  for(let i=1;i<snake.length;i++){
    sctx.fillRect(snake[i].x,snake[i].y,20,20);
  }
}

function moveSnake(){
  let head={...snake[0]};

  if(dir==="RIGHT") head.x+=20;
  if(dir==="LEFT") head.x-=20;
  if(dir==="UP") head.y-=20;
  if(dir==="DOWN") head.y+=20;

  // wall collision
  if(head.x<0||head.y<0||head.x>=320||head.y>=320){
    clearInterval(snakeInterval);
    alert("üêç Game Over! Score: "+snakeScore);
    return;
  }

  // self collision
  for(let i=1;i<snake.length;i++){
    if(snake[i].x===head.x && snake[i].y===head.y){
      clearInterval(snakeInterval);
      alert("üêç Game Over! Score: "+snakeScore);
      return;
    }
  }

  snake.unshift(head);

  // eat food
  if(head.x===food.x && head.y===food.y){
    snakeScore++;
    document.getElementById("snakeScore").innerText="Score: "+snakeScore;
    food={
      x:Math.floor(Math.random()*16)*20,
      y:Math.floor(Math.random()*16)*20
    };
  }else{
    snake.pop();
  }

  drawSnake();
}

function startSnake(){
  resetSnake();
  drawSnake();
  clearInterval(snakeInterval);
  snakeInterval=setInterval(moveSnake,110);
}

// keyboard control
document.addEventListener("keydown",(e)=>{
  if(e.key==="ArrowUp" && dir!=="DOWN") dir="UP";
  if(e.key==="ArrowDown" && dir!=="UP") dir="DOWN";
  if(e.key==="ArrowLeft" && dir!=="RIGHT") dir="LEFT";
  if(e.key==="ArrowRight" && dir!=="LEFT") dir="RIGHT";
});

// swipe control
let startX=0,startY=0;
snakeCanvas.addEventListener("touchstart",(e)=>{
  startX=e.touches[0].clientX;
  startY=e.touches[0].clientY;
});
snakeCanvas.addEventListener("touchend",(e)=>{
  let endX=e.changedTouches[0].clientX;
  let endY=e.changedTouches[0].clientY;
  let dx=endX-startX;
  let dy=endY-startY;

  if(Math.abs(dx)>Math.abs(dy)){
    if(dx>0 && dir!=="LEFT") dir="RIGHT";
    if(dx<0 && dir!=="RIGHT") dir="LEFT";
  }else{
    if(dy>0 && dir!=="UP") dir="DOWN";
    if(dy<0 && dir!=="DOWN") dir="UP";
  }
});

/* =========================================================
   üöó CAR GAME (IMPROVED + SPEED)
========================================================= */
let carCanvas=document.getElementById("carCanvas");
let cctx=carCanvas.getContext("2d");

let carX=140,carY=320,enemyCars=[],score=0,carInterval,speed=6;

function resetCar(){
  carX=140;
  enemyCars=[
    {x:Math.random()*260,y:-100},
    {x:Math.random()*260,y:-350}
  ];
  score=0;
  speed=6;
  document.getElementById("carScore").innerText="Score: 0";
}

function drawCarGame(){
  cctx.clearRect(0,0,320,400);

  // road
  cctx.fillStyle="#111";
  cctx.fillRect(0,0,320,400);

  // road border
  cctx.strokeStyle="lime";
  cctx.lineWidth=3;
  cctx.strokeRect(5,5,310,390);

  // middle line
  cctx.strokeStyle="white";
  cctx.lineWidth=4;
  cctx.setLineDash([15,15]);
  cctx.beginPath();
  cctx.moveTo(160,0);
  cctx.lineTo(160,400);
  cctx.stroke();
  cctx.setLineDash([]);

  // player car
  cctx.fillStyle="lime";
  cctx.fillRect(carX,carY,40,60);
  cctx.fillStyle="black";
  cctx.fillRect(carX+8,carY+10,24,18);

  // enemy cars
  enemyCars.forEach(e=>{
    cctx.fillStyle="red";
    cctx.fillRect(e.x,e.y,40,60);
    cctx.fillStyle="black";
    cctx.fillRect(e.x+8,e.y+10,24,18);
  });

  // score
  cctx.fillStyle="yellow";
  cctx.font="18px Arial";
  cctx.fillText("Score: "+score,10,25);
}

function updateCarGame(){
  enemyCars.forEach(e=>{
    e.y += speed;

    // collision
    if(carX < e.x+40 && carX+40 > e.x && carY < e.y+60 && carY+60 > e.y){
      clearInterval(carInterval);
      alert("üí• Crash! Game Over! Score: "+score);
    }

    // reset enemy
    if(e.y>420){
      e.y=-120;
      e.x=Math.random()*260;
      score++;
      document.getElementById("carScore").innerText="Score: "+score;

      if(score%5===0){
        speed += 0.7;
      }
    }
  });

  drawCarGame();
}

function startCar(){
  resetCar();
  drawCarGame();
  clearInterval(carInterval);
  carInterval=setInterval(updateCarGame,40);
}

// keyboard
document.addEventListener("keydown",(e)=>{
  if(e.key==="ArrowLeft") carX -= 20;
  if(e.key==="ArrowRight") carX += 20;

  if(carX<10) carX=10;
  if(carX>270) carX=270;
});

// mobile swipe
let carTouchX=0;
carCanvas.addEventListener("touchensure",()=>{});
carCanvas.addEventListener("touchstart",(e)=>{
  carTouchX=e.touches[0].clientX;
});
carCanvas.addEventListener("touchmove",(e)=>{
  let x=e.touches[0].clientX;
  if(x>carTouchX) carX+=7;
  else carX-=7;
  carTouchX=x;

  if(carX<10) carX=10;
  if(carX>270) carX=270;
});

/* =========================================================
   ‚ùå‚≠ï TIC TAC TOE (BOT ADDED)
========================================================= */
let tttBoard=document.getElementById("tttBoard");
let tttStatus=document.getElementById("tttStatus");
let tttCells=[],currentPlayer="X";
let gameOver=false;

function createTTT(){
  tttBoard.innerHTML="";
  tttCells=new Array(9).fill("");
  currentPlayer="X";
  gameOver=false;
  tttStatus.innerText="Your Turn (X)";

  for(let i=0;i<9;i++){
    let btn=document.createElement("button");
    btn.style.height="80px";
    btn.style.fontSize="30px";
    btn.style.borderRadius="15px";
    btn.style.border="2px solid lime";
    btn.style.cursor="pointer";
    btn.style.background="#111";
    btn.style.color="lime";
    btn.innerText="";

    btn.onclick=()=>playTTT(i,btn);
    tttBoard.appendChild(btn);
  }
}
createTTT();

function playTTT(i,btn){
  if(gameOver) return;
  if(tttCells[i]!=="" ) return;

  tttCells[i]="X";
  btn.innerText="X";

  if(checkWin("X")){
    tttStatus.innerText="üèÜ You Win!";
    gameOver=true;
    return;
  }

  if(tttCells.every(c=>c!=="")){
    tttStatus.innerText="üòê Draw!";
    gameOver=true;
    return;
  }

  tttStatus.innerText="ü§ñ Bot Thinking...";

  setTimeout(()=>{
    botMove();
  },400);
}

function botMove(){
  let emptyIndexes=[];
  for(let i=0;i<9;i++){
    if(tttCells[i]==="") emptyIndexes.push(i);
  }

  let move = emptyIndexes[Math.floor(Math.random()*emptyIndexes.length)];
  tttCells[move]="O";

  tttBoard.children[move].innerText="O";

  if(checkWin("O")){
    tttStatus.innerText="ü§ñ Bot Wins!";
    gameOver=true;
    return;
  }

  if(tttCells.every(c=>c!=="")){
    tttStatus.innerText="üòê Draw!";
    gameOver=true;
    return;
  }

  tttStatus.innerText="Your Turn (X)";
}

function checkWin(p){
  let w=[
    [0,1,2],[3,4,5],[6,7,8],
    [0,3,6],[1,4,7],[2,5,8],
    [0,4,8],[2,4,6]
  ];
  return w.some(x=>{
    return tttCells[x[0]]===p && tttCells[x[1]]===p && tttCells[x[2]]===p;
  });
}
function resetTTT(){
  createTTT();
}

/* =========================================================
   ‚öΩ Bounce Ball Game
========================================================= */
let ballCanvas=document.getElementById("ballCanvas");
let bctx=ballCanvas.getContext("2d");

let ballY=300,ballV=0,gravity=0.6,ground=340;
let obstacles=[],ballInterval,ballScoreNum=0;

function resetBall(){
  ballY=300;
  ballV=0;
  obstacles=[{x:330,width:30,height:60}];
  ballScoreNum=0;
  document.getElementById("ballScore").innerText="Score: 0";
}

function drawBall(){
  bctx.clearRect(0,0,320,400);

  // ground
  bctx.fillStyle="#222";
  bctx.fillRect(0,ground+25,320,50);

  // ball
  bctx.beginPath();
  bctx.fillStyle="lime";
  bctx.arc(70,ballY,18,0,Math.PI*2);
  bctx.fill();

  // obstacles
  obstacles.forEach(o=>{
    bctx.fillStyle="red";
    bctx.fillRect(o.x,ground+25-o.height,o.width,o.height);
  });

  bctx.fillStyle="yellow";
  bctx.font="18px Arial";
  bctx.fillText("Score: "+ballScoreNum,10,25);
}

function updateBall(){
  ballV += gravity;
  ballY += ballV;

  if(ballY>ground){
    ballY=ground;
    ballV=0;
  }

  obstacles.forEach(o=>{
    o.x -= 5;

    // collision
    if(70+18 > o.x && 70-18 < o.x+o.width){
      if(ballY+18 > ground+25-o.height){
        clearInterval(ballInterval);
        alert("üí• Game Over! Score: "+ballScoreNum);
      }
    }

    // passed obstacle
    if(o.x < -40){
      o.x = 340;
      o.height = 40 + Math.random()*100;
      ballScoreNum++;
      document.getElementById("ballScore").innerText="Score: "+ballScoreNum;
    }
  });

  drawBall();
}

function jumpBall(){
  if(ballY>=ground){
    ballV = -12;
  }
}

function startBall(){
  resetBall();
  drawBall();
  clearInterval(ballInterval);
  ballInterval=setInterval(updateBall,30);
}

ballCanvas.addEventListener("click",jumpBall);
ballCanvas.addEventListener("touchstart",jumpBall);

/* =========================================================
   üß† Memory Match Game
========================================================= */
let memoryGrid=document.getElementById("memoryGrid");
let memoryStatus=document.getElementById("memoryStatus");
let memoryCards=[],firstPick=null,lock=false,matched=0;

function startMemory(){
  memoryGrid.innerHTML="";
  matched=0;
  firstPick=null;
  lock=false;

  let symbols=["üî•","üî•","‚öΩ","‚öΩ","üéÆ","üéÆ","üêç","üêç","üöó","üöó","üëë","üëë","ü§ñ","ü§ñ","üíé","üíé"];
  symbols.sort(()=>Math.random()-0.5);

  memoryCards=symbols;

  symbols.forEach((sym,index)=>{
    let btn=document.createElement("button");
    btn.style.height="70px";
    btn.style.fontSize="28px";
    btn.style.borderRadius="15px";
    btn.style.border="2px solid lime";
    btn.style.cursor="pointer";
    btn.style.background="#111";
    btn.style.color="lime";
    btn.innerText="‚ùì";

    btn.onclick=()=>flipCard(index,btn);
    memoryGrid.appendChild(btn);
  });

  memoryStatus.innerText="Match all pairs üòéüî•";
}

function flipCard(i,btn){
  if(lock) return;
  if(btn.innerText!=="‚ùì") return;

  btn.innerText=memoryCards[i];

  if(firstPick===null){
    firstPick={index:i,button:btn};
    return;
  }

  if(firstPick.index===i) return;

  // match
  if(memoryCards[firstPick.index]===memoryCards[i]){
    matched += 2;
    firstPick=null;

    if(matched===16){
      memoryStatus.innerText="üèÜ You Won! MR7 Brain Power üòéüî•";
    }
    return;
  }

  // not match
  lock=true;
  setTimeout(()=>{
    btn.innerText="‚ùì";
    firstPick.button.innerText="‚ùì";
    firstPick=null;
    lock=false;
  },700);
}
</script>

</body>
</html>
