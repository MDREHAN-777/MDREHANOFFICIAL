<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>MR7 WORLD</title>

<style>
    *{margin:0;padding:0;box-sizing:border-box;font-family:Segoe UI,Arial;}
    body{
        background:#000;
        color:#0f0;
        overflow:hidden;
    }

    /* PRELOADER */
    #preloader{
        position:fixed;
        top:0;left:0;
        width:100%;
        height:100%;
        background:#000;
        display:flex;
        align-items:center;
        justify-content:center;
        flex-direction:column;
        z-index:99999;
    }
    .loader-circle{
        width:80px;height:80px;
        border:5px solid rgba(0,255,0,.2);
        border-top:5px solid #00ff00;
        border-radius:50%;
        animation:spin 1s linear infinite;
        margin-bottom:15px;
    }
    @keyframes spin{100%{transform:rotate(360deg)}}
    #preloader p{color:#00ff00;font-size:18px}

    /* PARTICLES */
    canvas#particles{
        position:fixed;
        top:0;left:0;
        width:100%;
        height:100%;
        z-index:-1;
    }

    /* HEADER */
    header{
        width:100%;
        padding:15px 20px;
        display:flex;
        justify-content:space-between;
        align-items:center;
        border-bottom:1px solid rgba(0,255,0,.3);
        background:rgba(0,0,0,.6);
        backdrop-filter:blur(6px);
        position:fixed;
        top:0;left:0;
        z-index:999;
    }

    .logo-area{
        display:flex;
        align-items:center;
        gap:10px;
    }
    .logo-circle{
        width:45px;height:45px;
        border-radius:50%;
        border:2px solid #00ff00;
        display:flex;
        align-items:center;
        justify-content:center;
        font-weight:bold;
        box-shadow:0 0 15px #00ff00;
    }
    .title{
        font-size:20px;
        font-weight:bold;
        color:#00ff00;
    }
    .verified{
        font-size:14px;
        color:#fff;
        opacity:.9;
    }

    .status{
        display:flex;
        align-items:center;
        gap:8px;
        font-size:14px;
        color:#00ff00;
    }
    .dot{
        width:10px;height:10px;
        border-radius:50%;
        background:#00ff00;
        box-shadow:0 0 10px #00ff00;
    }

    .menu-btn{
        font-size:22px;
        cursor:pointer;
        color:#00ff00;
        user-select:none;
    }

    /* SIDEBAR */
    #sidebar{
        position:fixed;
        top:0;right:-280px;
        width:280px;
        height:100%;
        background:rgba(0,0,0,.95);
        border-left:2px solid rgba(0,255,0,.3);
        transition:.3s;
        z-index:9999;
        padding:20px;
    }
    #sidebar.active{right:0;}
    #sidebar h2{
        color:#00ff00;
        margin-bottom:15px;
    }
    .search-box{
        width:100%;
        padding:10px;
        border-radius:10px;
        border:1px solid rgba(0,255,0,.3);
        outline:none;
        background:#111;
        color:#00ff00;
        margin-bottom:15px;
    }
    .side-link{
        width:100%;
        padding:12px;
        margin:8px 0;
        border-radius:12px;
        background:#111;
        border:1px solid rgba(0,255,0,.3);
        color:#00ff00;
        cursor:pointer;
        transition:.2s;
        text-align:left;
        font-size:15px;
    }
    .side-link:hover{
        background:#00ff00;
        color:#000;
        box-shadow:0 0 15px #00ff00;
    }

    /* PAGES */
    .page{
        width:100%;
        height:100vh;
        padding-top:80px;
        display:none;
        animation:fadeSlide .35s ease;
        overflow:auto;
    }
    @keyframes fadeSlide{
        from{opacity:0;transform:translateY(20px);}
        to{opacity:1;transform:translateY(0);}
    }
    .page.active{display:block;}

    .center-box{
        max-width:900px;
        margin:40px auto;
        padding:30px;
        border-radius:25px;
        border:2px solid rgba(0,255,0,.25);
        background:rgba(0,0,0,.6);
        box-shadow:0 0 25px rgba(0,255,0,.25);
        text-align:center;
    }

    .big-title{
        font-size:34px;
        color:#00ff00;
        text-shadow:0 0 15px #00ff00;
        margin-bottom:10px;
    }
    .subtitle{
        color:#ccc;
        font-size:16px;
        margin-bottom:25px;
    }

    .btn{
        padding:12px 20px;
        border:none;
        outline:none;
        border-radius:12px;
        cursor:pointer;
        background:#00ff00;
        color:#000;
        font-weight:bold;
        margin:8px;
        box-shadow:0 0 15px #00ff00;
        transition:.2s;
    }
    .btn:hover{transform:scale(1.05);}

    .btn-dark{
        background:#111;
        color:#00ff00;
        border:1px solid rgba(0,255,0,.4);
        box-shadow:none;
    }

    /* GAME GRID */
    .game-grid{
        display:grid;
        grid-template-columns:repeat(auto-fit,minmax(200px,1fr));
        gap:15px;
        margin-top:20px;
    }
    .game-card{
        padding:18px;
        border-radius:18px;
        background:#070707;
        border:1px solid rgba(0,255,0,.25);
        box-shadow:0 0 15px rgba(0,255,0,.15);
        text-align:left;
        cursor:pointer;
        transition:.25s;
    }
    .game-card:hover{
        transform:translateY(-4px);
        border-color:#00ff00;
        box-shadow:0 0 20px rgba(0,255,0,.4);
    }
    .game-card h3{color:#00ff00;margin-bottom:6px;}
    .game-card p{color:#aaa;font-size:13px;}

    /* FULL GAME SCREEN */
    #gameScreen{
        width:100%;
        height:100vh;
        display:none;
        background:#000;
        position:fixed;
        top:0;left:0;
        z-index:99999;
        padding-top:80px;
    }

    #gameTopBar{
        position:fixed;
        top:70px;
        left:0;
        width:100%;
        padding:10px;
        display:flex;
        justify-content:center;
        gap:10px;
        z-index:999999;
    }

    #gameCanvas{
        display:block;
        margin:30px auto;
        border-radius:18px;
        border:2px solid rgba(0,255,0,.35);
        box-shadow:0 0 25px rgba(0,255,0,.35);
        background:#020202;
    }

    /* AI CHAT */
    .chat-box{
        width:100%;
        max-width:800px;
        margin:0 auto;
        padding:15px;
        border-radius:20px;
        border:2px solid rgba(0,255,0,.25);
        background:rgba(0,0,0,.6);
        box-shadow:0 0 20px rgba(0,255,0,.25);
    }
    .chat-log{
        height:320px;
        overflow-y:auto;
        border-radius:15px;
        padding:10px;
        border:1px solid rgba(0,255,0,.2);
        background:#050505;
        text-align:left;
    }
    .msg{
        padding:10px 12px;
        margin:10px 0;
        border-radius:14px;
        font-size:14px;
        line-height:1.5;
        width:fit-content;
        max-width:90%;
    }
    .you{
        background:rgba(0,255,0,.12);
        border:1px solid rgba(0,255,0,.35);
        color:#00ff00;
        margin-left:auto;
    }
    .ai{
        background:rgba(0,140,255,.15);
        border:1px solid rgba(0,140,255,.35);
        color:#a8d8ff;
        margin-right:auto;
    }
    .chat-input{
        width:100%;
        padding:12px;
        margin-top:12px;
        border-radius:14px;
        border:1px solid rgba(0,255,0,.25);
        outline:none;
        background:#111;
        color:#00ff00;
    }

    /* FULLSCREEN BTN */
    #fullscreenBtn{
        position:fixed;
        bottom:20px;
        right:20px;
        z-index:99999;
    }

</style>
</head>
<body>

<!-- PRELOADER -->
<div id="preloader">
    <div class="loader-circle"></div>
    <p>Loading MR7 WORLD...</p>
</div>

<canvas id="particles"></canvas>

<header>
    <div class="logo-area">
        <div class="logo-circle">MR7</div>
        <div>
            <div class="title">MR7 WORLD <span class="verified">‚úî Verified</span></div>
            <div style="font-size:12px;color:#aaa;">Owner: MR7</div>
        </div>
    </div>

    <div class="status">
        <div class="dot"></div> Online
    </div>

    <div class="menu-btn" onclick="toggleSidebar()">‚ãÆ</div>
</header>

<!-- SIDEBAR -->
<div id="sidebar">
    <h2>MR7 Menu</h2>
    <input class="search-box" id="menuSearch" placeholder="Search page..." onkeyup="searchMenu()"/>

    <button class="side-link" onclick="openPage('homePage')">üè† Home</button>
    <button class="side-link" onclick="openPage('gamesPage')">üéÆ Games</button>
    <button class="side-link" onclick="openPage('aiPage')">ü§ñ MR7 AI</button>
    <button class="side-link" onclick="openPage('profilePage')">üë§ Profile</button>
</div>

<!-- HOME PAGE -->
<div id="homePage" class="page active">
    <div class="center-box">
        <div class="big-title">WELCOME TO MR7 WORLD</div>
        <div class="subtitle">Gaming + AI + Cool Features üòé</div>

        <button class="btn" onclick="openPage('gamesPage')">üéÆ Open Games</button>
        <button class="btn" onclick="openPage('aiPage')">ü§ñ Open MR7 AI</button>
        <button class="btn btn-dark" onclick="openPage('profilePage')">üë§ Profile</button>
    </div>
</div>

<!-- GAMES PAGE -->
<div id="gamesPage" class="page">
    <div class="center-box">
        <div class="big-title">üéÆ MR7 Games Hub</div>
        <div class="subtitle">Choose a game (Full screen mode)</div>

        <div class="game-grid">

            <div class="game-card" onclick="startGame('snake')">
                <h3>üêç Snake Pro</h3>
                <p>Real smooth snake + glow + levels.</p>
            </div>

            <div class="game-card" onclick="startGame('car')">
                <h3>üöó Car Racing Nitro</h3>
                <p>Road, traffic, nitro boost, steering.</p>
            </div>

            <div class="game-card" onclick="startGame('space')">
                <h3>üöÄ Space Shooter</h3>
                <p>Rocket + enemies + stars + explosions.</p>
            </div>

            <div class="game-card" onclick="startGame('tictac')">
                <h3>‚ùå‚≠ï Tic Tac Toe</h3>
                <p>Single player robot + multiplayer mode.</p>
            </div>

            <div class="game-card" onclick="startGame('runner')">
                <h3>üèÉ 3D Runner</h3>
                <p>Pseudo 3D endless runner (real feel).</p>
            </div>

            <div class="game-card" onclick="startGame('brick')">
                <h3>üß± Brick Breaker</h3>
                <p>Classic arcade with smooth physics.</p>
            </div>

        </div>

        <button class="btn btn-dark" onclick="openPage('homePage')">‚¨Ö Back</button>
    </div>
</div>

<!-- AI PAGE -->
<div id="aiPage" class="page">
    <div class="center-box">
        <div class="big-title">ü§ñ MR7 AI</div>
        <div class="subtitle">Hinglish only üòé | Offline Smart + OpenAI API Support</div>

        <div class="chat-box">
            <div class="chat-log" id="chatLog"></div>

            <input class="chat-input" id="chatInput" placeholder="Type message... (Enter = Send)"/>
            <button class="btn" onclick="sendMessage()">Send</button>
            <button class="btn btn-dark" onclick="clearChat()">Clear</button>
        </div>

        <br>
        <input class="chat-input" id="apiKey" placeholder="Paste OpenAI API key (optional)" />
        <br>
        <button class="btn btn-dark" onclick="openPage('homePage')">‚¨Ö Back</button>
    </div>
</div>

<!-- PROFILE PAGE -->
<div id="profilePage" class="page">
    <div class="center-box">
        <div class="big-title">üë§ Profile Card</div>
        <div class="subtitle">MR7 WORLD Social Links</div>

        <div style="padding:20px;border-radius:20px;border:1px solid rgba(0,255,0,.25);background:#050505;">
            <h2 style="color:#00ff00;margin-bottom:5px;">MR7 WORLD ‚úî</h2>
            <p style="color:#aaa;">Gaming + AI + Cool Features</p>
            <br>

            <button class="btn" onclick="window.open('https://instagram.com','_blank')">Instagram</button>
            <button class="btn" onclick="window.open('https://youtube.com','_blank')">YouTube</button>
            <button class="btn" onclick="window.open('https://wa.me/','_blank')">WhatsApp</button>
        </div>

        <br>
        <button class="btn btn-dark" onclick="openPage('homePage')">‚¨Ö Back</button>
    </div>
</div>

<!-- FULL GAME SCREEN -->
<div id="gameScreen">
    <div id="gameTopBar">
        <button class="btn btn-dark" onclick="exitGame()">‚¨Ö Exit Game</button>
        <button class="btn" onclick="restartGame()">üîÅ Restart</button>
    </div>

    <canvas id="gameCanvas" width="420" height="650"></canvas>
</div>

<!-- FULLSCREEN -->
<button class="btn" id="fullscreenBtn" onclick="goFullscreen()">üì± Fullscreen</button>

<script>
/* PRELOADER */
window.onload = () => {
    setTimeout(() => {
        document.getElementById("preloader").style.display="none";
    }, 1200);
};

/* SIDEBAR */
function toggleSidebar(){
    document.getElementById("sidebar").classList.toggle("active");
}
function openPage(pageId){
    document.getElementById("sidebar").classList.remove("active");
    document.querySelectorAll(".page").forEach(p=>p.classList.remove("active"));
    document.getElementById(pageId).classList.add("active");
}

/* SEARCH MENU */
function searchMenu(){
    let q = document.getElementById("menuSearch").value.toLowerCase();
    let btns = document.querySelectorAll(".side-link");
    btns.forEach(btn=>{
        btn.style.display = btn.innerText.toLowerCase().includes(q) ? "block":"none";
    });
}

/* FULLSCREEN */
function goFullscreen(){
    if(document.documentElement.requestFullscreen){
        document.documentElement.requestFullscreen();
    }
}

/* PARTICLES */
const pc = document.getElementById("particles");
const pctx = pc.getContext("2d");
pc.width = window.innerWidth;
pc.height = window.innerHeight;
let particles = [];
for(let i=0;i<80;i++){
    particles.push({
        x:Math.random()*pc.width,
        y:Math.random()*pc.height,
        r:Math.random()*2+1,
        vx:(Math.random()-.5)*1,
        vy:(Math.random()-.5)*1
    });
}
function animateParticles(){
    pctx.clearRect(0,0,pc.width,pc.height);
    particles.forEach(p=>{
        p.x+=p.vx; p.y+=p.vy;
        if(p.x<0||p.x>pc.width) p.vx*=-1;
        if(p.y<0||p.y>pc.height) p.vy*=-1;

        pctx.beginPath();
        pctx.arc(p.x,p.y,p.r,0,Math.PI*2);
        pctx.fillStyle="rgba(0,255,0,.7)";
        pctx.fill();
    });
    requestAnimationFrame(animateParticles);
}
animateParticles();

window.onresize=()=>{
    pc.width=window.innerWidth;
    pc.height=window.innerHeight;
}

/* AI CHAT SYSTEM */
let chatLog = document.getElementById("chatLog");

function addMsg(text,type){
    let div = document.createElement("div");
    div.className="msg "+type;
    div.innerText=text;
    chatLog.appendChild(div);
    chatLog.scrollTop=chatLog.scrollHeight;
}

addMsg("AI: Hello boss üòé MR7 AI ready hai!", "ai");

async function sendMessage(){
    let input = document.getElementById("chatInput");
    let msg = input.value.trim();
    if(!msg) return;
    input.value="";
    addMsg("You: "+msg,"you");

    let key = document.getElementById("apiKey").value.trim();

    if(key.startsWith("sk-")){
        // REAL OPENAI API
        try{
            addMsg("AI: Thinking...", "ai");

            const res = await fetch("https://api.openai.com/v1/chat/completions",{
                method:"POST",
                headers:{
                    "Content-Type":"application/json",
                    "Authorization":"Bearer "+key
                },
                body:JSON.stringify({
                    model:"gpt-4o-mini",
                    messages:[
                        {role:"system",content:"You are MR7 AI. Speak Hinglish only. No pure Hindi script. Be helpful, short and smart."},
                        {role:"user",content:msg}
                    ],
                    max_tokens:200
                })
            });

            const data = await res.json();
            chatLog.lastChild.remove();

            if(data.error){
                addMsg("AI: Boss API error: "+data.error.message,"ai");
            }else{
                addMsg("AI: "+data.choices[0].message.content,"ai");
            }
        }catch(e){
            chatLog.lastChild.remove();
            addMsg("AI: Boss network error, API call failed.","ai");
        }
    }else{
        // OFFLINE SMART AI
        let reply = offlineAI(msg);
        addMsg("AI: "+reply,"ai");
    }
}

document.getElementById("chatInput").addEventListener("keydown", function(e){
    if(e.key==="Enter"){
        sendMessage();
    }
});

function clearChat(){
    chatLog.innerHTML="";
    addMsg("AI: Chat cleared boss üòé","ai");
}

function offlineAI(q){
    q=q.toLowerCase();

    if(q.includes("time")) return "Boss current time: "+new Date().toLocaleTimeString();
    if(q.includes("date")) return "Boss today date: "+new Date().toDateString();
    if(q.includes("day")) return "Boss today is: "+new Date().toLocaleDateString("en-US",{weekday:"long"});

    if(q.includes("weather")) return "Boss weather ke liye API chahiye. Agar OpenAI key doge to main real-time style answer de dunga.";
    if(q.includes("news")) return "Boss news real-time nahi milta offline mode me. OpenAI key paste karoge to main full smart ban jaunga.";

    if(q.includes("python")) return "Boss Python ek easy language hai. Tum loops, list, functions aur projects karo. Main help kar dunga.";
    if(q.includes("html")) return "Boss HTML se website structure banta hai. CSS se design aur JS se animation + logic.";
    if(q.includes("css")) return "Boss CSS se style hota hai: colors, layout, animation, responsive design.";
    if(q.includes("javascript") || q.includes("js")) return "Boss JavaScript website ko alive banata hai. Games, AI, animation sab JS se hota hai.";

    if(q.includes("who are you")) return "Boss main MR7 AI hu üòé Gaming + Smart Assistant mode!";
    if(q.includes("hello") || q.includes("hi")) return "Hello boss üòé kya help chahiye?";

    return "Boss main offline mode me hu üòÖ Agar tum OpenAI API key paste kar do to main next level ChatGPT ban jaunga!";
}

/* GAME ENGINE */
const gameScreen = document.getElementById("gameScreen");
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");

let currentGame = null;
let gameLoop = null;

/* GAME START */
function startGame(gameName){
    currentGame = gameName;
    document.getElementById("gameScreen").style.display="block";
    openPage("homePage"); // hide pages behind
    stopLoop();
    initGame(gameName);
}

/* EXIT GAME */
function exitGame(){
    stopLoop();
    gameScreen.style.display="none";
}

/* RESTART */
function restartGame(){
    stopLoop();
    initGame(currentGame);
}

function stopLoop(){
    if(gameLoop) cancelAnimationFrame(gameLoop);
}

/* INIT GAME */
function initGame(name){
    if(name==="snake") snakeGame();
    if(name==="car") carGame();
    if(name==="space") spaceShooter();
    if(name==="tictac") ticTacToe();
    if(name==="runner") runner3D();
    if(name==="brick") brickBreaker();
}

/* =======================
   SNAKE GAME PRO
======================= */
function snakeGame(){
    let grid=20;
    let snake=[{x:10,y:10},{x:9,y:10},{x:8,y:10}];
    let dx=1,dy=0;
    let food={x:15,y:15};
    let score=0;
    let speed=7;
    let frame=0;

    function draw(){
        ctx.fillStyle="#000";
        ctx.fillRect(0,0,canvas.width,canvas.height);

        // border glow
        ctx.strokeStyle="rgba(0,255,0,.4)";
        ctx.lineWidth=4;
        ctx.strokeRect(0,0,canvas.width,canvas.height);

        // food
        ctx.fillStyle="#ff0000";
        ctx.beginPath();
        ctx.arc(food.x*grid+grid/2, food.y*grid+grid/2, grid/2.5, 0, Math.PI*2);
        ctx.fill();

        // snake
        snake.forEach((s,i)=>{
            ctx.fillStyle = i===0 ? "#00ff00" : "rgba(0,255,0,.7)";
            ctx.shadowColor="#00ff00";
            ctx.shadowBlur=10;
            ctx.fillRect(s.x*grid,s.y*grid,grid-2,grid-2);
            ctx.shadowBlur=0;
        });

        ctx.fillStyle="#00ff00";
        ctx.font="16px Arial";
        ctx.fillText("Score: "+score, 10, 20);
        ctx.fillText("HighScore: "+(localStorage.getItem("snakeHigh")||0), 10, 40);
    }

    function update(){
        frame++;
        if(frame % Math.floor(60/speed) !== 0){
            draw();
            gameLoop=requestAnimationFrame(update);
            return;
        }

        let head={x:snake[0].x+dx, y:snake[0].y+dy};

        // wall wrap
        if(head.x<0) head.x=canvas.width/grid-1;
        if(head.y<0) head.y=canvas.height/grid-1;
        if(head.x>=canvas.width/grid) head.x=0;
        if(head.y>=canvas.height/grid) head.y=0;

        // collision
        for(let i=1;i<snake.length;i++){
            if(snake[i].x===head.x && snake[i].y===head.y){
                gameOver();
                return;
            }
        }

        snake.unshift(head);

        if(head.x===food.x && head.y===food.y){
            score++;
            speed = Math.min(18, speed+0.5);
            food={x:Math.floor(Math.random()*(canvas.width/grid)),
                  y:Math.floor(Math.random()*(canvas.height/grid))};
        }else{
            snake.pop();
        }

        draw();
        gameLoop=requestAnimationFrame(update);
    }

    function gameOver(){
        let high = parseInt(localStorage.getItem("snakeHigh")||0);
        if(score>high) localStorage.setItem("snakeHigh",score);

        ctx.fillStyle="rgba(0,0,0,.8)";
        ctx.fillRect(0,0,canvas.width,canvas.height);
        ctx.fillStyle="#00ff00";
        ctx.font="28px Arial";
        ctx.fillText("GAME OVER", 120, 300);
        ctx.font="18px Arial";
        ctx.fillText("Score: "+score, 160, 340);
    }

    window.onkeydown=(e)=>{
        if(e.key==="ArrowUp" && dy!==1){dx=0;dy=-1;}
        if(e.key==="ArrowDown" && dy!==-1){dx=0;dy=1;}
        if(e.key==="ArrowLeft" && dx!==1){dx=-1;dy=0;}
        if(e.key==="ArrowRight" && dx!==-1){dx=1;dy=0;}
    };

    update();
}

/* =======================
   CAR RACING NITRO
======================= */
function carGame(){
    let car={x:180,y:520,w:50,h:80,speed:6};
    let roadOffset=0;
    let score=0;
    let nitro=100;
    let traffic=[];
    let gameOver=false;

    function spawnTraffic(){
        traffic.push({
            x:Math.random()*320+40,
            y:-100,
            w:45,h:75,
            speed:Math.random()*2+4
        });
    }

    function drawCar(x,y,w,h,color){
        ctx.fillStyle=color;
        ctx.fillRect(x,y,w,h);
        ctx.fillStyle="#000";
        ctx.fillRect(x+8,y+10,w-16,20);
        ctx.fillRect(x+8,y+45,w-16,20);
        ctx.fillStyle="#00ff00";
        ctx.fillRect(x+10,y+5,w-20,5);
    }

    function draw(){
        ctx.fillStyle="#000";
        ctx.fillRect(0,0,canvas.width,canvas.height);

        // road
        ctx.fillStyle="#111";
        ctx.fillRect(60,0,300,canvas.height);

        // road lines
        ctx.strokeStyle="rgba(255,255,255,.2)";
        ctx.lineWidth=4;
        for(let i=0;i<20;i++){
            ctx.beginPath();
            ctx.moveTo(210, i*60 + roadOffset);
            ctx.lineTo(210, i*60 + 30 + roadOffset);
            ctx.stroke();
        }

        // player car
        drawCar(car.x,car.y,car.w,car.h,"#00ff00");

        // traffic cars
        traffic.forEach(t=>{
            drawCar(t.x,t.y,t.w,t.h,"#ff0000");
        });

        // UI
        ctx.fillStyle="#00ff00";
        ctx.font="16px Arial";
        ctx.fillText("Score: "+score, 10, 20);
        ctx.fillText("HighScore: "+(localStorage.getItem("carHigh")||0), 10, 40);
        ctx.fillText("Nitro: "+nitro+"%", 10, 60);

        if(gameOver){
            ctx.fillStyle="rgba(0,0,0,.8)";
            ctx.fillRect(0,0,canvas.width,canvas.height);
            ctx.fillStyle="#00ff00";
            ctx.font="28px Arial";
            ctx.fillText("CRASHED!", 140, 300);
        }
    }

    function update(){
        if(gameOver){
            draw();
            return;
        }

        roadOffset += car.speed;
        if(roadOffset>60) roadOffset=0;

        // spawn
        if(Math.random()<0.03) spawnTraffic();

        // update traffic
        traffic.forEach(t=>{
            t.y += t.speed + (score/100);
        });

        // remove old
        traffic = traffic.filter(t=>t.y<canvas.height+100);

        // collision
        traffic.forEach(t=>{
            if(car.x < t.x+t.w && car.x+car.w > t.x &&
               car.y < t.y+t.h && car.y+car.h > t.y){
                gameOver=true;
                let high=parseInt(localStorage.getItem("carHigh")||0);
                if(score>high) localStorage.setItem("carHigh",score);
            }
        });

        score++;

        draw();
        gameLoop=requestAnimationFrame(update);
    }

    window.onkeydown=(e)=>{
        if(e.key==="ArrowLeft") car.x-=20;
        if(e.key==="ArrowRight") car.x+=20;

        if(e.key===" " && nitro>0){
            car.speed=12;
            nitro-=10;
        }else{
            car.speed=6;
        }

        if(car.x<60) car.x=60;
        if(car.x>310) car.x=310;
    };

    update();
}

/* =======================
   SPACE SHOOTER
======================= */
function spaceShooter(){
    let rocket={x:200,y:560,w:30,h:60};
    let bullets=[];
    let enemies=[];
    let score=0;
    let stars=[];
    let gameOver=false;

    for(let i=0;i<80;i++){
        stars.push({x:Math.random()*canvas.width,y:Math.random()*canvas.height,s:Math.random()*2+1});
    }

    function spawnEnemy(){
        enemies.push({
            x:Math.random()*(canvas.width-40),
            y:-50,
            w:40,h:40,
            speed:Math.random()*2+2
        });
    }

    function drawRocket(){
        ctx.fillStyle="#00ff00";
        ctx.fillRect(rocket.x,rocket.y,rocket.w,rocket.h);
        ctx.fillStyle="#fff";
        ctx.fillRect(rocket.x+8,rocket.y+10,14,20);
        ctx.fillStyle="#ff0000";
        ctx.fillRect(rocket.x+5,rocket.y+rocket.h,20,15);
    }

    function draw(){
        ctx.fillStyle="#000";
        ctx.fillRect(0,0,canvas.width,canvas.height);

        // stars background
        ctx.fillStyle="#00ff00";
        stars.forEach(st=>{
            ctx.globalAlpha=0.5;
            ctx.fillRect(st.x,st.y,st.s,st.s);
        });
        ctx.globalAlpha=1;

        drawRocket();

        // bullets
        ctx.fillStyle="#00ffff";
        bullets.forEach(b=>{
            ctx.fillRect(b.x,b.y,4,15);
        });

        // enemies
        ctx.fillStyle="#ff0000";
        enemies.forEach(en=>{
            ctx.fillRect(en.x,en.y,en.w,en.h);
        });

        ctx.fillStyle="#00ff00";
        ctx.font="16px Arial";
        ctx.fillText("Score: "+score, 10, 20);
        ctx.fillText("HighScore: "+(localStorage.getItem("spaceHigh")||0), 10, 40);

        if(gameOver){
            ctx.fillStyle="rgba(0,0,0,.8)";
            ctx.fillRect(0,0,canvas.width,canvas.height);
            ctx.fillStyle="#00ff00";
            ctx.font="28px Arial";
            ctx.fillText("MISSION FAILED", 90, 320);
        }
    }

    function update(){
        if(gameOver){
            draw();
            return;
        }

        stars.forEach(st=>{
            st.y += st.s;
            if(st.y>canvas.height) st.y=0;
        });

        if(Math.random()<0.03) spawnEnemy();

        bullets.forEach(b=>b.y-=10);
        bullets = bullets.filter(b=>b.y>-20);

        enemies.forEach(en=>en.y+=en.speed);
        enemies = enemies.filter(en=>en.y<canvas.height+100);

        // collision bullet-enemy
        bullets.forEach((b,bi)=>{
            enemies.forEach((en,ei)=>{
                if(b.x<en.x+en.w && b.x+4>en.x && b.y<en.y+en.h && b.y+15>en.y){
                    enemies.splice(ei,1);
                    bullets.splice(bi,1);
                    score+=10;
                }
            });
        });

        // enemy hit rocket
        enemies.forEach(en=>{
            if(rocket.x<en.x+en.w && rocket.x+rocket.w>en.x &&
               rocket.y<en.y+en.h && rocket.y+rocket.h>en.y){
                gameOver=true;
                let high=parseInt(localStorage.getItem("spaceHigh")||0);
                if(score>high) localStorage.setItem("spaceHigh",score);
            }
        });

        draw();
        gameLoop=requestAnimationFrame(update);
    }

    window.onkeydown=(e)=>{
        if(e.key==="ArrowLeft") rocket.x-=20;
        if(e.key==="ArrowRight") rocket.x+=20;
        if(e.key==="ArrowUp") rocket.y-=20;
        if(e.key==="ArrowDown") rocket.y+=20;

        if(e.key==="Enter"){
            bullets.push({x:rocket.x+rocket.w/2,y:rocket.y});
        }

        rocket.x=Math.max(0,Math.min(canvas.width-rocket.w,rocket.x));
        rocket.y=Math.max(0,Math.min(canvas.height-rocket.h,rocket.y));
    };

    update();
}

/* =======================
   TIC TAC TOE (ROBOT MODE)
======================= */
function ticTacToe(){
    let board=["","","","","","","","",""];
    let player="X";
    let mode="robot"; // robot always
    let winner=null;

    function draw(){
        ctx.fillStyle="#000";
        ctx.fillRect(0,0,canvas.width,canvas.height);

        ctx.strokeStyle="#00ff00";
        ctx.lineWidth=4;

        for(let i=1;i<3;i++){
            ctx.beginPath();
            ctx.moveTo(i*140,100);
            ctx.lineTo(i*140,520);
            ctx.stroke();

            ctx.beginPath();
            ctx.moveTo(0,100+i*140);
            ctx.lineTo(420,100+i*140);
            ctx.stroke();
        }

        ctx.font="70px Arial";
        ctx.fillStyle="#00ff00";

        for(let i=0;i<9;i++){
            let x=(i%3)*140+55;
            let y=Math.floor(i/3)*140+200;
            ctx.fillText(board[i],x,y);
        }

        ctx.font="18px Arial";
        ctx.fillText("Mode: Single Player (Robot)", 10, 30);
        ctx.fillText("You: X | Robot: O", 10, 55);

        if(winner){
            ctx.fillStyle="rgba(0,0,0,.8)";
            ctx.fillRect(0,0,canvas.width,canvas.height);
            ctx.fillStyle="#00ff00";
            ctx.font="28px Arial";
            ctx.fillText(winner, 140, 320);
        }
    }

    function checkWin(){
        let wins=[
            [0,1,2],[3,4,5],[6,7,8],
            [0,3,6],[1,4,7],[2,5,8],
            [0,4,8],[2,4,6]
        ];
        for(let w of wins){
            if(board[w[0]] && board[w[0]]===board[w[1]] && board[w[0]]===board[w[2]]){
                return board[w[0]];
            }
        }
        if(!board.includes("")) return "draw";
        return null;
    }

    function robotMove(){
        // smart robot (basic)
        let empty=[];
        for(let i=0;i<9;i++) if(board[i]==="") empty.push(i);
        if(empty.length===0) return;

        let pick = empty[Math.floor(Math.random()*empty.length)];
        board[pick]="O";
    }

    canvas.onclick=(e)=>{
        if(winner) return;

        let rect=canvas.getBoundingClientRect();
        let mx=e.clientX-rect.left;
        let my=e.clientY-rect.top;

        if(my<100) return;

        let col=Math.floor(mx/140);
        let row=Math.floor((my-100)/140);
        let index=row*3+col;

        if(board[index]===""){
            board[index]="X";

            let win=checkWin();
            if(win==="X") winner="YOU WIN üòé";
            if(win==="O") winner="ROBOT WIN ü§ñ";
            if(win==="draw") winner="DRAW üòÖ";

            if(!winner){
                robotMove();
                win=checkWin();
                if(win==="X") winner="YOU WIN üòé";
                if(win==="O") winner="ROBOT WIN ü§ñ";
                if(win==="draw") winner="DRAW üòÖ";
            }
        }
        draw();
    };

    draw();
}

/* =======================
   3D RUNNER (PSEUDO 3D)
======================= */
function runner3D(){
    let player={x:200,y:550,w:40,h:40};
    let obstacles=[];
    let score=0;
    let speed=5;
    let gameOver=false;

    function spawnObs(){
        obstacles.push({
            x:Math.random()*300+60,
            y:-50,
            size:Math.random()*30+25
        });
    }

    function draw(){
        ctx.fillStyle="#000";
        ctx.fillRect(0,0,canvas.width,canvas.height);

        // road perspective
        ctx.fillStyle="#111";
        ctx.beginPath();
        ctx.moveTo(100,0);
        ctx.lineTo(320,0);
        ctx.lineTo(420,650);
        ctx.lineTo(0,650);
        ctx.closePath();
        ctx.fill();

        // player
        ctx.fillStyle="#00ff00";
        ctx.fillRect(player.x-player.w/2, player.y-player.h/2, player.w, player.h);

        // obstacles
        ctx.fillStyle="#ff0000";
        obstacles.forEach(o=>{
            ctx.fillRect(o.x-o.size/2,o.y-o.size/2,o.size,o.size);
        });

        ctx.fillStyle="#00ff00";
        ctx.font="16px Arial";
        ctx.fillText("Score: "+score, 10, 20);

        if(gameOver){
            ctx.fillStyle="rgba(0,0,0,.8)";
            ctx.fillRect(0,0,canvas.width,canvas.height);
            ctx.fillStyle="#00ff00";
            ctx.font="28px Arial";
            ctx.fillText("GAME OVER", 130, 320);
        }
    }

    function update(){
        if(gameOver){
            draw();
            return;
        }

        if(Math.random()<0.03) spawnObs();

        obstacles.forEach(o=>{
            o.y += speed;
            o.size += 0.4; // fake 3D zoom
        });

        obstacles = obstacles.filter(o=>o.y<700);

        obstacles.forEach(o=>{
            let px=player.x-player.w/2;
            let py=player.y-player.h/2;
            let ox=o.x-o.size/2;
            let oy=o.y-o.size/2;

            if(px<ox+o.size && px+player.w>ox && py<oy+o.size && py+player.h>oy){
                gameOver=true;
            }
        });

        score++;
        speed=Math.min(12,5+score/400);

        draw();
        gameLoop=requestAnimationFrame(update);
    }

    window.onkeydown=(e)=>{
        if(e.key==="ArrowLeft") player.x-=25;
        if(e.key==="ArrowRight") player.x+=25;
        player.x=Math.max(20,Math.min(canvas.width-20,player.x));
    };

    update();
}

/* =======================
   BRICK BREAKER
======================= */
function brickBreaker(){
    let paddle={x:160,y:610,w:100,h:15};
    let ball={x:210,y:500,r:8,vx:4,vy:-4};
    let bricks=[];
    let score=0;
    let gameOver=false;

    for(let r=0;r<5;r++){
        for(let c=0;c<6;c++){
            bricks.push({x:20+c*65,y:80+r*35,w:60,h:25,alive:true});
        }
    }

    function draw(){
        ctx.fillStyle="#000";
        ctx.fillRect(0,0,canvas.width,canvas.height);

        // paddle
        ctx.fillStyle="#00ff00";
        ctx.fillRect(paddle.x,paddle.y,paddle.w,paddle.h);

        // ball
        ctx.fillStyle="#00ffff";
        ctx.beginPath();
        ctx.arc(ball.x,ball.y,ball.r,0,Math.PI*2);
        ctx.fill();

        // bricks
        bricks.forEach(b=>{
            if(b.alive){
                ctx.fillStyle="#ff0000";
                ctx.fillRect(b.x,b.y,b.w,b.h);
            }
        });

        ctx.fillStyle="#00ff00";
        ctx.font="16px Arial";
        ctx.fillText("Score: "+score, 10, 20);

        if(gameOver){
            ctx.fillStyle="rgba(0,0,0,.8)";
            ctx.fillRect(0,0,canvas.width,canvas.height);
            ctx.fillStyle="#00ff00";
            ctx.font="28px Arial";
            ctx.fillText("GAME OVER", 130, 320);
        }
    }

    function update(){
        if(gameOver){
            draw();
            return;
        }

        ball.x+=ball.vx;
        ball.y+=ball.vy;

        if(ball.x<ball.r || ball.x>canvas.width-ball.r) ball.vx*=-1;
        if(ball.y<ball.r) ball.vy*=-1;

        // paddle hit
        if(ball.x>paddle.x && ball.x<paddle.x+paddle.w && ball.y+ball.r>paddle.y){
            ball.vy*=-1;
        }

        // brick hit
        bricks.forEach(b=>{
            if(b.alive){
                if(ball.x>b.x && ball.x<b.x+b.w && ball.y>b.y && ball.y<b.y+b.h){
                    b.alive=false;
                    ball.vy*=-1;
                    score+=10;
                }
            }
        });

        if(ball.y>canvas.height){
            gameOver=true;
        }

        draw();
        gameLoop=requestAnimationFrame(update);
    }

    window.onmousemove=(e)=>{
        let rect=canvas.getBoundingClientRect();
        paddle.x = e.clientX - rect.left - paddle.w/2;
        paddle.x=Math.max(0,Math.min(canvas.width-paddle.w,paddle.x));
    };

    update();
}
</script>

</body>
</html>
